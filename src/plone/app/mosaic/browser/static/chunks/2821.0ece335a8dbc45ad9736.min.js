"use strict";(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[2821],{2821:function(t,e,i){i.r(e),i.d(e,{parser:function(){return l}});i(35666);var a=i(10878),n=i.n(a),s=i(39191),o=i(40705),r=i(19513);const l=new o.Z("date-picker");l.addArgument("behavior","styled",["native","styled"]),l.addArgument("week-numbers",[],["show","hide"]),l.addArgument("i18n"),l.addArgument("first-day",0),l.addArgument("after"),l.addArgument("offset-days",0),l.add_argument("output-format",null),l.add_argument("locale",null),l.addAlias("behaviour","behavior"),e.default=s.Z.extend({name:"date-picker",trigger:".pat-date-picker",parser:l,format:"YYYY-MM-DD",async init(){const t=this.el,e=this.el.disabled;if(this.options=n().extend(l.parse(t),this.options),!e&&this.options.after){const t=document.querySelectorAll(this.options.after);for(const e of t)e.addEventListener("change",(t=>{let e=t.target.value;if(e=e?new Date(e):null,!e)return;let i=this.el.value;if(i=i?new Date(i):null,!i||i<e){const t=this.options.offsetDays||0;e.setDate(e.getDate()+t),this.el.value=e.toISOString().substring(0,10),this.dispatch_change_event()}}))}let a;if("styled"===this.options.behavior){let s;if(t.setAttribute("type","hidden"),a=document.createElement("time"),a.setAttribute("class","output-field"),a.setAttribute("datetime",t.value),e&&a.classList.add("disabled"),t.insertAdjacentElement("beforebegin",a),this.options.outputFormat){const t=(await Promise.resolve().then(i.bind(i,13521))).default,e={format:this.format};this.options.outputFormat&&(e["output-format"]=this.options.outputFormat),this.options.locale&&(e.locale=this.options.locale),s=new t(a,e)}else a.textContent=t.value;if(n()(a).on("init.display-time.patterns",(()=>this.add_clear_button(a))),this.el.addEventListener("change",(()=>{a.setAttribute("datetime",this.el.value),s?s.format():a.textContent=this.el.value,this.add_clear_button(a)})),e)return}else{if(e)return;if(r.Z.checkInputSupport("date","invalid date"))return;"date"===t.getAttribute("type")&&t.setAttribute("type","text")}window.__patternslib_import_styles&&i.e(57666).then(i.bind(i,57666));const s=(await Promise.all([i.e(30381),i.e(84319)]).then(i.t.bind(i,84319,23))).default,o={field:t,trigger:a||t,format:this.format,firstDay:this.options.firstDay,showWeekNumber:"show"===this.options.weekNumbers,onSelect:()=>this.dispatch_change_event()};if(t.getAttribute("min")&&(o.minDate=new Date(t.getAttribute("min"))),t.getAttribute("max")&&(o.maxDate=new Date(t.getAttribute("max"))),this.options.i18n)try{const t=await fetch(this.options.i18n);o.i18n=await t.json()}catch{console.error(`date-picker could not load i18n for ${this.options.i18n}`)}this.pikaday=new s(o)},add_clear_button(t){if(!this.el.disabled&&!this.el.required&&this.el.value){const e=document.createElement("span");e.setAttribute("class","cancel-button"),e.addEventListener("click",(t=>{t.stopPropagation(),this.el.value=null,this.dispatch_change_event()})),t.appendChild(e)}},dispatch_change_event(){const t=new Event("change",{bubbles:!0,cancelable:!0});t.firedBy=this.pikaday,this.el.dispatchEvent(t),n()(this.el).trigger("input-change"),n()(this.el.form).trigger("input-change")}})}}]);