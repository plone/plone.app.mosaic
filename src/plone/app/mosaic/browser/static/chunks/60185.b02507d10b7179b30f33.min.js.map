{"version":3,"file":"chunks/60185.b02507d10b7179b30f33.min.js","mappings":"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","sources":["webpack://plone-mosaic/./resources/js/mosaic.layout.js"],"sourcesContent":["// This plugin is used to create a mosaic layout.\nimport \"regenerator-runtime/runtime\"; // needed for ``await`` support\nimport $ from \"jquery\";\nimport logging from \"@patternslib/patternslib/src/core/logging\";\nimport events from \"@patternslib/patternslib/src/core/events\";\nimport Tile from \"./mosaic.tile\";\n\nconst log = logging.getLogger(\"pat-mosaic/layout\");\n\nexport default class LayoutManager {\n    constructor(mosaic) {\n        this.mosaic = mosaic;\n    }\n\n    layout = {\n        widthClasses: [\n            \"col\",\n            \"col-1\",\n            \"col-2\",\n            \"col-3\",\n            \"col-4\",\n            \"col-5\",\n            \"col-6\",\n            \"col-7\",\n            \"col-8\",\n            \"col-9\",\n            \"col-10\",\n            \"col-11\",\n            \"col-12\",\n        ],\n        resizeClasses: [\n            \"mosaic-resize-1\",\n            \"mosaic-resize-2\",\n            \"mosaic-resize-3\",\n            \"mosaic-resize-4\",\n            \"mosaic-resize-5\",\n            \"mosaic-resize-6\",\n            \"mosaic-resize-7\",\n            \"mosaic-resize-8\",\n            \"mosaic-resize-9\",\n            \"mosaic-resize-10\",\n            \"mosaic-resize-11\",\n            \"mosaic-resize-12\",\n        ],\n        resizeHandleClasses: [\n            \"mosaic-resize-handle-1\",\n            \"mosaic-resize-handle-2\",\n            \"mosaic-resize-handle-3\",\n            \"mosaic-resize-handle-4\",\n            \"mosaic-resize-handle-5\",\n            \"mosaic-resize-handle-6\",\n            \"mosaic-resize-handle-7\",\n            \"mosaic-resize-handle-8\",\n            \"mosaic-resize-handle-9\",\n            \"mosaic-resize-handle-10\",\n            \"mosaic-resize-handle-11\",\n            \"mosaic-resize-handle-12\",\n        ],\n    };\n\n    /* css helpers */\n    getWidthClass(e) {\n        for (const cls of this.layout.widthClasses) {\n            if ($(e).hasClass(cls)) {\n                return cls;\n            }\n        }\n        // Fallback\n        return this.layout.widthClasses[0];\n    }\n\n    getResizeHandleClassId(e) {\n        // Loop through resize handle classes\n        for (let idx = 0; idx < this.layout.resizeHandleClasses.length; idx++) {\n            if ($(e).hasClass(this.layout.resizeHandleClasses[idx])) {\n                return idx;\n            }\n        }\n        // Fallback\n        return 1;\n    }\n\n    addAppTile(type, url /*, id */) {\n        // Get value\n        $.ajax({\n            type: \"GET\",\n            url: url,\n            success: async (value) => {\n                // Get dom tree\n                value = this.mosaic.getDomTreeFromHtml(value);\n\n                // Add head tags\n                this.mosaic.addHeadTags(url, value);\n\n                // Add tile\n                await this.addTile(type, value.find(\".temp_body_tag\").html(), url);\n            },\n        });\n    }\n\n    async addAppTileHTML(type, response, url) {\n        let value = this.mosaic.getDomTreeFromHtml(response);\n        this.mosaic.addHeadTags(url, value);\n        await this.addTile(type, value.find(\".temp_body_tag\").html(), url);\n    }\n\n    editAppTile(url) {\n        var self = this;\n\n        // Focus on current window\n        window.parent.focus();\n\n        // Get new value\n        $.ajax({\n            type: \"GET\",\n            url: url,\n            success: function (value) {\n                // Get dom tree\n                value = self.mosaic.getDomTreeFromHtml(value);\n\n                // Remove head tags\n                self.mosaic.removeHeadTags(url);\n\n                // Add head tags\n                self.mosaic.addHeadTags(url, value);\n\n                // Update tile\n                var $tile = $(\n                    \".mosaic-selected-tile .mosaic-tile-content\",\n                    self.mosaic.document,\n                );\n                $tile.html(value.find(\".temp_body_tag\").html()); // jshint ignore:line\n                $tile.attr(\"data-tileUrl\", url.replace(/&/gim, \"&amp;\"));\n            },\n        });\n    }\n\n    async addTile(type, value, tileUrl) {\n        var self = this;\n        // Set dragging state\n        self.mosaic.panels.addClass(\"mosaic-panel-dragging mosaic-panel-dragging-new\");\n\n        // Add helper\n        const add_helper = document.createElement(\"div\");\n        add_helper.classList.add(\"mosaic-grid-row\");\n        add_helper.innerHTML = `<div class=\"mosaic-grid-cell col\">\n                <div class=\"movable removable mosaic-tile mosaic-${type}-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-original-tile\">\n                    <div class=\"mosaic-tile-content\" data-tileUrl=\"${\n                        tileUrl && tileUrl.replace(/&/gim, \"&amp;\")\n                    }\">\n                        ${value}\n                    </div>\n                </div>\n            </div>`;\n        self.mosaic.panels[0].append(add_helper);\n\n        // Set helper min size\n        var helper = self.mosaic.panels.find(\".mosaic-helper-tile-new\");\n\n        // Get max width\n        var width = 0;\n        self.mosaic.panels.each(function () {\n            if ($(this).width() > width) {\n                width = $(this).width();\n            }\n        });\n\n        // Set width\n        if (helper.width() < width / 4) {\n            helper.width(width / 4);\n        } else {\n            helper.width(helper.width());\n        }\n\n        var tile = new Tile(self.mosaic, helper);\n        await tile.initialize();\n        tile.cacheHtml();\n        tile.scanRegistry();\n    }\n\n    getDefaultValue(tile_config) {\n        var self = this;\n        var start, end;\n\n        // Wrap title and description fields for proper styles\n        if (tile_config.name === \"IDublinCore-title\") {\n            start = '<h1 class=\"documentFirstHeading\">';\n            end = \"</h1>\";\n        } else if (tile_config.name === \"IDublinCore-description\") {\n            start = '<p class=\"documentDescription\">';\n            end = \"</p>\";\n        } else {\n            start = \"<div>\";\n            end = \"</div>\";\n        }\n\n        switch (tile_config.tile_type) {\n            case \"field\":\n                switch (tile_config.widget) {\n                    case \"z3c.form.browser.text.TextWidget\":\n                    case \"z3c.form.browser.text.TextFieldWidget\":\n                        var textval = $(\"#\" + tile_config.id, self.mosaic.document)\n                            .find(\"input\")\n                            .attr(\"value\");\n                        return `${start}${textval}${end}`;\n                    case \"z3c.form.browser.textarea.TextAreaWidget\":\n                    case \"z3c.form.browser.textarea.TextAreaFieldWidget\":\n                    case \"z3c.form.browser.textlines.TextLinesWidget\":\n                    case \"z3c.form.browser.textlines.TextLinesFieldWidget\":\n                        var lines = $(\"#\" + tile_config.id, self.mosaic.document)\n                            .find(\"textarea\")\n                            .val()\n                            .replace(\"\\\\n\", \"<br/>\");\n                        return `${start}${lines}${end}`;\n                    case \"plone.app.z3cform.widget.RichTextFieldWidget\":\n                    case \"plone.app.z3cform.widgets.richtext.RichTextFieldWidget\":\n                    case \"plone.app.z3cform.wysiwyg.widget.WysiwygWidget\":\n                    case \"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget\":\n                    case \"plone.app.widgets.dx.RichTextWidget\":\n                        return $(\"#\" + tile_config.id)\n                            .find(\"textarea\")\n                            .val();\n                    default:\n                        return `<div class=\"text-bg-secondary\">Placeholder for field:<br/><b>${tile_config.label}</b></div>`;\n                }\n            default:\n                return tile_config.default_value;\n        }\n    }\n\n    getPageContent(exportLayout) {\n        var self = this;\n\n        var getLayoutRow = function (obj) {\n            var body = \"\";\n\n            // Check if not an empty row\n            if (\n                $(obj).hasClass(\"mosaic-empty-row\") === false &&\n                $(obj).find(\".mosaic-tile\").length >= 0\n            ) {\n                // Add row open tag\n                classNames = $(obj).attr(\"class\");\n                body += '      <div class=\"' + classNames + '\">\\n';\n\n                // Loop through rows\n                $(obj)\n                    .children(\".mosaic-grid-cell\")\n                    .each(function () {\n                        // Add cell start tag\n                        body += '        <div class=\"' + $(this).attr(\"class\") + '\">\\n'; // jshint ignore:line\n\n                        $(this)\n                            .children()\n                            .each(function () {\n                                if ($(this).hasClass(\"mosaic-tile\")) {\n                                    body += $(this)\n                                        .data(\"mosaic-tile\")\n                                        .getHtmlBody(exportLayout);\n                                } else if ($(this).hasClass(\"mosaic-innergrid-row\")) {\n                                    body += getLayoutRow(this);\n                                }\n                            });\n\n                        // Add cell end tag\n                        body += \"        </div>\\n\";\n                    });\n\n                // Add row close tag\n                body += \"      </div>\\n\";\n            }\n            return body;\n        };\n\n        // Content\n        var content,\n            body = \"\",\n            classNames = \"\";\n\n        // Add body tag\n        body += \"  <body>\\n\";\n\n        // Loop through panels\n        $(\"[data-panel]\", self.mosaic.document).each(function () {\n            // Add open panel tag\n            body += '    <div data-panel=\"' + $(this).data(\"panel\") + '\"';\n            body += '         data-max-columns=\"' + $(this).data(\"max-columns\") + '\">\\n';\n\n            $(this)\n                .children()\n                .each(function () {\n                    if ($(this).hasClass(\"mosaic-grid-row\")) {\n                        body += getLayoutRow(this);\n                    }\n                });\n\n            // Add close panel tag\n            body += \"    </div>\\n\";\n        });\n\n        // Add close tag\n        body += \"  </body>\\n\";\n\n        content =\n            '<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\" data-layout=\"' +\n            self.mosaic.options.layout +\n            '\">\\n'; // jshint ignore:line\n        content += body;\n        content += \"</html>\\n\";\n        return content;\n    }\n\n    saveLayoutToForm() {\n        var self = this;\n        var $customLayout = $(\n            \"#form-widgets-ILayoutAware-customContentLayout, \" +\n                \"[name='form.widgets.ILayoutAware.customContentLayout']\",\n        );\n\n        if (self.mosaic.hasContentLayout) {\n            $customLayout.val(\"\");\n        } else {\n            $customLayout.val(self.getPageContent());\n        }\n    }\n\n    init_events() {\n        var self = this;\n        var DocumentKeyup = function (e) {\n            // Check if alt\n            if (e.keyCode === 18) {\n                var date = new Date();\n                var enabled = $(\".mosaic-panel\", self.mosaic.document).data(\n                    \"advanced-enabled\",\n                );\n                var elapsed = date.getTime() - enabled;\n                if (elapsed > 400) {\n                    $(\".mosaic-panel\", self.mosaic.document).removeClass(\n                        \"mosaic-advanced\",\n                    );\n                }\n            }\n            // Check if ctrl\n            if (e.keyCode === 17) {\n                $(\".mosaic-panel\", self.mosaic.document).removeClass(\"inner-subcolumn\");\n            }\n        };\n\n        // Keydown handler\n        var DocumentKeydown = function (e) {\n            const _document = self.mosaic.document;\n            // Tab key\n            if (e.keyCode === 9) {\n                // blur all active tiles. and set focus\n                _document.querySelectorAll(\".mosaic-selected-tile\").forEach((tile) => {\n                    $(tile).data(\"mosaic-tile\").blur();\n                });\n                // focus new tile\n                var focused_tile = document.activeElement.closest(\".mosaic-tile\");\n                if (focused_tile) {\n                    $(focused_tile).data(\"mosaic-tile\").focus();\n                }\n            }\n            // Check if alt\n            if (e.keyCode === 18) {\n                if ($(\".mosaic-panel\", _document).hasClass(\"mosaic-advanced\")) {\n                    $(\".mosaic-panel\", _document).removeClass(\"mosaic-advanced\");\n                } else {\n                    var date = new Date();\n                    $(\".mosaic-panel\", _document).addClass(\"mosaic-advanced\");\n                    $(\".mosaic-panel\", _document).data(\n                        \"advanced-enabled\",\n                        date.getTime(),\n                    );\n                }\n            }\n            // Check if ctrl\n            if (e.keyCode === 17) {\n                $(\".mosaic-panel\", _document).addClass(\"inner-subcolumn\");\n            }\n\n            // Check if esc\n            if (e.keyCode === 27) {\n                // Check if dragging\n                var original_tile = _document.querySelectorAll(\".mosaic-original-tile\");\n                if (original_tile.length > 0) {\n                    original_tile.forEach((tile) => {\n                        tile.classList.add(\"mosaic-drag-cancel\");\n                        if (tile.classList.contains(\"mosaic-helper-tile-new\")) {\n                            // original row\n                            const $orig_row = $(tile).parent().parent();\n                            // dismiss dragging tile and remove row\n                            $(tile).remove();\n                            $orig_row.mosaicCleanupRow();\n                            // Remove dragging class from content\n                            self.mosaic.panels.removeClass(\n                                \"mosaic-panel-dragging mosaic-panel-dragging-new\",\n                            );\n                            // Hide all dividers\n                            $(\n                                \".mosaic-selected-divider\",\n                                self.mosaic.document,\n                            ).removeClass(\"mosaic-selected-divider\");\n                        }\n                    });\n                    // Deselect tile\n                } else {\n                    $(\".mosaic-selected-tile\", _document).each(function () {\n                        $(this).trigger(\"blur\");\n                    });\n                }\n\n                // Find resize helper\n                $(\".mosaic-resize-handle-helper\", _document).each(function () {\n                    // Remove resizing state\n                    $(this).parents(\"[data-panel]\").removeClass(\"mosaic-panel-resizing\");\n                    $(this).parent().removeClass(\"mosaic-row-resizing\");\n                    $(this).parent().children(\".mosaic-resize-placeholder\").remove();\n\n                    // Remove helper\n                    $(this).remove();\n                });\n            }\n        };\n\n        // Bind event and add to array\n        events.add_event_listener(\n            self.mosaic.document,\n            \"keydown\",\n            \"pat-layout--keydown\",\n            DocumentKeydown,\n        );\n        events.add_event_listener(\n            self.mosaic.document,\n            \"keyup\",\n            \"pat-layout--keyup\",\n            DocumentKeyup,\n        );\n\n        // Add deselect\n        const DocumentMousedown = function (e) {\n            // Get element\n            let elm;\n            if (e.target) {\n                elm = e.target;\n            } else if (e.srcElement) {\n                elm = e.srcElement;\n            }\n\n            // Find new tile helper\n            var new_tile = $(\".mosaic-helper-tile-new\", self.mosaic.document);\n            if (new_tile.length > 0) {\n                new_tile.each(function () {\n                    // Handle drag end\n                    $(this).mosaicHandleDragEnd();\n                });\n                return;\n            }\n\n            // If clicked inside TinyMCE or Modal exit\n            if ($(elm).parents(\".mce-content-body, .tox, .modal-wrapper\").length > 0) {\n                return;\n            }\n\n            // If clicked outside a tile\n            if ($(elm).parents(\".mosaic-tile\").length === 0) {\n                // Deselect tiles\n                self.mosaic.document\n                    .querySelectorAll(\".mosaic-selected-tile:not(.mosaic-tile-loading)\")\n                    .forEach((el) => {\n                        $(el).data(\"mosaic-tile\").blur();\n                    });\n                // Check if outside toolbar\n                if ($(elm).parents(\".mosaic-toolbar\").length === 0) {\n                    // Set actions\n                    self.mosaic.toolbar.SelectedTileChange();\n                }\n            }\n        };\n\n        // Bind event and add to array\n        events.add_event_listener(\n            self.mosaic.document,\n            \"mousedown\",\n            \"pat-layout--mousedown\",\n            DocumentMousedown,\n        );\n\n        // Handle mouse move event: when holding down mouse left button and dragging the handler left or right.\n        const DocumentMousemove = function (e) {\n            // Get new tile helper\n            var $new_tile_helper = $(\".mosaic-helper-tile-new\", self.mosaic.document);\n\n            if($new_tile_helper.length) {\n                // Get offset\n                const offset = $new_tile_helper.parent().offset();\n                // Get mouse x\n                $new_tile_helper.css(\"top\", e.pageY + 3 - offset.top);\n                $new_tile_helper.css(\"left\", e.pageX + 3 - offset.left);\n\n            }\n\n            // Get resize handle helper\n            var $helper = $(\".mosaic-resize-handle-helper\", self.mosaic.document);\n\n            if($helper.length) {\n                // Get row\n                var $row = $helper.parent();\n                var resize_handle_index = $helper.data(\"resize_handle_index\");\n\n                // Get mouse x\n                var mouse_x = parseFloat(e.pageX - $row.offset().left - 4);\n\n                // Get mouse percentage\n                var mouse_percentage = Math.round(\n                    (mouse_x / $helper.data(\"row_width\")) * 100\n                );\n\n                // Get closest snap location\n                var snap = 8;\n                var snap_offset = 8;\n                var cur_snap_offset;\n                var grid_percent = GetGridPercentList();\n\n                grid_percent.forEach(function (perc) {\n                    cur_snap_offset = Math.abs(perc - mouse_percentage);\n                    if (cur_snap_offset < snap_offset) {\n                        snap = perc;\n                        snap_offset = cur_snap_offset;\n                    }\n                });\n\n                var snap_size = GetBootstrapColByPercent(snap);\n\n                var column_sizes = $helper[0][\"column_sizes\"];\n                // sum of all column sizes\n                var column_sizes_sum = column_sizes.reduce((a, b) => a + b, 0);\n                // sum of sizes before helper index\n                var col_size_before = column_sizes.slice(0, resize_handle_index).reduce((a, b) => a + b, 0);\n                // sum of sizes after helper index excluding last column (which is elastic)\n                var col_size_after = column_sizes.slice(resize_handle_index + 1, -1).reduce((a, b) => a + b, 0);\n                // calculate maximum size of current column\n                if(resize_handle_index == (column_sizes.length - 1)) {\n                    // if last column, we can drag to full width (12)\n                    var col_size_max = 12 - col_size_before - col_size_after;\n                } else {\n                    // if not last column, we respect last elastic column (min-size: 1)\n                    // with its fixed right margin\n                    var col_size_max = column_sizes_sum - col_size_before - col_size_after - 1;\n                }\n                var new_column_size = snap_size - col_size_before;\n                // limit to maximum of col_sizes_sum and minimum of 1\n                new_column_size = new_column_size > col_size_max ? col_size_max : new_column_size < 1 ? 1 : new_column_size;\n                var new_column_sizes = [];\n\n                for(let i=0; i<column_sizes.length; i++) {\n                    if(i === resize_handle_index) {\n                        // set new size for current column\n                        new_column_sizes.push(new_column_size);\n                    } else if (i === (column_sizes.length - 1)) {\n                        // calculate elastic size for last column\n                        var _before = new_column_sizes.reduce((a, b) => a + b);\n                        var _last_size = column_sizes_sum - _before;\n                        // last size cannot be lower than 1\n                        new_column_sizes.push(_last_size < 1 ? 1 : _last_size);\n                    } else {\n                        new_column_sizes.push(column_sizes[i]);\n                    }\n                }\n\n                log.debug(\"------------------resize-handle(move)--------------------\")\n                log.debug(`column_sizes_sum: ${column_sizes_sum}`);\n                log.debug(`cur_snap_offset: ${cur_snap_offset}`);\n                log.debug(`snap_size: ${snap_size}`);\n                log.debug(`col_size_before: ${col_size_before}`);\n                log.debug(`col_size_after: ${col_size_after}`);\n                log.debug(`col_size_max: ${col_size_max}`);\n                log.debug(`new_column_size: ${new_column_size}`);\n                log.debug(`new_column_sizes: ${new_column_sizes}`);\n\n                var col_size_sum = 0;\n                var resize_css_classes = self.layout.resizeClasses.join(\" \");\n                var width_css_classes = self.layout.widthClasses.join(\" \");\n\n                $row.children(\".mosaic-resize-placeholder\").each(function (idx) {\n                    var col_size = column_sizes[idx];\n                    var col_size_class = GetWidthClassByColSize(col_size);\n\n                    // placeholder width and position\n                    $(this)\n                        .removeClass(`${width_css_classes} ${resize_css_classes}`)\n                        .addClass(`${col_size_class} mosaic-resize-${col_size_sum}`)\n                        .find(\".info\")\n                        .html(col_size);\n\n                    col_size_sum += col_size;\n\n                    if(idx === resize_handle_index) {\n                        // move resize handle helper\n                        $helper\n                            .removeClass(resize_css_classes)\n                            .addClass(`mosaic-resize-${col_size_sum}`);\n                    }\n                });\n\n                // Set new size\n                $helper[0][\"column_sizes\"] = new_column_sizes;\n            }\n\n        };\n\n        // Bind event and add to array\n        events.add_event_listener(\n            self.mosaic.document,\n            \"mousemove\",\n            \"pat-layout--mousemove\",\n            DocumentMousemove,\n        );\n        events.add_event_listener(\n            self.mosaic.document,\n            \"dragover\",\n            \"pat-layout--dragover\",\n            DocumentMousemove,\n        );\n\n        // Handle mouse up event\n        // When resizing is done on mouse up event apply the changes to the div elements\n        const DocumentMouseup = function () {\n            // Find resize helper\n            $(\".mosaic-resize-handle-helper\", self.mosaic.document).each(function () {\n                var resize_handle_index = $(this).data(\"resize_handle_index\");\n\n                // Cleanup original row\n                $(this).parent().parent().mosaicCleanupRow();\n\n                // Get panel\n                var panel = $(this).parents(\"[data-panel]\");\n\n                // Get column sizes\n                var column_sizes = $(this)[0][\"column_sizes\"];\n                var css_width_classes = self.layout.widthClasses.join(\" \");\n\n                // Set column sizes\n                $(this)\n                    .parent()\n                    .children(\".mosaic-grid-cell\")\n                    .each(function (i) {\n                        $(this)\n                            .removeClass(css_width_classes)\n                            .addClass(GetWidthClassByColSize(column_sizes[i]));\n\n                        var can_reset = $(this).hasClass(\"col\");\n                        if (!can_reset && i === resize_handle_index) {\n                            $(this)\n                                .children(\".mosaic-tile\")\n                                .first()\n                                .children(\".mosaic-tile-side-tools\")\n                                .each(function () {\n                                    var $tileSideTools = $(this);\n\n                                    $tileSideTools\n                                        .children(\".mosaic-tile-label.reset\")\n                                        .remove();\n\n                                    $tileSideTools.append(\n                                        $(self.mosaic.document.createElement(\"div\"))\n                                            .addClass(\"mosaic-tile-label reset\")\n                                            .append(\n                                                AddResetAnchor(\n                                                    $tileSideTools,\n                                                    column_sizes[i],\n                                                ),\n                                            ),\n                                    );\n                                });\n                        }\n                    });\n\n                // Remove resizing state\n                panel.removeClass(\"mosaic-panel-resizing\");\n                $(this).parent().removeClass(\"mosaic-row-resizing\");\n                $(this).parent().children(\".mosaic-resize-placeholder\").remove();\n\n                // Set resize handles\n                $(this).parent().mosaicSetResizeHandles();\n                var $tile = panel.find(\".mosaic-selected-tile\");\n                if ($tile.length > 0) {\n                    $tile.data(\"mosaic-tile\").select();\n                }\n\n                // Remove helper\n                $(this).remove();\n            });\n        };\n\n        // Bind event\n        events.add_event_listener(\n            self.mosaic.document,\n            \"mouseup\",\n            \"pat-layout--mouseup\",\n            DocumentMouseup,\n        );\n\n        // Handle mousemove on tile\n        const TileMousemove = function (e) {\n            // only if dragging\n            if (\n                $(this).parents(\"[data-panel]\").hasClass(\"mosaic-panel-dragging\") ===\n                false\n            ) {\n                return;\n            }\n\n            // Hide all dividers\n            $(\".mosaic-selected-divider\", self.mosaic.document).removeClass(\n                \"mosaic-selected-divider\",\n            );\n\n            // Don't show dividers if above original or floating tile\n            if (\n                $(this).hasClass(\"mosaic-original-tile\") === false &&\n                $(this).hasClass(\"mosaic-tile-align-left\") === false &&\n                $(this).hasClass(\"mosaic-tile-align-right\") === false\n            ) {\n                // Get direction\n                var dir = $(this).mosaicGetDirection(e);\n                var divider = $(this).children(\".mosaic-divider-\" + dir);\n\n                // Check if left or right divider\n                if (dir === \"left\" || dir === \"right\") {\n                    var row = divider.parent().parent().parent();\n                    var cols = row.children(\".mosaic-grid-cell\").filter((idx, el) => {\n                        // filter out original tile to enable moving tiles\n                        // inside row with max-columns tiles\n                        return $(el).find(\".mosaic-original-tile\").length === 0;\n                    });\n\n                    if (cols.length >= $(\".mosaic-panel\").data(\"max-columns\")) {\n                        // This row already up to the max amount of columns allowed for this layout\n                        // do not allow new items to be dropped alingside any elements in this row.\n                        return;\n                    }\n\n                    // If row has multiple columns\n                    if (row.children(\".mosaic-grid-cell\").length > 1) {\n                        divider.height(row.height() + 5);\n                        divider.css(\n                            \"top\",\n                            row.offset().top - divider.parent().offset().top - 5,\n                        );\n                    } else {\n                        divider.height(divider.parent().height() + 5);\n                        divider.css(\"top\", -5);\n                    }\n                }\n\n                // Show divider\n                divider.addClass(\"mosaic-selected-divider\");\n            }\n        };\n\n        // Bind events\n        self.mosaic.document.querySelectorAll(\".mosaic-tile\").forEach((tile) => {\n            events.add_event_listener(\n                tile,\n                \"mousemove\",\n                \"pat-layout--mousemove-tile\",\n                TileMousemove,\n            );\n            events.add_event_listener(\n                tile,\n                \"dragover\",\n                \"pat-layout--dragover-tile\",\n                TileMousemove,\n            );\n            events.add_event_listener(\n                tile,\n                \"click\",\n                \"pat-layout--click-tile\",\n                function () {\n                    if (\n                        $(\".mosaic-helper-tile-new\", self.mosaic.document).length === 0\n                    ) {\n                        // only if not dropping tile\n                        if ($(this).data(\"mosaic-tile\")) {\n                            $(this).data(\"mosaic-tile\").select();\n                        }\n                    }\n                },\n            );\n        });\n\n        const applyCustomCss = function (e) {\n            if ($(e.target).attr(\"id\") === \"custom-css-input-box\") {\n                return;\n            }\n            $.each($(\"div.mosaic-set-custom-css\"), function () {\n                var parent = $(this).parent();\n                var base_css = \"mosaic-grid-row\";\n                if (parent.hasClass(\"mosaic-innergrid-row\")) {\n                    base_css = \"mosaic-grid-row mosaic-innergrid-row\";\n                }\n                var classes = $(this).find(\"input#custom-css-input-box\").val();\n                base_css += \" \" + classes;\n                parent.attr(\"class\", base_css);\n                $(this).remove();\n            });\n        };\n\n        const CustomCSSOnDblClick = function (e) {\n            // Only do this for \"mosaic-grid-row\" if advanced mode is enabled\n            var target = $(e.target);\n            var obj = target.parents(\"[data-panel]\");\n            if (obj.hasClass(\"mosaic-advanced\") && target.hasClass(\"mosaic-grid-row\")) {\n                // Check we don't have an input field already\n                if ($(target).find(\".mosaic-set-custom-css\").length > 0) {\n                    return;\n                }\n\n                // We are in advance mode\n                var custom_classes = [];\n                $.each(target.attr(\"class\").split(\" \"), function () {\n                    if (\n                        this !== undefined &&\n                        this !== \"mosaic-grid-row\" &&\n                        this !== \"mosaic-innergrid-row\"\n                    ) {\n                        custom_classes.push(this);\n                    }\n                });\n                var input = $(\n                    \"<input type='text' id='custom-css-input-box'></input>\",\n                ).val(custom_classes.join(\" \"));\n                var div = $(\"<div></div>\")\n                    .addClass(\"mosaic-set-custom-css\")\n                    .append($(\"<label>Custom CSS for this row:</label>\"))\n                    .append(input);\n                target.append(div);\n            }\n        };\n        self.mosaic.document.querySelectorAll(\".mosaic-grid-row\").forEach((gridrow) => {\n            events.add_event_listener(\n                gridrow,\n                \"dblclick\",\n                \"pat-layout--dblclick-gridrow\",\n                CustomCSSOnDblClick,\n            );\n        });\n        events.add_event_listener(\n            self.mosaic.document,\n            \"click\",\n            \"pat-layout--click\",\n            applyCustomCss,\n        );\n    }\n\n    initialize_panels() {\n        var self = this;\n\n        self.initJQueryHelpers();\n        self.init_events();\n\n        // Loop through matched elements\n        var total = self.mosaic.panels.length;\n\n        for (var i = 0; i < total; i++) {\n            // Get current object\n            var obj = $(self.mosaic.panels[i]);\n\n            // Add icons and dividers\n            obj.find(\".mosaic-tile\").each(async function () {\n                var tile = new Tile(self.mosaic, this);\n                await tile.initialize();\n                $(this).mosaicAddDrag();\n            });\n            obj.mosaicAddEmptyRows();\n            obj.children(\".mosaic-grid-row\").mosaicSetResizeHandles();\n            if (i === total - 1) {\n                // Get biggest panel\n                var width = 0;\n                var index = 0;\n                self.mosaic.panels.each(function (j) {\n                    if ($(this).width() > width) {\n                        width = $(this).width();\n                        index = j;\n                    }\n                });\n\n                // Select first tile in biggest panel\n                var $tile = self.mosaic.panels.eq(index).find(\".mosaic-tile:first\");\n                if ($tile.length > 0) {\n                    $tile.data(\"mosaic-tile\").select();\n                }\n            }\n\n            obj.find(\".mosaic-innergrid-row\").each(function () {\n                $(this).mosaicAddMouseMoveInnergridRow();\n                $(this).mosaicSetResizeHandles();\n                var that = $(this);\n                [\"top\", \"bottom\"].forEach(function (pos) {\n                    that.append(\n                        $(self.mosaic.document.createElement(\"div\")).addClass(\n                            \"mosaic-divider mosaic-divider-\" + pos,\n                        ),\n                    );\n                });\n            });\n        }\n    }\n\n    initJQueryHelpers() {\n        var self = this;\n        var mosaic_doc = self.mosaic.document;\n\n        $.fn.mosaicAddMouseMoveEmptyRow = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Mouse move event\n                $(this).on(\"mousemove\", function (/* e */) {\n                    // Get layout object\n                    var obj = $(this).parents(\"[data-panel]\");\n\n                    // Check if dragging\n                    if (obj.hasClass(\"mosaic-panel-dragging\")) {\n                        // Hide all dividers\n                        $(\".mosaic-selected-divider\", mosaic_doc).removeClass(\n                            \"mosaic-selected-divider\",\n                        );\n                        $(this).children(\"div\").addClass(\"mosaic-selected-divider\");\n                    }\n                });\n            });\n        };\n\n        /**\n         * Add mouse move handler to inner grid rows\n         *\n         * @id jQuery.mosaicAddMouseMoveInnergridRow\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicAddMouseMoveInnergridRow = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Mouse move event\n                $(this).on(\"mousemove\", function (e) {\n                    // Get layout object\n                    var obj = $(this).parents(\"[data-panel]\");\n\n                    // Check if dragging\n                    if (obj.hasClass(\"mosaic-panel-dragging\")) {\n                        // Hide all dividers\n                        $(\".mosaic-selected-divider\", mosaic_doc).removeClass(\n                            \"mosaic-selected-divider\",\n                        );\n\n                        // Get direction\n                        var dir = $(this).mosaicGetDirection(e);\n                        var divider = $(this).children(\".mosaic-divider-\" + dir);\n\n                        // Show divider\n                        divider.addClass(\"mosaic-selected-divider\");\n                    }\n                });\n            });\n        };\n\n        /**\n         * Add empty rows\n         *\n         * @id jQuery.mosaicAddEmptyRows\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicAddEmptyRows = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Loop through rows\n                $(this)\n                    .find(\".mosaic-grid-row:not(.mosaic-innergrid-row)\")\n                    .each(function () {\n                        $(this).before(\n                            $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\"mosaic-grid-row mosaic-empty-row\")\n                                .append(\n                                    $(mosaic_doc.createElement(\"div\"))\n                                        .addClass(\"mosaic-grid-cell col\")\n                                        .append(\n                                            $(mosaic_doc.createElement(\"div\")).append(\n                                                $(\n                                                    mosaic_doc.createElement(\"div\"),\n                                                ).addClass(\"mosaic-tile-outer-border\"),\n                                            ),\n                                        ),\n                                )\n                                .mosaicAddMouseMoveEmptyRow(),\n                        );\n                        if ($(this).nextAll(\".mosaic-grid-row\").length === 0) {\n                            $(this).after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-row mosaic-empty-row\")\n                                    .append(\n                                        $(mosaic_doc.createElement(\"div\"))\n                                            .addClass(\"mosaic-grid-cell col\")\n                                            .append(\n                                                $(\n                                                    mosaic_doc.createElement(\"div\"),\n                                                ).append(\n                                                    $(\n                                                        mosaic_doc.createElement(\"div\"),\n                                                    ).addClass(\n                                                        \"mosaic-tile-outer-border\",\n                                                    ),\n                                                ),\n                                            ),\n                                    )\n                                    .mosaicAddMouseMoveEmptyRow(),\n                            );\n                        }\n                    });\n\n                if (\n                    $(this).find(\".mosaic-grid-row:not(.mosaic-innergrid-row)\")\n                        .length === 0\n                ) {\n                    $(this).append(\n                        $(mosaic_doc.createElement(\"div\"))\n                            .addClass(\"mosaic-grid-row mosaic-empty-row\")\n                            .append(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell col\")\n                                    .append(\n                                        $(mosaic_doc.createElement(\"div\")).append(\n                                            $(mosaic_doc.createElement(\"div\")).addClass(\n                                                \"mosaic-tile-outer-border\",\n                                            ),\n                                        ),\n                                    ),\n                            )\n                            .mosaicAddMouseMoveEmptyRow(),\n                    );\n                }\n            });\n        };\n\n        /**\n         * Add draggable to matched elements\n         *\n         * @id jQuery.mosaicAddDrag\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicAddDrag = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                var tile = $(this);\n\n                var DragMove = function (event) {\n                    var helper = $(\".mosaic-helper-tile\", mosaic_doc);\n                    var offset = helper.parents(\"[data-panel]\").offset();\n                    if (offset) {\n                        helper.css(\"top\", event.pageY + 3 - offset.top);\n                        helper.css(\"left\", event.pageX + 3 - offset.left);\n                    }\n                };\n\n                var DragStop = function () {\n                    var helper = $(\".mosaic-helper-tile\", mosaic_doc);\n                    $(mosaic_doc).off(\"mousemove\", DragMove).off(\"mouseup\", DragStop);\n\n                    // Handle drag end\n                    helper.mosaicHandleDragEnd();\n                    helper.remove();\n                };\n\n                return tile.each(function () {\n                    tile.find(\"div.mosaic-drag-handle\")\n                        .off(\"mousedown\")\n                        .on(\"mousedown\", function (event) {\n                            var downX = event.pageX;\n                            var downY = event.pageY;\n                            var DragCheckMove = function (event) {\n                                if (\n                                    Math.max(\n                                        Math.abs(downX - event.pageX),\n                                        Math.abs(downY - event.pageY),\n                                    ) >= 1\n                                ) {\n                                    // Add dragging class to content area\n                                    self.mosaic.panels.addClass(\"mosaic-panel-dragging\");\n                                    $(\".mosaic-selected-tile\", mosaic_doc)\n                                        .removeClass(\"mosaic-selected-tile\")\n                                        .children(\".mosaic-tile-content\")\n                                        .trigger(\"blur\");\n\n                                    var originaltile = $(event.target).parents(\n                                        \".mosaic-tile\",\n                                    );\n                                    originaltile.addClass(\"mosaic-original-tile\");\n\n                                    var clone = originaltile.clone(true);\n                                    clone\n                                        .css({\n                                            \"width\": originaltile.width(),\n                                            \"max-height\": \"50%\",\n                                            \"position\": \"absolute\",\n                                            \"opacity\": 0.5,\n                                        })\n                                        .addClass(\"mosaic-helper-tile\");\n                                    originaltile.parents(\"[data-panel]\").append(clone);\n\n                                    $(mosaic_doc).on(\"mousemove\", DragMove);\n                                    $(mosaic_doc).on(\"mouseup\", DragStop);\n                                    $(mosaic_doc).off(\"mousemove\", DragCheckMove);\n                                }\n                            };\n                            $(mosaic_doc).on(\"mousemove\", DragCheckMove);\n                            $(mosaic_doc).on(\"mouseup\", function () {\n                                $(mosaic_doc).off(\"mousemove\", DragCheckMove);\n                            });\n                        });\n                });\n            });\n        };\n\n        /**\n         * Event handler for drag end - add new tile\n         *\n         * @id jQuery.mosaicHandleDragEnd\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicHandleDragEnd = function () {\n            // Get layout object\n            var obj = $(this).parents(\"[data-panel]\");\n\n            // Remove dragging class from content\n            self.mosaic.panels.removeClass(\n                \"mosaic-panel-dragging mosaic-panel-dragging-new\",\n            );\n\n            // Get direction\n            var divider = $(\".mosaic-selected-divider\", mosaic_doc);\n            var drop = divider.parent();\n            var dir = \"\";\n            for (const _dir of [\"top\", \"bottom\", \"left\", \"right\"]) {\n                if (divider.hasClass(\"mosaic-divider-\" + _dir)) {\n                    dir = _dir;\n                }\n            }\n            divider.removeClass(\"mosaic-selected-divider\");\n\n            // True if new tile is inserted\n            var new_tile = $(\".mosaic-helper-tile-new\", mosaic_doc).length > 0;\n            var original_tile = $(\".mosaic-original-tile\", mosaic_doc);\n            // get original row here, because tile might be moved\n            var original_row = original_tile.closest(\".mosaic-grid-row\");\n\n            // If divider is not found or not sane drop, act like esc is pressed\n            if (divider.length === 0 || drop.hasClass(\"mosaic-helper-tile\")) {\n                original_tile.addClass(\"mosaic-drag-cancel\");\n            }\n\n            const fixup_classes = (_t) => {\n                _t.removeClass(\"mosaic-drag-cancel\");\n                _t.removeClass(\n                    \"mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left\",\n                );\n                _t.css({ width: \"\", left: \"\", top: \"\" });\n                if (!new_tile) {\n                    _t.addClass(\"mosaic-new-tile\");\n                }\n            };\n\n            if (\n                // Check if esc is pressed\n                original_tile.hasClass(\"mosaic-drag-cancel\") ||\n                // Not dropped on tile and empty row\n                (drop.hasClass(\"mosaic-tile\") === false &&\n                    drop.hasClass(\"mosaic-innergrid-row\") === false &&\n                    drop.hasClass(\"mosaic-empty-row\") === false) ||\n                // Check if max columns rows is reached\n                (drop.parent().parent().children(\".mosaic-grid-cell\").length >=\n                    obj.data(\"max-columns\") &&\n                    (dir === \"left\" || dir === \"right\"))\n            ) {\n                fixup_classes(original_tile);\n\n                // Dropped on empty row\n            } else if (drop.hasClass(\"mosaic-empty-row\")) {\n                // Replace empty with normal row class\n                drop.removeClass(\"mosaic-empty-row\")\n                    .attr(\n                        \"class\",\n                        original_tile.parents(\".mosaic-grid-row\").first().attr(\"class\"),\n                    )\n                    .off(\"mousemove\");\n\n                // Clean cell\n                drop.children(\".mosaic-grid-cell\").children(\"div\").remove();\n\n                fixup_classes(original_tile);\n\n                // Add tile to empty row\n                drop.children(\".mosaic-grid-cell\").append(original_tile);\n\n                // Dropped on row or below an inner grid\n            } else {\n                /* When the layout object has the special class (Assigned in line 82), wrap\n                the tile in a div.mosaic-grid-cell so it would create an inner column */\n                fixup_classes(original_tile);\n\n                if (obj.hasClass(\"inner-subcolumn\")) {\n                    original_tile = $(mosaic_doc.createElement(\"div\"))\n                        .addClass(\"mosaic-grid-row mosaic-innergrid-row\")\n                        .append(\n                            $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\"mosaic-grid-cell col\")\n                                .append(\n                                    $(mosaic_doc.createElement(\"div\")).append(\n                                        $(mosaic_doc.createElement(\"div\")).addClass(\n                                            \"mosaic-innergrid-outer-border\",\n                                        ),\n                                    ),\n                                )\n                                .append(original_tile),\n                        )\n                        .mosaicAddMouseMoveInnergridRow();\n                    for (const pos of [\"top\", \"bottom\"]) {\n                        original_tile.append(\n                            $(mosaic_doc.createElement(\"div\")).addClass(\n                                \"mosaic-divider mosaic-divider-\" + pos,\n                            ),\n                        );\n                    }\n                }\n\n                // If top\n                if (dir === \"top\") {\n                    // Add tile before\n                    drop.before(original_tile);\n\n                    // If bottom\n                } else if (dir === \"bottom\") {\n                    // Add tile after\n                    drop.after(original_tile);\n\n                    // If left\n                } else if (dir === \"left\" || dir === \"right\") {\n                    var _col = drop.parent();\n                    var _row = _col.parent();\n                    var _children_count = _row.children(\".mosaic-grid-cell\").length;\n\n                    // Check if only 1 column in the row\n                    if (_children_count.length === 1) {\n                        // Put tiles above dropped tile in a new row above\n                        var prev_elms = drop.prevAll();\n                        if (prev_elms.length > 0) {\n                            _row.before(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-row\")\n                                    .append(\n                                        $(mosaic_doc.createElement(\"div\"))\n                                            .addClass(\"mosaic-grid-cell col\")\n                                            .append(\n                                                $(prev_elms.get().reverse())\n                                                    .clone(true)\n                                                    .mosaicAddDrag(),\n                                            ),\n                                    ),\n                            );\n                            prev_elms.remove();\n                        }\n\n                        // Put tiles below dropped tile in a new row below\n                        var next_elms = drop.nextAll();\n                        if (next_elms.length > 0) {\n                            _row.after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-row\")\n                                    .append(\n                                        $(mosaic_doc.createElement(\"div\"))\n                                            .addClass(\"mosaic-grid-cell col\")\n                                            .append(\n                                                next_elms.clone(true).mosaicAddDrag(),\n                                            ),\n                                    ),\n                            );\n                            next_elms.remove();\n                        }\n\n                        // Resize current column\n                        _col.removeClass(self.layout.widthClasses.join(\" \")).addClass(\n                            \"col\",\n                        );\n\n                        // Create column with dragged tile in it\n                        if (dir === \"left\") {\n                            drop.parent().before(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell col\")\n                                    .append(original_tile),\n                            );\n                        } else {\n                            drop.parent().after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell col\")\n                                    .append(original_tile),\n                            );\n                        }\n\n                        // Add resize handles\n                        _row.mosaicSetResizeHandles();\n\n                        // Dropped inside column\n                    } else {\n                        // Create new column\n                        if (dir === \"left\") {\n                            _col.before(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell\")\n                                    .append(original_tile),\n                            );\n                        } else {\n                            _col.after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell\")\n                                    .append(original_tile),\n                            );\n                        }\n\n                        // Resize columns\n                        _row.mosaicSetColumnSizes();\n\n                        // Add resize handles\n                        _row.mosaicSetResizeHandles();\n                    }\n                }\n            }\n\n            // Remove remaining empty rows\n            self.mosaic.panels.find(\".mosaic-grid-row:not(:has(.mosaic-tile))\").remove();\n            self.mosaic.panels.find(\".mosaic-empty-row\").remove();\n\n            // Cleanup original row\n            original_row.mosaicCleanupRow();\n\n            // Add empty rows\n            self.mosaic.panels.mosaicAddEmptyRows();\n\n            // re-initialize events\n            self.init_events();\n\n            // Select new tile and make it draggables\n            if (new_tile && original_tile.length > 0) {\n                original_tile.mosaicAddDrag();\n                original_tile.data(\"mosaic-tile\").initializeContent(true);\n                original_tile.data(\"mosaic-tile\").select();\n            }\n        };\n\n        /**\n         * Set the sizes of the column\n         *\n         * @id jQuery.mosaicSetColumnSizes\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicSetColumnSizes = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Resize columns in the row\n                var column_sizes = [];\n                var $gridCells = $(this).children(\".mosaic-grid-cell\");\n                var nr_of_columns = $gridCells.length;\n                var width_css_classes = self.layout.widthClasses.join(\" \");\n\n                // This will reset the width classes - it will automatically set the widths\n\n                $gridCells.each(function (idx) {\n                    $(this).removeClass(width_css_classes);\n\n                    var col_size = Math.floor(12 / nr_of_columns);\n                    var col_size_last = 12 - col_size * (nr_of_columns - 1);\n\n                    for (var j = 0; j < nr_of_columns; j++) {\n                        if (j === nr_of_columns - 1) {\n                            col_size = col_size_last;\n                        }\n                        if (idx === j) {\n                            column_sizes.push(col_size);\n                            $(this).addClass(\"col\");\n                        }\n                    }\n                });\n\n                $(this).data(\"column_sizes\", column_sizes);\n            });\n        };\n\n        /**\n         * Add new resize handlers\n         *\n         * @id jQuery.mosaicSetResizeHandles\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicSetResizeHandles = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Remove resize handles\n                $(this).children(\".mosaic-resize-handle\").remove();\n\n                // Check number of columns\n                var grid_cells = $(this).children(\".mosaic-grid-cell\");\n                var nr_of_columns = grid_cells.length;\n\n                if (nr_of_columns <= 12) {\n                    var column_sizes = [];\n                    var zero_count = 0;\n                    var col_sum = 0;\n\n                    for (let i = 0; i < nr_of_columns; i++) {\n                        var col_size = GetColSizeByColClass(\n                            self.getWidthClass(grid_cells[i]),\n                        );\n                        column_sizes.push(col_size);\n                        col_sum = col_sum + col_size;\n                        if (col_size === 0) {\n                            zero_count = zero_count + 1;\n                        }\n                    }\n\n                    var zero_col = 0;\n                    if (zero_count) {\n                        zero_col = (12 - col_sum) / zero_count;\n                    }\n\n                    var resize_col_size = 0;\n                    col_size = 0;\n\n                    for (let i = 0; i < nr_of_columns; i++) {\n                        col_size = column_sizes[i] ? column_sizes[i] : zero_col;\n                        resize_col_size = resize_col_size + col_size;\n\n                        $(this).append(\n                            $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\n                                    `mosaic-resize-handle mosaic-resize-handle-${\n                                        i + 1\n                                    }` + ` mosaic-resize-${resize_col_size}`,\n                                )\n                                .data(\"resize_handle_index\", i),\n                        );\n\n                        // set counted size to cell data\n                        $(grid_cells[i]).data(\"col_size\", col_size);\n                    }\n                }\n\n                // Mouse down handler on resize handle\n                $(this)\n                    .children(\".mosaic-resize-handle\")\n                    .off(\"mousedown\")\n                    .on(\"mousedown\", function (/* e */) {\n                        if($(\".mosaic-helper-tile-new\").length > 0) {\n                            // do not resize when we place a new tile\n                            return;\n                        }\n                        var $currRow = $(this).parent();\n                        var $mosaicGridCellChildren = $currRow.children(\".mosaic-grid-cell\");\n\n                        if ($mosaicGridCellChildren.length > 12) {\n                            return;\n                        }\n                        var col_size_sum = 0;\n                        var column_sizes = [];\n\n                        $mosaicGridCellChildren.each(function () {\n                            var col_size = $(this).data(\"col_size\"); // get computed size of the column\n                            column_sizes.push(col_size);\n\n                            var placeholder = $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\n                                    `mosaic-resize-placeholder col-${col_size} mosaic-resize-${col_size_sum}`,\n                                )\n                                .append(\n                                    $(mosaic_doc.createElement(\"div\"))\n                                        .addClass(\n                                            \"mosaic-resize-placeholder-inner-border\",\n                                        )\n                                        .append(\n                                            $(mosaic_doc.createElement(\"div\"))\n                                                .addClass(\"info\")\n                                                .html(col_size),\n                                        ),\n                                );\n\n                            // Add placeholder\n                            $currRow.append(placeholder);\n\n                            // summarize column sizes for placeholder classes\n                            col_size_sum += col_size;\n                        });\n\n                        // Get resize handle index\n                        var resize_handle_index = self.getResizeHandleClassId(this);\n                        // calculate resize helper position\n                        var resize_handle_index_size = column_sizes.reduce((a, b, i) => i <= resize_handle_index ? a + b : a, 0);\n\n                        // Add helper\n                        var $helper = $(\"<div />\")\n                            .addClass(\n                                \"mosaic-resize-handle mosaic-resize-handle-helper\"\n                            )\n                            .addClass(\n                                `mosaic-resize-${resize_handle_index_size}`\n                            )\n                            .data(\"row_width\", $currRow.width())\n                            .data(\"resize_handle_index\", resize_handle_index);\n\n                        // save array as DOM attribute\n                        $helper[0][\"column_sizes\"] = column_sizes;\n\n                        $currRow.append($helper);\n\n                        // Set resizing state\n                        $(this)\n                            .parents(\"[data-panel]\")\n                            .addClass(\"mosaic-panel-resizing\");\n                        $currRow.addClass(\"mosaic-row-resizing\");\n                        $(\".mosaic-selected-tile\", mosaic_doc)\n                            .children(\".mosaic-tile-content\")\n                            .trigger(\"blur\");\n\n                        log.debug(\"------------------resize-handle(click)--------------------\")\n                        log.debug(`resize_handle_index: ${resize_handle_index}`)\n                        log.debug(`resize_handle_index_size: ${resize_handle_index_size}`)\n                        log.debug(`row_width: ${$currRow.width()}`)\n                        log.debug(`column_sizes: ${column_sizes}`)\n\n                        // Prevent drag event\n                        return false;\n                    });\n            });\n        };\n\n        /**\n         * Cleanup row after tiles added or removed from the row\n         *\n         * @id jQuery.mosaicCleanupRow\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicCleanupRow = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Get original row\n                var original_row = $(this);\n\n                // Remove empty columns\n                original_row.children(\".mosaic-grid-cell\").each(function () {\n                    if ($(this).children().length === 0) {\n                        $(this).remove();\n\n                        // Resize columns\n                        original_row.mosaicSetColumnSizes();\n                    }\n                });\n\n                // Remove row if no tiles inside\n                if (original_row.find(\".mosaic-tile\").length === 0) {\n                    var del_row = original_row;\n\n                    // Check if next row available\n                    if (original_row.nextAll(\".mosaic-grid-row\").length > 0) {\n                        original_row = original_row.next(\".mosaic-grid-row\");\n\n                        // Check if prev row available\n                    } else if (original_row.prevAll(\".mosaic-grid-row\").length > 0) {\n                        original_row = original_row.prev(\".mosaic-grid-row\");\n\n                        // This is the last row\n                    } else {\n                        original_row.remove();\n                        return;\n                    }\n\n                    // Remove current row\n                    del_row.remove();\n                }\n\n                // Set resize handles\n                original_row.mosaicSetResizeHandles();\n            });\n        };\n\n        /**\n         * Get the direction based on the tile size and relative x and y coords of the cursor\n         *\n         * @id jQuery.mosaicGetDirection\n         * @param {Object} e Event object\n         * @return {String} Direction of the cursor relative to the tile\n         */\n        $.fn.mosaicGetDirection = function (e) {\n            // Calculate x, y, width and height\n            var width = parseFloat($(this).width());\n            var height = parseFloat($(this).height());\n            var x = parseFloat(e.pageX - $(this).offset().left - width / 2);\n            var y = parseFloat(e.pageY - $(this).offset().top - height / 2);\n            var halfwidth = width / 2;\n            var halfheight = height / 2;\n\n            // If left of center\n            if (x < 0) {\n                // If above center\n                if (y < 0) {\n                    if (x / y < (-1 * halfwidth) / (-1 * halfheight)) {\n                        return \"top\";\n                    } else {\n                        return \"left\";\n                    }\n                    // Below center\n                } else {\n                    if (x / y < (-1 * halfwidth) / halfheight) {\n                        return \"left\";\n                    } else {\n                        return \"bottom\";\n                    }\n                }\n\n                // Right of center\n            } else {\n                // If above center\n                if (y < 0) {\n                    if (x / y < (1 * halfwidth) / (-1 * halfheight)) {\n                        return \"right\";\n                    } else {\n                        return \"top\";\n                    }\n                    // Below center\n                } else {\n                    if (x / y < halfwidth / halfheight) {\n                        return \"bottom\";\n                    } else {\n                        return \"right\";\n                    }\n                }\n            }\n        };\n    }\n}\n\nvar AddResetAnchor = function ($tileSideTools, cols) {\n    var reset = document.createElement(\"a\");\n    var cols_str = typeof cols === \"undefined\" ? \"\" : \" (\" + cols + \")\";\n    reset.href = \"javascript:\";\n    reset.textContent = \"Reset\" + cols_str;\n    $(reset).on(\"click\", { el: $tileSideTools }, function (e) {\n        e.preventDefault();\n\n        e.data.el\n            .parent()\n            .parent()\n            .removeClass(\n                \"col-1 col-2 col-3 col-4 col-5 col-6 col-7 col-8 col-9 col-10 col-11 col-12\",\n            )\n            .addClass(\"col\");\n\n        e.data.el.parent().parent().parent().mosaicSetResizeHandles();\n\n        $(e.target).parent().remove();\n    });\n    return reset;\n};\n\n/**\n * Get a list of percentage steps for each column in the grid\n *\n * @id GetGridPercentList\n * @return {Array} List of percent steps of the width class\n */\nfunction GetGridPercentList() {\n    var low = 0,\n        high = 100,\n        grid = 12,\n        grid_percent = [];\n    var step = 100 / grid;\n    var a = low,\n        b = high - 1; /* fix the last step in the loop: -1 */\n    while (a < b) {\n        grid_percent.push(Math.round((a += step)));\n    }\n\n    return grid_percent;\n}\n\n/**\n * Get the name of the width class of the given integer\n *\n * @id GetWidthClassByColSize\n * @param {Integer} col_size Bootstrap col width id\n * @return {String} Classname of the width class of the given integer\n */\nfunction GetWidthClassByColSize(col_size) {\n    if (col_size) {\n        return \"col-\" + col_size;\n    }\n\n    // Fallback\n    return \"col\";\n}\n\n/**\n * Get the name of the position class of the given integer\n *\n * @id GetColSizeByColClass\n * @param {String} Classname of the position class\n * @return {Integer} col_size Bootstrap col width id\n */\nfunction GetColSizeByColClass(col_class, prefix) {\n    prefix = prefix || \"col-\";\n    return parseInt(col_class.replace(prefix, \"\")) || 0;\n}\n\n/**\n * Get the bootstrap col width id by width size\n *\n * @id GetBootstrapColByPercent\n * @param {Integer} width Percentage of the column position\n * @return {Integer} Bootstrap col width id of the given integer\n */\nfunction GetBootstrapColByPercent(width) {\n    var grid_percent = GetGridPercentList();\n\n    for (let idx = 0; idx < grid_percent.length; idx++) {\n        if (width === grid_percent[idx]) {\n            return idx + 1;\n        }\n    }\n\n    // Fallback\n    return 12;\n}\n"],"names":["log","logging","getLogger","LayoutManager","constructor","mosaic","this","layout","widthClasses","resizeClasses","resizeHandleClasses","getWidthClass","e","cls","$","hasClass","getResizeHandleClassId","idx","length","addAppTile","type","url","success","async","value","getDomTreeFromHtml","addHeadTags","addTile","find","html","addAppTileHTML","response","editAppTile","self","window","parent","focus","removeHeadTags","$tile","document","attr","replace","tileUrl","panels","addClass","add_helper","createElement","classList","add","innerHTML","append","helper","width","each","tile","Tile","initialize","cacheHtml","scanRegistry","getDefaultValue","tile_config","start","end","name","tile_type","widget","id","val","label","default_value","getPageContent","exportLayout","content","getLayoutRow","obj","body","classNames","children","data","getHtmlBody","options","saveLayoutToForm","$customLayout","hasContentLayout","init_events","events","add_event_listener","_document","keyCode","querySelectorAll","forEach","blur","focused_tile","activeElement","closest","removeClass","date","Date","getTime","original_tile","contains","$orig_row","remove","mosaicCleanupRow","trigger","parents","enabled","elm","target","srcElement","new_tile","mosaicHandleDragEnd","el","toolbar","SelectedTileChange","DocumentMousemove","$new_tile_helper","offset","css","pageY","top","pageX","left","$helper","cur_snap_offset","$row","resize_handle_index","mouse_x","parseFloat","mouse_percentage","Math","round","snap","snap_offset","GetGridPercentList","perc","abs","snap_size","grid_percent","GetBootstrapColByPercent","column_sizes","column_sizes_sum","reduce","a","b","col_size_before","slice","col_size_after","col_size_max","new_column_size","new_column_sizes","i","push","_last_size","debug","col_size_sum","resize_css_classes","join","width_css_classes","col_size","col_size_class","GetWidthClassByColSize","panel","css_width_classes","first","$tileSideTools","AddResetAnchor","mosaicSetResizeHandles","select","TileMousemove","dir","mosaicGetDirection","divider","row","filter","height","CustomCSSOnDblClick","custom_classes","split","undefined","input","div","gridrow","base_css","initialize_panels","initJQueryHelpers","total","mosaicAddDrag","mosaicAddEmptyRows","index","j","eq","mosaicAddMouseMoveInnergridRow","that","pos","mosaic_doc","mosaicAddMouseMoveEmptyRow","on","before","nextAll","after","DragMove","event","DragStop","off","downX","downY","DragCheckMove","max","originaltile","clone","drop","_dir","original_row","fixup_classes","_t","_col","_row","prev_elms","prevAll","get","reverse","next_elms","mosaicSetColumnSizes","initializeContent","$gridCells","nr_of_columns","floor","col_size_last","grid_cells","zero_count","col_sum","GetColSizeByColClass","zero_col","resize_col_size","$currRow","$mosaicGridCellChildren","placeholder","resize_handle_index_size","del_row","next","prev","x","y","halfwidth","halfheight","cols","reset","cols_str","href","textContent","preventDefault","high","col_class","prefix","parseInt"],"sourceRoot":""}