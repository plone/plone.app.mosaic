{"version":3,"file":"chunks/15528.c948a471d704a52304c4.min.js","mappings":"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","sources":["webpack://plone-mosaic/./resources/js/mosaic.layout.js"],"sourcesContent":["// This plugin is used to create a mosaic layout.\nimport \"regenerator-runtime/runtime\"; // needed for ``await`` support\nimport $ from \"jquery\";\nimport logging from \"@patternslib/patternslib/src/core/logging\";\nimport events from \"@patternslib/patternslib/src/core/events\";\nimport Tile from \"./mosaic.tile\";\nimport mosaic_utils from \"./utils\";\n\nconst log = logging.getLogger(\"pat-mosaic/layout\");\n\nfunction validMosaicTile(el) {\n    if (el.closest(\".mosaic-tile\")) {\n        return true;\n    }\n    return false;\n}\n\nexport default class LayoutManager {\n    constructor(mosaic) {\n        this.mosaic = mosaic;\n    }\n\n    layout = {\n        widthClasses: [\n            \"col\",\n            \"col-1\",\n            \"col-2\",\n            \"col-3\",\n            \"col-4\",\n            \"col-5\",\n            \"col-6\",\n            \"col-7\",\n            \"col-8\",\n            \"col-9\",\n            \"col-10\",\n            \"col-11\",\n            \"col-12\",\n        ],\n        resizeClasses: [\n            \"mosaic-resize-1\",\n            \"mosaic-resize-2\",\n            \"mosaic-resize-3\",\n            \"mosaic-resize-4\",\n            \"mosaic-resize-5\",\n            \"mosaic-resize-6\",\n            \"mosaic-resize-7\",\n            \"mosaic-resize-8\",\n            \"mosaic-resize-9\",\n            \"mosaic-resize-10\",\n            \"mosaic-resize-11\",\n            \"mosaic-resize-12\",\n            // 5-column support\n            \"mosaic-resize-2.4\",\n            \"mosaic-resize-4.8\",\n            \"mosaic-resize-7.2\",\n            \"mosaic-resize-9.6\",\n        ],\n        resizeHandleClasses: [\n            \"mosaic-resize-handle-1\",\n            \"mosaic-resize-handle-2\",\n            \"mosaic-resize-handle-3\",\n            \"mosaic-resize-handle-4\",\n            \"mosaic-resize-handle-5\",\n            \"mosaic-resize-handle-6\",\n            \"mosaic-resize-handle-7\",\n            \"mosaic-resize-handle-8\",\n            \"mosaic-resize-handle-9\",\n            \"mosaic-resize-handle-10\",\n            \"mosaic-resize-handle-11\",\n            \"mosaic-resize-handle-12\",\n        ],\n    };\n\n    /* css helpers */\n    getWidthClass(e) {\n        for (const cls of this.layout.widthClasses) {\n            if (e.classList.contains(cls)) {\n                return cls;\n            }\n        }\n        // Fallback\n        return this.layout.widthClasses[0];\n    }\n\n    getResizeHandleClassId(e) {\n        // Loop through resize handle classes\n        let handleIdx = 0;\n        this.layout.resizeHandleClasses.forEach((cls, idx) => {\n            if (e.classList.contains(cls)) {\n                handleIdx = idx;\n            }\n        })\n        return handleIdx;\n    }\n\n    async addAppTileHTML(type, response, url) {\n        let value = this.mosaic.getDomTreeFromHtml(response);\n        this.mosaic.addHeadTags(url, value);\n        await this.addTile(type, value.find(\".temp_body_tag\").html(), url);\n    }\n\n    async addTile(type, value, tileUrl) {\n        var self = this;\n        // Set dragging state\n        self.mosaic.panels.addClass(\"mosaic-panel-dragging mosaic-panel-dragging-new\");\n\n        // Add helper\n        const add_helper = document.createElement(\"div\");\n        add_helper.classList.add(\"mosaic-grid-row\");\n        add_helper.innerHTML = (\n            `<div class=\"mosaic-grid-cell col\">` +\n            `<div class=\"movable removable mosaic-tile mosaic-${type}-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-original-tile\">` +\n            `<div class=\"mosaic-tile-content\" data-tileUrl=\"${tileUrl && tileUrl.replace(/&/gim, \"&amp;\")}\">` +\n            value +\n            `</div>` +\n            `</div>` +\n            `</div>`\n        );\n        self.mosaic.panels[0].append(add_helper);\n\n        // Set helper min size\n        var helper = self.mosaic.panels.find(\".mosaic-helper-tile-new\");\n\n        // Get max width\n        var width = 0;\n        self.mosaic.panels.each(function () {\n            if ($(this).width() > width) {\n                width = $(this).width();\n            }\n        });\n\n        // Set width\n        if (helper.width() < width / 4) {\n            helper.width(width / 4);\n        } else {\n            helper.width(helper.width());\n        }\n\n        var tile = new Tile(self.mosaic, helper);\n        await tile.initialize();\n\n        tile.cacheHtml();\n        await tile.scanRegistry();\n    }\n\n    async copyTile(orig_tile) {\n        const orig_tile_inst = orig_tile[0][\"mosaic-tile\"];\n        const tile_type = orig_tile_inst.getType();\n\n        // remove class\n        orig_tile.removeClass(\"mosaic-original-tile\");\n        const orig_parent = orig_tile.closest(\".mosaic-grid-row\");\n        // create copy tile helper\n        const copy_tile_id = mosaic_utils.generate_uid();\n        let $copy_tile_helper = $(\n            `<div class=\"mosaic-grid-cell col\">` +\n            `<div class=\"movable removable copyable mosaic-tile mosaic-${tile_type}-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-original-tile\">` +\n            `<div class=\"mosaic-tile-content\" data-tileUrl=\"./@@${tile_type}/${copy_tile_id}\">` +\n            orig_tile_inst.getHtmlContent() +\n            `</div>` +\n            `</div>` +\n            `</div>`);\n        orig_parent.append($copy_tile_helper);\n\n        var tile = new Tile(this.mosaic, $copy_tile_helper.find(\".mosaic-tile\"));\n        await tile.initialize();\n        // save copied content\n        tile.save();\n\n        if (tile.getConfig().tile_type == \"app\") {\n            // copy the data from original tile too\n            const orig_tile_data = await orig_tile_inst.serialize();\n            await tile.deserialize(orig_tile_data);\n        }\n\n        tile.cacheHtml();\n        await tile.scanRegistry();\n\n        return tile.$el;\n    }\n\n    getDefaultValue(tile_config) {\n        var self = this;\n        var start, end;\n\n        // Wrap title and description fields for proper styles\n        if (tile_config.name === \"IDublinCore-title\") {\n            start = '<h1 class=\"documentFirstHeading\">';\n            end = \"</h1>\";\n        } else if (tile_config.name === \"IDublinCore-description\") {\n            start = '<p class=\"documentDescription\">';\n            end = \"</p>\";\n        } else {\n            start = \"<div>\";\n            end = \"</div>\";\n        }\n\n        if (tile_config.tile_type == \"field\") {\n            switch (tile_config.widget) {\n                case \"z3c.form.browser.text.TextWidget\":\n                case \"z3c.form.browser.text.TextFieldWidget\":\n                    var textval = $(\"#\" + tile_config.id, self.mosaic.document)\n                        .find(\"input\")\n                        .attr(\"value\");\n                    return `${start}${textval}${end}`;\n                case \"z3c.form.browser.textarea.TextAreaWidget\":\n                case \"z3c.form.browser.textarea.TextAreaFieldWidget\":\n                case \"z3c.form.browser.textlines.TextLinesWidget\":\n                case \"z3c.form.browser.textlines.TextLinesFieldWidget\":\n                    var lines = $(\"#\" + tile_config.id, self.mosaic.document)\n                        .find(\"textarea\")\n                        .val()\n                        .replace(\"\\\\n\", \"<br/>\");\n                    return `${start}${lines}${end}`;\n                case \"plone.app.z3cform.widget.RichTextFieldWidget\":\n                case \"plone.app.z3cform.widgets.richtext.RichTextFieldWidget\":\n                case \"plone.app.z3cform.wysiwyg.widget.WysiwygWidget\":\n                case \"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget\":\n                case \"plone.app.widgets.dx.RichTextWidget\":\n                    return $(\"#\" + tile_config.id)\n                        .find(\"textarea\")\n                        .val();\n                default:\n                    return `<div class=\"text-bg-secondary\">Placeholder for field:<br/><b>${tile_config.label}</b></div>`;\n            }\n        } else {\n            return tile_config.default_value;\n        }\n    }\n\n    getPageContent(exportLayout) {\n        var getLayoutRow = (obj) => {\n            let body = \"\";\n\n            // if empty return\n            if (!obj.querySelectorAll(\".mosaic-tile\").length) {\n                return body;\n            }\n\n            // Add row open tag\n            body += `<div class=\"${obj.getAttribute('class')}\">\\n`;\n\n            // Loop through cells\n            for (const cell of obj.children) {\n                if (!cell.classList.contains(\"mosaic-grid-cell\")) {\n                    continue;\n                }\n\n                body += `<div class=\"${cell.getAttribute('class')}\">\\n`;\n\n                for (const child of cell.children) {\n                    if (child.classList.contains(\"mosaic-innergrid-row\")) {\n                        body += getLayoutRow(child);\n                    }\n                    if (child.classList.contains(\"mosaic-tile\")) {\n                        body += child[\"mosaic-tile\"].getHtmlBody(exportLayout);\n                    }\n                };\n\n                body += \"</div>\\n\";\n            };\n\n            // Add row close tag\n            body += \"</div>\";\n            return body;\n        };\n\n        // Content\n        let body = \"<body>\";\n\n        // Loop through panels\n        const panels = this.mosaic.document.querySelectorAll(\"[data-panel]\");\n\n        panels.forEach(panel => {\n            body += `<div data-panel=\"${panel.dataset?.panel}\" data-max-colums=\"${panel.dataset?.maxColumns || 6}\">`\n            for (const row of panel.children) {\n                if (row.classList.contains(\"mosaic-empty-row\")) {\n                    continue;\n                }\n                body += getLayoutRow(row);\n            };\n            // Add close panel tag\n            body += \"</div>\";\n        });\n\n        // Add close tag\n        body += \"</body>\";\n\n        return `<!DOCTYPE html><html data-layout=\"${this.mosaic.options.layout}\">${body}</html>`;\n    }\n\n    saveLayoutToForm() {\n        var self = this;\n        const customLayout = this.mosaic.document.querySelector(\n            \"[name='form.widgets.ILayoutAware.customContentLayout']\"\n        );\n\n        if (self.mosaic.hasContentLayout) {\n            customLayout.value = \"\";\n        } else if (!customLayout) {\n            alert(\"Could not save layout. Please reload page.\");\n        } else {\n            log.debug(`saving pageContent to field`);\n            const pageContent = self.getPageContent();\n            customLayout.value = pageContent;\n        }\n    }\n\n    init_events() {\n        var self = this;\n        const _document = this.mosaic.document;\n        const _panels = _document.querySelectorAll(\".mosaic-panel\");\n\n        if (_panels.length == 0) {\n            console.log(\"No mosaic panel found!\");\n            return\n        }\n        else if (_panels.length > 1) {\n            console.log(\"More than one mosaic panels found -> initializing events only for first panel!\");\n        }\n\n        const _panel = _panels[0];\n\n        var DocumentKeyup = function (e) {\n            // Check if alt\n            if (e.keyCode === 18) {\n                // check for copy mode\n                if (_panel.classList.contains(\"mosaic-panel-dragging-copy\")) {\n                    _panel.classList.remove(\"mosaic-panel-dragging-copy\");\n                } else {\n                    var date = new Date();\n                    var elapsed = date.getTime() - parseInt(_panel[\"mosaic-advanced-enabled\"]);\n                    if (elapsed > 400) {\n                        _panel.classList.remove(\"mosaic-advanced\");\n                    }\n                }\n            }\n            // Check if ctrl\n            if (e.keyCode === 17) {\n                _panel.classList.remove(\"inner-subcolumn\");\n            }\n        };\n\n        // Keydown handler\n        var DocumentKeydown = function (e) {\n            // Tab key\n            if (e.keyCode === 9) {\n                // blur all active tiles. and set focus\n                _document.querySelectorAll(\".mosaic-selected-tile\").forEach(async tile => await tile[\"mosaic-tile\"].blur());\n                // focus new tile\n                var focused_tile = document.activeElement.closest(\".mosaic-tile\");\n                if (focused_tile) {\n                    $(focused_tile).data(\"mosaic-tile\").focus();\n                }\n            }\n            // Check if alt\n            if (e.keyCode === 18) {\n                // pressing alt during existing tile dragging checks for possible copy mode\n                // see mosaic.tile.js -> COPYABLE_TILE_TYPES\n                const orig_tile = _panel.querySelector(\".mosaic-original-tile\");\n                if (\n                    _panel.classList.contains(\"mosaic-panel-dragging\") &&\n                    !_panel.classList.contains(\"mosaic-panel-dragging-new\")\n                ) {\n                    const cpy_class = orig_tile?.classList.contains(\"copyable\") ? \"copy\" : \"unique\";\n                    _panel.classList.add(`mosaic-panel-dragging-${cpy_class}`);\n                }\n                else if (_panel.classList.contains(\"mosaic-advanced\")) {\n                    _panel.classList.remove(\"mosaic-advanced\");\n                } else {\n                    _panel.classList.add(\"mosaic-advanced\");\n                    _panel[\"mosaic-advanced-enabled\"] = (new Date()).getTime();\n                }\n            }\n            // Check if ctrl\n            if (e.keyCode === 17) {\n                _panel.classList.add(\"inner-subcolumn\");\n            }\n\n            // Check if esc\n            if (e.keyCode === 27) {\n                // Check if dragging\n                var original_tile = _panel.querySelectorAll(\".mosaic-original-tile\");\n                if (original_tile.length > 0) {\n                    original_tile.forEach((tile) => {\n                        tile.classList.add(\"mosaic-drag-cancel\");\n                        if (tile.classList.contains(\"mosaic-helper-tile-new\")) {\n                            // original row\n                            const $orig_row = $(tile).parent().parent();\n                            // dismiss dragging tile and cleanup row\n                            $(tile).remove();\n                            $orig_row.mosaicCleanupRow();\n                            // Remove dragging class from content\n                            _panel.classList.remove(\n                                \"mosaic-panel-dragging\", \"mosaic-panel-dragging-new\",\n                            );\n                            // Hide all dividers\n                            _document.querySelectorAll(\".mosaic-selected-divider\").forEach(divider => {\n                                divider.classList.remove(\"mosaic-selected-divider\");\n                            });\n                        }\n                    });\n                    // Deselect tile\n                } else {\n                    $(\".mosaic-selected-tile\", _document).each(function () {\n                        $(this).trigger(\"blur\");\n                    });\n                }\n\n                // Find resize helper\n                $(\".mosaic-resize-handle-helper\", _document).each(function () {\n                    // Remove resizing state\n                    $(this).parents(\"[data-panel]\").removeClass(\"mosaic-panel-resizing\");\n                    $(this).parent().removeClass(\"mosaic-row-resizing\");\n                    $(this).parent().children(\".mosaic-resize-placeholder\").remove();\n                    // Remove helper\n                    $(this).remove();\n                });\n            }\n        };\n\n        // Bind event and add to array\n        events.add_event_listener(\n            _document,\n            \"keydown\",\n            \"pat-layout--keydown\",\n            DocumentKeydown,\n        );\n        events.add_event_listener(\n            _document,\n            \"keyup\",\n            \"pat-layout--keyup\",\n            DocumentKeyup,\n        );\n\n        // mousedown event\n        const DocumentMousedown = function (e) {\n            // Get element\n            let elm;\n            if (e.target) {\n                elm = e.target;\n            } else if (e.srcElement) {\n                elm = e.srcElement;\n            }\n\n            // Find new tile helper\n            var new_tile = $(\".mosaic-helper-tile-new\", self.mosaic.document);\n            if (new_tile.length > 0) {\n                new_tile.each(function () {\n                    // Handle drag end\n                    $(this).mosaicHandleDragEnd();\n                });\n                return;\n            }\n\n            // If clicked inside TinyMCE or Modal exit\n            if (elm.closest(\".mce-content-body, .tox, .modal-wrapper\")) {\n                return;\n            }\n\n            // If clicked outside a tile\n            if (!elm.closest(\".mosaic-tile\")) {\n                log.debug(\"Clicked outside tile -> trigger blur event\");\n                // Deselect tiles\n                self.mosaic.document\n                    .querySelectorAll(\".mosaic-selected-tile:not(.mosaic-tile-loading)\")\n                    .forEach(async el => await el[\"mosaic-tile\"].blur());\n                // Check if outside toolbar\n                if (!elm.closest(\".mosaic-toolbar\")) {\n                    // Set actions\n                    self.mosaic.toolbar.SelectedTileChange();\n                }\n            }\n        };\n\n        // Bind event and add to array\n        events.add_event_listener(\n            self.mosaic.document,\n            \"mousedown\",\n            \"pat-layout--mousedown-document\",\n            DocumentMousedown,\n        );\n\n        let scrollInterval = null;\n\n        const stopScroll = () => {\n            if (scrollInterval) {\n                clearInterval(scrollInterval);\n                scrollInterval = null;\n            }\n        };\n\n        const startScroll = (diff) => {\n            if (scrollInterval) return;\n            scrollInterval = setInterval(() => {\n                window.scrollBy(0, diff);\n            }, 50);\n        };\n\n        const checkScroll = (e) => {\n            const scrollMargin = 60;\n            const scrollSpeed = 100;\n            const viewportHeight = window.innerHeight;\n\n            if (e.clientY < scrollMargin) {\n                startScroll(-scrollSpeed);\n            } else if (e.clientY > (viewportHeight - scrollMargin)) {\n                startScroll(scrollSpeed);\n            } else {\n                stopScroll();\n            }\n\n        };\n\n        // Handle mouse move event: when holding down mouse left button and dragging the handler left or right.\n        const DocumentMousemove = function (e) {\n            // Get new tile helper\n            var $new_tile_helper = $(\".mosaic-helper-tile-new\", self.mosaic.document);\n\n            if ($new_tile_helper.length) {\n                // Get offset\n                const offset = $new_tile_helper.parent().offset();\n                // Get mouse x\n                $new_tile_helper.css(\"top\", e.pageY + 3 - offset.top);\n                $new_tile_helper.css(\"left\", e.pageX + 3 - offset.left);\n            }\n\n            // Get resize handle helper\n            var $helper = $(\".mosaic-resize-handle-helper\", self.mosaic.document);\n\n            if ($helper.length) {\n                // Get row\n                var $row = $helper.parent();\n                var resize_handle_index = $helper.data(\"resize_handle_index\");\n\n                // Get mouse x\n                var mouse_x = parseFloat(\n                    e.pageX - // current mouseX\n                    $row.offset().left - // current row position left\n                    parseInt(getComputedStyle($row[0]).paddingLeft) - // calculated padding (eg fluid-background-row)\n                    4 // centered handler\n                );\n\n                // Get mouse percentage\n                var mouse_percentage = Math.round(\n                    (mouse_x / $helper.data(\"row_width\")) * 100\n                );\n\n                // Get closest snap location\n                var snap = 8;\n                var snap_offset = 8;\n                var cur_snap_offset;\n                var grid_percent = GetGridPercentList();\n\n                grid_percent.forEach(function (perc) {\n                    cur_snap_offset = Math.abs(perc - mouse_percentage);\n                    if (cur_snap_offset < snap_offset) {\n                        snap = perc;\n                        snap_offset = cur_snap_offset;\n                    }\n                });\n\n                var snap_size = GetBootstrapColByPercent(snap);\n\n                var column_sizes = $helper[0][\"column_sizes\"];\n                // sum of all column sizes\n                var column_sizes_sum = column_sizes.reduce((a, b) => a + b, 0);\n                // sum of sizes before helper index\n                var col_size_before = column_sizes.slice(0, resize_handle_index).reduce((a, b) => a + b, 0);\n                // sum of sizes after helper index excluding last column (which is elastic)\n                var col_size_after = column_sizes.slice(resize_handle_index + 1, -1).reduce((a, b) => a + b, 0);\n                // calculate maximum size of current column\n                var col_size_max = 12\n                if (resize_handle_index == (column_sizes.length - 1)) {\n                    // if last column, we can drag to full width (12)\n                    col_size_max = 12 - col_size_before - col_size_after;\n                } else {\n                    // if not last column, we respect last elastic column (min-size: 1)\n                    // with its fixed right margin\n                    col_size_max = column_sizes_sum - col_size_before - col_size_after - 1;\n                }\n                var new_column_size = snap_size - col_size_before;\n                // limit to maximum of col_sizes_sum and minimum of 1\n                new_column_size = new_column_size > col_size_max ? col_size_max : new_column_size < 1 ? 1 : new_column_size;\n                let new_column_sizes = [];\n\n                column_sizes.forEach((width, i) => {\n                    if (i === resize_handle_index) {\n                        // set new size for current column\n                        new_column_sizes.push(new_column_size);\n                    } else if (i === (column_sizes.length - 1)) {\n                        // calculate elastic size for last column\n                        var _before = new_column_sizes.reduce((a, b) => a + b);\n                        var _last_size = column_sizes_sum - _before;\n                        // _last_size cannot be lower than 1\n                        new_column_sizes.push(_last_size < 1 ? 1 : _last_size);\n                    } else {\n                        new_column_sizes.push(width);\n                    }\n                })\n\n                log.debug(\"------------------resize-handle(move)--------------------\")\n                log.debug(`mouse_x: ${mouse_x}`);\n                log.debug(`mouse_percentage: ${mouse_percentage}`);\n                log.debug(`resize_handle_index: ${resize_handle_index}`);\n                log.debug(`column_sizes: ${column_sizes}`);\n                log.debug(`column_sizes_sum: ${column_sizes_sum}`);\n                log.debug(`cur_snap_offset: ${cur_snap_offset}`);\n                log.debug(`snap: ${snap}`);\n                log.debug(`snap_size: ${snap_size}`);\n                log.debug(`col_size_before: ${col_size_before}`);\n                log.debug(`col_size_after: ${col_size_after}`);\n                log.debug(`col_size_max: ${col_size_max}`);\n                log.debug(`new_column_size: ${new_column_size}`);\n                log.debug(`new_column_sizes: ${new_column_sizes}`);\n\n                var col_size_sum = 0;\n                var resize_css_classes = self.layout.resizeClasses.join(\" \");\n                var width_css_classes = self.layout.widthClasses.join(\" \");\n\n                $row.children(\".mosaic-resize-placeholder\").each(function (idx) {\n                    var col_size = column_sizes[idx];\n                    var col_size_class = GetWidthClassByColSize(col_size);\n\n                    // placeholder width and position\n                    $(this)\n                        .removeClass(`${width_css_classes} ${resize_css_classes}`)\n                        .addClass(`${col_size_class} mosaic-resize-${col_size_sum}`)\n                        .find(\".info\")\n                        .html(col_size);\n\n                    col_size_sum += col_size;\n\n                    if (idx === resize_handle_index) {\n                        // move resize handle helper\n                        $helper\n                            .removeClass(resize_css_classes)\n                            .addClass(`mosaic-resize-${col_size_sum}`);\n                    }\n                });\n\n                // Set new size\n                $helper[0][\"column_sizes\"] = new_column_sizes;\n            }\n\n            if (_panel.classList.contains(\"mosaic-panel-dragging\")) {\n                // scroll up an down if reaching top or bottom of viewport\n                checkScroll(e);\n            }\n\n        };\n\n        // Bind event and add to array\n        events.add_event_listener(\n            self.mosaic.document,\n            \"mousemove\",\n            \"pat-layout--mousemove\",\n            DocumentMousemove,\n        );\n        events.add_event_listener(\n            self.mosaic.document,\n            \"dragover\",\n            \"pat-layout--dragover\",\n            DocumentMousemove,\n        );\n\n        // Handle mouse up event\n        // When resizing is done on mouse up event apply the changes to the div elements\n        const DocumentMouseup = function () {\n            // stop scrolling\n            stopScroll();\n\n            // Find resize helper\n            $(\".mosaic-resize-handle-helper\", self.mosaic.document).each(function () {\n\n                var resize_handle_index = $(this).data(\"resize_handle_index\");\n\n                // Cleanup original row\n                $(this).parent().parent().mosaicCleanupRow();\n\n                // Get panel\n                var panel = $(this).closest(\"[data-panel]\");\n\n                // Get column sizes\n                var column_sizes = $(this)[0][\"column_sizes\"];\n                var css_width_classes = self.layout.widthClasses.join(\" \");\n\n                // Set column sizes\n                $(this)\n                    .parent()\n                    .children(\".mosaic-grid-cell\")\n                    .each(function (i) {\n                        $(this)\n                            .removeClass(css_width_classes)\n                            .addClass(GetWidthClassByColSize(column_sizes[i]));\n\n                        var can_reset = $(this).hasClass(\"col\");\n                        if (!can_reset && i === resize_handle_index) {\n                            $(this)\n                                .children(\".mosaic-tile\")\n                                .first()\n                                .children(\".mosaic-tile-side-tools\")\n                                .each(function () {\n                                    var $tileSideTools = $(this);\n\n                                    $tileSideTools\n                                        .children(\".mosaic-tile-label.reset\")\n                                        .remove();\n\n                                    $tileSideTools.append(\n                                        $(self.mosaic.document.createElement(\"div\"))\n                                            .addClass(\"mosaic-tile-label reset\")\n                                            .append(\n                                                AddResetAnchor(\n                                                    $tileSideTools,\n                                                    column_sizes[i],\n                                                ),\n                                            ),\n                                    );\n                                });\n                        }\n                    });\n\n                // Remove resizing state\n                panel.removeClass(\"mosaic-panel-resizing\");\n                $(this).parent().removeClass(\"mosaic-row-resizing\");\n                $(this).parent().children(\".mosaic-resize-placeholder\").remove();\n\n                // Set resize handles\n                $(this).parent().mosaicSetResizeHandles();\n                var $tile = panel.find(\".mosaic-selected-tile\");\n                if ($tile.length > 0) {\n                    $tile.data(\"mosaic-tile\").select();\n                }\n\n                // Remove helper\n                $(this).remove();\n            });\n        };\n\n        // Bind event\n        events.add_event_listener(\n            self.mosaic.document,\n            \"mouseup\",\n            \"pat-layout--mouseup\",\n            DocumentMouseup,\n        );\n\n        // Handle mousemove on tile\n        const TileMousemove = function (e) {\n\n            // only if dragging\n            if (\n                $(this).parents(\"[data-panel]\").hasClass(\"mosaic-panel-dragging\") ===\n                false\n            ) {\n                return;\n            }\n\n            // Hide all dividers\n            $(\".mosaic-selected-divider\", self.mosaic.document).removeClass(\n                \"mosaic-selected-divider\",\n            );\n\n            // Don't show dividers if above original or floating tile\n            // but not in copy mode\n            if (\n                (!$(this).parents(\"[data-panel]\").hasClass(\"mosaic-panel-dragging-copy\") &&\n                    $(this).hasClass(\"mosaic-original-tile\")) ||\n                $(this).hasClass(\"mosaic-tile-align-left\") ||\n                $(this).hasClass(\"mosaic-tile-align-right\")\n            ) {\n                return;\n            }\n\n            // Get direction\n            var dir = $(this).mosaicGetDirection(e);\n            var divider = $(this).children(\".mosaic-divider-\" + dir);\n\n            // Check if left or right divider\n            if (dir === \"left\" || dir === \"right\") {\n                var row = divider.closest(\".mosaic-grid-row\");\n                var cols = row.children(\".mosaic-grid-cell\").filter((idx, el) => {\n                    // filter out original tile to enable moving tiles\n                    // inside row with max-columns tiles\n                    return $(el).find(\".mosaic-original-tile\").length === 0;\n                });\n\n                if (cols.length >= $(\".mosaic-panel\").data(\"max-columns\")) {\n                    // This row already up to the max amount of columns allowed for this layout\n                    // do not allow new items to be dropped alingside any elements in this row.\n                    return;\n                }\n\n                // If row has multiple columns\n                if (row.children(\".mosaic-grid-cell\").length > 1) {\n                    divider.height(row.height() + 5);\n                    divider.css(\n                        \"top\",\n                        row.offset().top - divider.parent().offset().top - 5,\n                    );\n                } else {\n                    divider.height(divider.parent().height() + 5);\n                    divider.css(\"top\", -5);\n                }\n            }\n\n            // Show divider\n            divider.addClass(\"mosaic-selected-divider\");\n        };\n\n        // Bind events\n        self.mosaic.document.querySelectorAll(\".mosaic-tile\").forEach((tile) => {\n            events.add_event_listener(\n                tile,\n                \"mousemove\",\n                \"pat-layout--mousemove-tile\",\n                TileMousemove,\n            );\n            events.add_event_listener(\n                tile,\n                \"dragover\",\n                \"pat-layout--dragover-tile\",\n                TileMousemove,\n            );\n            events.add_event_listener(\n                tile,\n                \"click\",\n                \"pat-layout--select-tile\",\n                () => {\n                    if ($(\".mosaic-helper-tile-new\", self.mosaic.document).length > 0) {\n                        // only if not dropping tile\n                        return;\n                    }\n                    tile[\"mosaic-tile\"].select();\n                },\n            );\n        });\n\n        const applyCustomCss = function (e) {\n            if (e.target.id === \"custom-css-input-box\") {\n                return;\n            }\n            self.mosaic.document.querySelectorAll(\".mosaic-set-custom-css\").forEach(el => {\n                const row = el.parentNode;\n                let base_css = \"mosaic-grid-row\";\n                if (row.classList.contains(\"mosaic-innergrid-row\")) {\n                    base_css += \"mosaic-innergrid-row\";\n                }\n                const customCss = el.querySelector(\"#custom-css-input-box\").value;\n                if (customCss) {\n                    base_css += ` ${customCss}`;\n                }\n                row.setAttribute(\"class\", base_css);\n                // re-apply handles if we add/remove \"mosaic-fixed-row\"\n                $(row).mosaicSetResizeHandles();\n                el.remove();\n            })\n        };\n\n        const CustomCSSOnDblClick = function (e) {\n            // Only do this for \"mosaic-grid-row\" if advanced mode is enabled\n            const target = e.target;\n            const panel = target.closest(\"[data-panel]\");\n            if (panel.classList.contains(\"mosaic-advanced\") && target.classList.contains(\"mosaic-grid-row\")) {\n                // Check we don't have an input field already\n                if (target.querySelector(\".mosaic-set-custom-css\")) {\n                    return;\n                }\n\n                // We are in advance mode\n                var custom_classes = Array.from(target.classList).filter(cls => {\n                    return [\"mosaic-grid-row\", \"mosaic-innergrid-row\"].indexOf(cls) == -1;\n                });\n\n                const row_input = document.createElement(\"div\");\n                row_input.classList.add(\"mosaic-set-custom-css\");\n                row_input.innerHTML = `<label>Custom CSS for this row</label><input type=\"text\" id=\"custom-css-input-box\" value=\"${custom_classes.join(' ')}\"></input>`;\n                target.append(row_input);\n                events.add_event_listener(\n                    row_input,\n                    \"keyup\",\n                    \"pat-layout--apply-custom-css\",\n                    applyCustomCss,\n                );\n            }\n        };\n        self.mosaic.document.querySelectorAll(\".mosaic-grid-row\").forEach((gridrow) => {\n            events.add_event_listener(\n                gridrow,\n                \"dblclick\",\n                \"pat-layout--dblclick-gridrow\",\n                CustomCSSOnDblClick,\n            );\n        });\n        events.add_event_listener(\n            self.mosaic.document,\n            \"click\",\n            \"pat-layout--click\",\n            applyCustomCss,\n        );\n    }\n\n    async initialize() {\n        this.initJQueryHelpers();\n        this.init_events();\n        await this.init_tiles();\n        this.focusFirstTile();\n    }\n\n    async init_tiles() {\n        // Initialize tiles\n\n        for (const panel of this.mosaic.panels) {\n            const $panel = $(panel);\n\n            for (const el of panel.querySelectorAll(\"[data-tile]\")) {\n                if (validMosaicTile(el)) {\n                    const tile = new Tile(this.mosaic, el);\n                    await tile.initialize();\n                }\n            };\n\n            $panel.mosaicAddEmptyRows();\n            $panel.children(\".mosaic-grid-row\").mosaicSetResizeHandles();\n\n            panel.querySelectorAll(\".mosaic-innergrid-row\").forEach(el => {\n                const $el = $(el);\n                $el.mosaicAddMouseMoveInnergridRow();\n                $el.mosaicSetResizeHandles();\n                [\"top\", \"bottom\"].forEach(pos => {\n                    $el.append(\n                        $(this.mosaic.document.createElement(\"div\")).addClass(\n                            \"mosaic-divider mosaic-divider-\" + pos,\n                        ),\n                    );\n                });\n            });\n        }\n    };\n\n    focusFirstTile() {\n        log.debug(\"Focusing first tile\");\n        // focus first tile in biggest panel\n        var width = 0;\n        var index = 0;\n        this.mosaic.panels.each(function (j) {\n            if ($(this).width() > width) {\n                width = $(this).width();\n                index = j;\n            }\n        });\n\n        var $tile = this.mosaic.panels.eq(index).find(\".mosaic-tile:first\");\n        if ($tile.length > 0) {\n            $tile.data(\"mosaic-tile\").select();\n        }\n    }\n\n    initJQueryHelpers() {\n        var self = this;\n        var mosaic_doc = self.mosaic.document;\n\n        $.fn.mosaicAddMouseMoveEmptyRow = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Mouse move event\n                $(this).on(\"mousemove\", function (/* e */) {\n                    // Get layout object\n                    var obj = $(this).parents(\"[data-panel]\");\n\n                    // Check if dragging\n                    if (obj.hasClass(\"mosaic-panel-dragging\")) {\n                        // Hide all dividers\n                        $(\".mosaic-selected-divider\", mosaic_doc).removeClass(\n                            \"mosaic-selected-divider\",\n                        );\n                        $(this).children(\"div\").addClass(\"mosaic-selected-divider\");\n                    }\n                });\n            });\n        };\n\n        /**\n         * Add empty rows\n         *\n         * @id jQuery.mosaicAddEmptyRows\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicAddEmptyRows = function () {\n\n            const create_empty_row = (add_class) => {\n                return $(mosaic_doc.createElement(\"div\"))\n                    .addClass(`mosaic-grid-row mosaic-empty-row ${add_class}`)\n                    .append(\n                        $(mosaic_doc.createElement(\"div\"))\n                            .addClass(\"mosaic-grid-cell col\")\n                            .append(\n                                $(mosaic_doc.createElement(\"div\"))\n                            )\n                    )\n                    .mosaicAddMouseMoveEmptyRow();\n            }\n\n            return this.each(() => {\n                // first row is always an empty one\n                $(this).prepend(create_empty_row(\"\"))\n                // Loop through rows\n                $(this)\n                    .find(\".mosaic-grid-row:not(.mosaic-empty-row\").each(function () {\n                        const empty_row = create_empty_row(\n                            $(this).hasClass(\"mosaic-innergrid-row\") ? \"mosaic-innergrid-row\" : \"\"\n                        );\n                        $(this).after(empty_row);\n                    })\n            });\n        };\n\n        /**\n         * Add draggable to matched elements\n         *\n         * @id jQuery.mosaicAddDrag\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicAddDrag = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                const tile = this;\n                let drag_start_ts = 0;\n                let drag_start = null;\n                let drag_start_delay = 300;\n\n                const DragMove = (event) => {\n                    var helper = $(\".mosaic-helper-tile\", mosaic_doc);\n                    var offset = helper.parents(\"[data-panel]\").offset();\n                    if (offset) {\n                        helper.css(\"top\", event.pageY + 3 - offset.top);\n                        helper.css(\"left\", event.pageX + 3 - offset.left);\n                    }\n                };\n\n                const DragStop = () => {\n                    clearTimeout(drag_start);\n\n                    events.remove_event_listener(mosaic_doc, \"pat-layout--dragmove\")\n                    events.remove_event_listener(mosaic_doc, \"pat-layout--dragstop\")\n\n                    var curr_ts = (new Date()).getTime();\n\n                    if ((curr_ts - drag_start_ts) < drag_start_delay) {\n                        // skip within dragstart delay\n                        return;\n                    }\n\n                    // Handle drag end\n                    const helper = $(\".mosaic-helper-tile\", mosaic_doc);\n                    helper.mosaicHandleDragEnd();\n                    helper.remove();\n                };\n\n                const DragStart = (event) => {\n                    // Add dragging class to content area\n                    self.mosaic.panels.addClass(\"mosaic-panel-dragging\");\n\n                    $(\".mosaic-selected-tile\", mosaic_doc)\n                        .removeClass(\"mosaic-selected-tile\")\n                        .children(\".mosaic-tile-content\")\n                        .trigger(\"blur\");\n\n                    var originaltile = $(event.target).parents(\n                        \".mosaic-tile\",\n                    );\n                    originaltile.addClass(\"mosaic-original-tile\");\n\n                    var clone = originaltile.clone(true);\n                    clone\n                        .removeClass(\"mosaic-original-tile\")\n                        .css({\n                            \"width\": originaltile.width(),\n                            \"max-height\": \"33%\",\n                            \"position\": \"absolute\",\n                            \"opacity\": 0.5,\n                        })\n                        .addClass(\"mosaic-helper-tile\");\n                    originaltile.parents(\"[data-panel]\").append(clone);\n\n                    events.add_event_listener(\n                        mosaic_doc,\n                        \"mousemove\",\n                        \"pat-layout--dragmove\",\n                        DragMove,\n                    )\n                }\n\n                tile.querySelectorAll(\".mosaic-drag-handle\").forEach(tile_drag_handle => {\n                    events.add_event_listener(\n                        tile_drag_handle,\n                        \"mousedown\",\n                        \"pat-layout--startdrag\",\n                        (event) => {\n                            if (event.button !== 0) {\n                                // only left mouse down!\n                                return;\n                            }\n                            // register dragstop\n                            events.add_event_listener(mosaic_doc, \"mouseup\", \"pat-layout--dragstop\", DragStop);\n                            // delayed dragstart\n                            drag_start_ts = (new Date()).getTime();\n                            drag_start = setTimeout(() => {\n                                DragStart(event);\n                            }, drag_start_delay);\n                        }\n                    );\n                });\n\n\n                const tile_move_btn = tile.querySelector(\".mosaic-btn-move\");\n                if (tile_move_btn) {\n                    events.add_event_listener(\n                        tile_move_btn,\n                        \"mousedown\",\n                        \"pat-layout--startmove\",\n                        (event) => {\n                            if (event.button === 0) {\n                                // only left mouse down starts dragging\n                                DragStart(event);\n                            }\n                        }\n                    );\n                }\n            });\n        };\n\n        /**\n         * Event handler for drag end - add new tile\n         *\n         * @id jQuery.mosaicHandleDragEnd\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicHandleDragEnd = async function () {\n            // Get layout object\n            var obj = $(this).parents(\"[data-panel]\");\n            let copy = obj.hasClass(\"mosaic-panel-dragging-copy\");\n\n            // Get direction\n            const divider = mosaic_doc.querySelector(\".mosaic-selected-divider\");\n            const drop = $(divider?.parentElement);\n\n            // get direction where to drop\n            let dir = \"\";\n            for (const _dir of [\"top\", \"bottom\", \"left\", \"right\"]) {\n                if (divider?.classList.contains(`mosaic-divider-${_dir}`)) {\n                    dir = _dir;\n                }\n            }\n            divider?.classList.remove(\"mosaic-selected-divider\");\n\n            // True if new tile is inserted or copied\n            var new_tile = $(\".mosaic-helper-tile-new\", mosaic_doc).length > 0;\n            var original_tile = $(\".mosaic-original-tile\", mosaic_doc);\n            // get original row here, because tile might be moved\n            var original_row = original_tile.closest(\".mosaic-grid-row\");\n            // check if we want to copy it (pressed ALT key -> see init_events)\n            let dropped_tile = copy ? await self.copyTile(original_tile) : original_tile;\n\n            // If divider is not found or not sane drop, act like esc is pressed\n            if (!divider || divider.length === 0 || drop.hasClass(\"mosaic-helper-tile\")) {\n                dropped_tile.addClass(\"mosaic-drag-cancel\");\n            }\n\n            // we have to remove left/right divider if we're dropped inside a fixed row\n            const drop_row = divider?.closest(\".mosaic-grid-row\");\n            if (drop_row?.classList.contains(\"mosaic-fixed-row\")) {\n                $(\".mosaic-divider-left\", dropped_tile).remove();\n                $(\".mosaic-divider-right\", dropped_tile).remove();\n            }\n\n            const fixup_classes = (_t) => {\n                _t.removeClass(\"mosaic-drag-cancel\");\n                _t.removeClass(\n                    \"mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left\",\n                );\n                _t.css({ width: \"\", left: \"\", top: \"\" });\n            };\n\n            if (\n                // Check if esc is pressed\n                dropped_tile.hasClass(\"mosaic-drag-cancel\") ||\n                // Not dropped on tile and empty row\n                (drop?.hasClass(\"mosaic-tile\") === false &&\n                    drop?.hasClass(\"mosaic-innergrid-row\") === false &&\n                    drop?.hasClass(\"mosaic-empty-row\") === false) ||\n                // Check if max columns rows is reached\n                (drop?.parent().parent().children(\".mosaic-grid-cell\").length >=\n                    obj.data(\"max-columns\") &&\n                    (dir === \"left\" || dir === \"right\"))\n            ) {\n                fixup_classes(dropped_tile);\n\n            } else if (drop?.hasClass(\"mosaic-empty-row\")) {\n                // Dropped on empty row\n\n                // Replace empty with normal row class\n                drop.removeClass(\"mosaic-empty-row\")\n                    .attr(\"class\", original_row.attr(\"class\"))\n                    .off(\"mousemove\");\n\n                // Clean cell\n                drop.children(\".mosaic-grid-cell\").children(\"div\").remove();\n\n                fixup_classes(dropped_tile);\n\n                drop.children(\".mosaic-grid-cell\").append(dropped_tile);\n            } else {\n                // Dropped on row or below an inner grid\n\n                fixup_classes(dropped_tile);\n\n                // When the layout object has the special class (Assigned in line 369), wrap\n                // the tile in a div.mosaic-innergrid-row so you can create nested columns\n                if (obj.hasClass(\"inner-subcolumn\")) {\n                    dropped_tile = $(mosaic_doc.createElement(\"div\"))\n                        .addClass(\"mosaic-grid-row mosaic-innergrid-row\")\n                        .append(\n                            $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\"mosaic-grid-cell col\")\n                                .append(dropped_tile)\n                        );\n                    for (const pos of [\"top\", \"bottom\"]) {\n                        dropped_tile.append(\n                            $(mosaic_doc.createElement(\"div\")).addClass(\n                                \"mosaic-divider mosaic-divider-\" + pos,\n                            ),\n                        );\n                    }\n                }\n\n                if (dir === \"top\") {\n                    // If top add tile before\n                    drop.before(dropped_tile);\n\n                } else if (dir === \"bottom\") {\n                    // If bottoma dd tile after\n                    drop.after(dropped_tile);\n\n                } else if (dir === \"left\" || dir === \"right\") {\n                    // If left\n                    var _col = drop.parent();\n                    var _row = _col.parent();\n                    var _children_count = _row.children(\".mosaic-grid-cell\").length;\n\n                    // Check if only 1 column in the row\n                    if (_children_count.length === 1) {\n                        // Put tiles above dropped tile in a new row above\n                        var prev_elms = drop.prevAll();\n                        if (prev_elms.length > 0) {\n                            _row.before(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-row\")\n                                    .append(\n                                        $(mosaic_doc.createElement(\"div\"))\n                                            .addClass(\"mosaic-grid-cell col\")\n                                            .append(\n                                                $(prev_elms.get().reverse())\n                                                    .clone(true)\n                                                    .mosaicAddDrag(),\n                                            ),\n                                    ),\n                            );\n                            prev_elms.remove();\n                        }\n\n                        // Put tiles below dropped tile in a new row below\n                        var next_elms = drop.nextAll();\n                        if (next_elms.length > 0) {\n                            _row.after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-row\")\n                                    .append(\n                                        $(mosaic_doc.createElement(\"div\"))\n                                            .addClass(\"mosaic-grid-cell col\")\n                                            .append(\n                                                next_elms.clone(true).mosaicAddDrag(),\n                                            ),\n                                    ),\n                            );\n                            next_elms.remove();\n                        }\n\n                        // Resize current column\n                        _col.removeClass(self.layout.widthClasses.join(\" \")).addClass(\n                            \"col\",\n                        );\n\n                        // Create column with dragged tile in it\n                        if (dir === \"left\") {\n                            drop.parent().before(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell col\")\n                                    .append(dropped_tile),\n                            );\n                        } else {\n                            drop.parent().after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell col\")\n                                    .append(dropped_tile),\n                            );\n                        }\n\n                        // Add resize handles\n                        _row.mosaicSetResizeHandles();\n\n                        // Dropped inside column\n                    } else {\n                        // Create new column\n                        if (dir === \"left\") {\n                            _col.before(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell\")\n                                    .append(dropped_tile),\n                            );\n                        } else {\n                            _col.after(\n                                $(mosaic_doc.createElement(\"div\"))\n                                    .addClass(\"mosaic-grid-cell\")\n                                    .append(dropped_tile),\n                            );\n                        }\n\n                        // Resize columns\n                        _row.mosaicSetColumnSizes();\n\n                        // Add resize handles\n                        _row.mosaicSetResizeHandles();\n                    }\n                }\n            }\n\n            // Remove dragging class from content\n            obj.removeClass(\n                \"mosaic-panel-dragging mosaic-panel-dragging-copy mosaic-panel-dragging-unique mosaic-panel-dragging-new inner-subcolumn\",\n            );\n\n            // Remove remaining empty rows\n            self.mosaic.panels.find(\".mosaic-grid-row:not(:has(.mosaic-tile))\").remove();\n            self.mosaic.panels.find(\".mosaic-empty-row\").remove();\n\n            // Cleanup original row\n            original_row.mosaicCleanupRow();\n\n            // Add empty rows\n            self.mosaic.panels.mosaicAddEmptyRows();\n\n            // re-initialize events\n            self.init_events();\n\n            // Select new tile and make it draggable\n            if ((new_tile || copy) && dropped_tile.length > 0) {\n                dropped_tile.mosaicAddDrag();\n                if (!dropped_tile.data(\"mosaic-tile\")) {\n                    return;\n                }\n                await dropped_tile.data(\"mosaic-tile\").initializeContent(new_tile, copy);\n                dropped_tile.data(\"mosaic-tile\").select();\n            }\n        };\n\n        /**\n         * Set the sizes of the column\n         *\n         * @id jQuery.mosaicSetColumnSizes\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicSetColumnSizes = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Resize columns in the row\n                var column_sizes = [];\n                var $gridCells = $(this).children(\".mosaic-grid-cell\");\n                var nr_of_columns = $gridCells.length;\n                var width_css_classes = self.layout.widthClasses.join(\" \");\n\n                // This will reset the width classes - it will automatically set the widths\n\n                $gridCells.each(function (idx) {\n                    $(this).removeClass(width_css_classes);\n\n                    var col_size = Math.floor(12 / nr_of_columns);\n                    var col_size_last = 12 - col_size * (nr_of_columns - 1);\n\n                    for (var j = 0; j < nr_of_columns; j++) {\n                        if (j === nr_of_columns - 1) {\n                            col_size = col_size_last;\n                        }\n                        if (idx === j) {\n                            column_sizes.push(col_size);\n                            $(this).addClass(\"col\");\n                        }\n                    }\n                });\n\n                $(this).data(\"column_sizes\", column_sizes);\n            });\n        };\n\n        /**\n         * Add new resize handlers\n         *\n         * @id jQuery.mosaicSetResizeHandles\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicSetResizeHandles = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Remove resize handles\n                $(this).children(\".mosaic-resize-handle\").remove();\n\n                if ([\"mosaic-fixed-row\", \"mosaic-empty-row\"].filter(cls => this.classList.contains(cls)).length) {\n                    // no resize handles for empty or fixed rows\n                    return;\n                }\n\n                // Check number of columns\n                var grid_cells = $(this).children(\".mosaic-grid-cell\");\n                var nr_of_columns = grid_cells.length;\n\n                if (nr_of_columns <= 12) {\n                    var column_sizes = [];\n                    var zero_count = 0;\n                    var col_sum = 0;\n                    var col_size = 0;\n\n                    for (let i = 0; i < nr_of_columns; i++) {\n                        col_size = GetColSizeByColClass(\n                            self.getWidthClass(grid_cells[i]),\n                        );\n                        column_sizes.push(col_size);\n                        col_sum = col_sum + col_size;\n                        if (col_size === 0) {\n                            zero_count = zero_count + 1;\n                        }\n                    }\n\n                    // count \"auto-size\" columns with class \".col\" and\n                    // calculate width equally.\n                    // NOTE: This requires extra logic in case of 5 columns.\n                    // See the \".toFixed(1)\" below because of floating point\n                    // issues with 12 / 5 * 3\n                    var zero_col = 0;\n                    if (zero_count) {\n                        zero_col = (12 - col_sum) / zero_count;\n                    }\n\n                    var resize_col_size = 0;\n                    col_size = 0;\n\n                    for (let i = 0; i < nr_of_columns; i++) {\n                        col_size = column_sizes[i] ? column_sizes[i] : zero_col;\n                        resize_col_size = resize_col_size + col_size;\n\n                        $(this).append(\n                            $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\n                                    `mosaic-resize-handle mosaic-resize-handle-${i + 1\n                                    } mosaic-resize-${(nr_of_columns === 5) ? resize_col_size.toFixed(1).replace(\".0\", \"\") : resize_col_size}`,\n                                )\n                                .data(\"resize_handle_index\", i),\n                        );\n\n                        // set counted size to cell data\n                        $(grid_cells[i]).data(\"col_size\", col_size);\n                    }\n                }\n\n                // Mouse down handler on resize handle\n                $(this)\n                    .children(\".mosaic-resize-handle\")\n                    .off(\"mousedown\")\n                    .on(\"mousedown\", function (/* e */) {\n                        if ($(\".mosaic-helper-tile-new\").length > 0) {\n                            // do not resize when we place a new tile\n                            return;\n                        }\n                        var $currRow = $(this).parent();\n                        var $mosaicGridCellChildren = $currRow.children(\".mosaic-grid-cell\");\n\n                        if ($mosaicGridCellChildren.length > 12) {\n                            return;\n                        }\n                        var col_size_sum = 0;\n                        var column_sizes = [];\n\n                        $mosaicGridCellChildren.each(function () {\n                            var col_size = $(this).data(\"col_size\"); // get computed size of the column\n                            column_sizes.push(col_size);\n\n                            var placeholder = $(mosaic_doc.createElement(\"div\"))\n                                .addClass(\n                                    `mosaic-resize-placeholder col-${col_size} mosaic-resize-${col_size_sum}`,\n                                )\n                                .append(\n                                    $(mosaic_doc.createElement(\"div\"))\n                                        .addClass(\n                                            \"mosaic-resize-placeholder-inner-border\",\n                                        )\n                                        .append(\n                                            $(mosaic_doc.createElement(\"div\"))\n                                                .addClass(\"info\")\n                                                .html(col_size),\n                                        ),\n                                );\n\n                            // Add placeholder\n                            $currRow.append(placeholder);\n\n                            // summarize column sizes for placeholder classes\n                            col_size_sum += col_size;\n                        });\n\n                        // Get resize handle index\n                        var resize_handle_index = self.getResizeHandleClassId(this);\n                        // calculate resize helper position\n                        var resize_handle_index_size = column_sizes.reduce((a, b, i) => i <= resize_handle_index ? a + b : a, 0);\n\n                        // Add helper\n                        var $helper = $(\"<div />\")\n                            .addClass(\n                                \"mosaic-resize-handle mosaic-resize-handle-helper\"\n                            )\n                            .addClass(\n                                `mosaic-resize-${resize_handle_index_size}`\n                            )\n                            .data(\"row_width\", $currRow.width())\n                            .data(\"resize_handle_index\", resize_handle_index);\n\n                        // save array as DOM attribute\n                        $helper[0][\"column_sizes\"] = column_sizes;\n\n                        $currRow.append($helper);\n\n                        // Set resizing state\n                        $(this)\n                            .parents(\"[data-panel]\")\n                            .addClass(\"mosaic-panel-resizing\");\n                        $currRow.addClass(\"mosaic-row-resizing\");\n                        $(\".mosaic-selected-tile\", mosaic_doc)\n                            .children(\".mosaic-tile-content\")\n                            .trigger(\"blur\");\n\n                        log.debug(\"------------------resize-handle(click)--------------------\")\n                        log.debug(`resize_handle_index: ${resize_handle_index}`)\n                        log.debug(`resize_handle_index_size: ${resize_handle_index_size}`)\n                        log.debug(`row_width: ${$currRow.width()}`)\n                        log.debug(`column_sizes: ${column_sizes}`)\n\n                        // Prevent drag event\n                        return false;\n                    });\n            });\n        };\n\n        /**\n         * Cleanup row after tiles added or removed from the row\n         *\n         * @id jQuery.mosaicCleanupRow\n         * @return {Object} jQuery object\n         */\n        $.fn.mosaicCleanupRow = function () {\n            // Loop through matched elements\n            return this.each(function () {\n                // Get original row\n                var original_row = $(this);\n\n                // Remove empty columns\n                original_row.children(\".mosaic-grid-cell\").each(function () {\n                    if ($(this).children().length === 0) {\n                        $(this).remove();\n\n                        // Resize columns\n                        original_row.mosaicSetColumnSizes();\n                    }\n                });\n\n                // Remove row if no tiles inside\n                if (original_row.find(\".mosaic-tile\").length === 0) {\n                    var del_row = original_row;\n\n                    // Check if next row available\n                    if (original_row.nextAll(\".mosaic-grid-row\").length > 0) {\n                        original_row = original_row.next(\".mosaic-grid-row\");\n\n                        // Check if prev row available\n                    } else if (original_row.prevAll(\".mosaic-grid-row\").length > 0) {\n                        original_row = original_row.prev(\".mosaic-grid-row\");\n\n                        // This is the last row\n                    } else {\n                        original_row.remove();\n                        return;\n                    }\n\n                    // Remove current row\n                    del_row.remove();\n                }\n\n                // Set resize handles\n                original_row.mosaicSetResizeHandles();\n            });\n        };\n\n        /**\n         * Get the direction based on the tile size and relative x and y coords of the cursor\n         *\n         * @id jQuery.mosaicGetDirection\n         * @param {Object} e Event object\n         * @return {String} Direction of the cursor relative to the tile\n         */\n        $.fn.mosaicGetDirection = function (e) {\n            // Calculate x, y, width and height\n            var width = parseFloat($(this).width());\n            var height = parseFloat($(this).height());\n            var x = parseFloat(e.pageX - $(this).offset().left - width / 2);\n            var y = parseFloat(e.pageY - $(this).offset().top - height / 2);\n            var halfwidth = width / 2;\n            var halfheight = height / 2;\n\n            // If left of center\n            if (x < 0) {\n                // If above center\n                if (y < 0) {\n                    if (x / y < (-1 * halfwidth) / (-1 * halfheight)) {\n                        return \"top\";\n                    } else {\n                        return \"left\";\n                    }\n                    // Below center\n                } else {\n                    if (x / y < (-1 * halfwidth) / halfheight) {\n                        return \"left\";\n                    } else {\n                        return \"bottom\";\n                    }\n                }\n\n                // Right of center\n            } else {\n                // If above center\n                if (y < 0) {\n                    if (x / y < (1 * halfwidth) / (-1 * halfheight)) {\n                        return \"right\";\n                    } else {\n                        return \"top\";\n                    }\n                    // Below center\n                } else {\n                    if (x / y < halfwidth / halfheight) {\n                        return \"bottom\";\n                    } else {\n                        return \"right\";\n                    }\n                }\n            }\n        };\n    }\n}\n\nvar AddResetAnchor = function ($tileSideTools, cols) {\n    var reset = document.createElement(\"a\");\n    var cols_str = typeof cols === \"undefined\" ? \"\" : \" (\" + cols + \")\";\n    reset.href = \"javascript:\";\n    reset.textContent = \"Reset\" + cols_str;\n    $(reset).on(\"click\", { el: $tileSideTools }, function (e) {\n        e.preventDefault();\n\n        e.data.el\n            .closest(\".mosaic-grid-cell\")\n            .removeClass(\n                \"col-1 col-2 col-3 col-4 col-5 col-6 col-7 col-8 col-9 col-10 col-11 col-12\",\n            )\n            .addClass(\"col\");\n\n        e.data.el.closest(\".mosaic-grid-row\").mosaicSetResizeHandles();\n\n        $(e.target).parent().remove();\n    });\n    return reset;\n};\n\n/**\n * Get a list of percentage steps for each column in the grid\n *\n * @id GetGridPercentList\n * @return {Array} List of percent steps of the width class\n */\nfunction GetGridPercentList() {\n    var low = 0,\n        high = 100,\n        grid = 12,\n        grid_percent = [];\n    var step = 100 / grid;\n    var a = low,\n        b = high - 1; /* fix the last step in the loop: -1 */\n    while (a < b) {\n        grid_percent.push(Math.round((a += step)));\n    }\n\n    return grid_percent;\n}\n\n/**\n * Get the name of the width class of the given integer\n *\n * @id GetWidthClassByColSize\n * @param {Integer} col_size Bootstrap col width id\n * @return {String} Classname of the width class of the given integer\n */\nfunction GetWidthClassByColSize(col_size) {\n    if (col_size) {\n        return \"col-\" + col_size;\n    }\n\n    // Fallback\n    return \"col\";\n}\n\n/**\n * Get the name of the position class of the given integer\n *\n * @id GetColSizeByColClass\n * @param {String} Classname of the position class\n * @return {Integer} col_size Bootstrap col width id\n */\nfunction GetColSizeByColClass(col_class, prefix) {\n    prefix = prefix || \"col-\";\n    return parseInt(col_class.replace(prefix, \"\")) || 0;\n}\n\n/**\n * Get the bootstrap col width id by width size\n *\n * @id GetBootstrapColByPercent\n * @param {Integer} width Percentage of the column position\n * @return {Integer} Bootstrap col width id of the given integer\n */\nfunction GetBootstrapColByPercent(width) {\n    var grid_percent = GetGridPercentList();\n    let cw_idx = 12;\n    grid_percent.forEach((perc, idx) => {\n        if (perc == width) {\n            cw_idx = idx + 1;\n        }\n    })\n    return cw_idx;\n}\n"],"names":["log","logging","getLogger","validMosaicTile","el","closest","LayoutManager","constructor","mosaic","this","layout","widthClasses","resizeClasses","resizeHandleClasses","getWidthClass","e","cls","classList","contains","getResizeHandleClassId","handleIdx","forEach","idx","addAppTileHTML","type","response","url","value","getDomTreeFromHtml","addHeadTags","addTile","find","html","tileUrl","self","panels","addClass","add_helper","document","createElement","add","innerHTML","replace","append","helper","width","each","$","tile","Tile","initialize","cacheHtml","scanRegistry","copyTile","orig_tile","orig_tile_inst","tile_type","getType","removeClass","orig_parent","copy_tile_id","mosaic_utils","generate_uid","$copy_tile_helper","getHtmlContent","save","getConfig","orig_tile_data","serialize","deserialize","$el","getDefaultValue","tile_config","start","end","name","default_value","widget","id","attr","val","label","getPageContent","exportLayout","getLayoutRow","obj","body","querySelectorAll","length","getAttribute","cell","children","child","getHtmlBody","panel","dataset","maxColumns","row","options","saveLayoutToForm","customLayout","querySelector","hasContentLayout","debug","pageContent","alert","init_events","_document","_panels","console","_panel","events","add_event_listener","keyCode","async","blur","focused_tile","activeElement","data","focus","cpy_class","remove","Date","getTime","original_tile","$orig_row","parent","mosaicCleanupRow","divider","trigger","parents","parseInt","elm","target","srcElement","new_tile","mosaicHandleDragEnd","toolbar","SelectedTileChange","scrollInterval","stopScroll","clearInterval","startScroll","diff","setInterval","window","scrollBy","DocumentMousemove","$new_tile_helper","offset","css","pageY","top","pageX","left","$helper","cur_snap_offset","$row","resize_handle_index","mouse_x","parseFloat","getComputedStyle","paddingLeft","mouse_percentage","Math","round","snap","snap_offset","GetGridPercentList","perc","abs","snap_size","grid_percent","cw_idx","GetBootstrapColByPercent","column_sizes","column_sizes_sum","reduce","a","b","col_size_before","slice","col_size_after","col_size_max","new_column_size","new_column_sizes","i","push","_before","_last_size","col_size_sum","resize_css_classes","join","width_css_classes","col_size","col_size_class","GetWidthClassByColSize","viewportHeight","innerHeight","clientY","checkScroll","css_width_classes","hasClass","first","$tileSideTools","AddResetAnchor","mosaicSetResizeHandles","$tile","select","TileMousemove","dir","mosaicGetDirection","filter","height","applyCustomCss","parentNode","base_css","customCss","setAttribute","CustomCSSOnDblClick","custom_classes","Array","from","indexOf","row_input","gridrow","initJQueryHelpers","init_tiles","focusFirstTile","$panel","mosaicAddEmptyRows","mosaicAddMouseMoveInnergridRow","pos","index","j","eq","mosaic_doc","mosaicAddMouseMoveEmptyRow","on","create_empty_row","add_class","prepend","empty_row","after","mosaicAddDrag","drag_start_ts","drag_start","DragMove","event","DragStop","clearTimeout","remove_event_listener","DragStart","originaltile","clone","tile_drag_handle","button","setTimeout","tile_move_btn","copy","drop","parentElement","_dir","original_row","dropped_tile","drop_row","fixup_classes","_t","off","before","_col","_row","prev_elms","prevAll","get","reverse","next_elms","nextAll","mosaicSetColumnSizes","initializeContent","$gridCells","nr_of_columns","floor","col_size_last","grid_cells","zero_count","col_sum","GetColSizeByColClass","zero_col","resize_col_size","toFixed","$currRow","$mosaicGridCellChildren","placeholder","resize_handle_index_size","del_row","next","prev","x","y","halfwidth","halfheight","cols","reset","cols_str","href","textContent","preventDefault","step","high","col_class","prefix"],"sourceRoot":""}