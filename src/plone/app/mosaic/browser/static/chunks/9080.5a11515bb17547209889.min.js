"use strict";(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[9080],{9080:function(t,e,n){n.r(e),n.d(e,{default:function(){return c}});var o=n(87657),a=n(10878),r=n.n(a);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e}var e,n,a;return e=t,(n=[{key:"init_moderation_eventhandler",value:function(){var t=this;r()("button[name='form.button.moderation.DeleteComment']").click((function(t){t.preventDefault();var e=r()(this).closest("tr"),n=e.find("[name='selected_obj_paths:list']").attr("value")+"/@@moderate-delete-comment?_authenticator="+r()('input[name="_authenticator"]').val();r().ajax({type:"GET",url:n,success:function(t){e.fadeOut(250).fadeIn(250,(function(){e.remove()})),1===r()("table#review-comments > tbody > tr").length&&location.reload()},error:function(t){alert("Error sending AJAX request:"+n)}})})),r()('button[name="form.button.moderation.TransmitComment"]').click((function(e){e.preventDefault(),r()(this);var n=r()(this).closest("tr"),o=r()(n).find("[name='selected_obj_paths:list']").attr("value"),a=r()(this).attr("data-transition"),i=o+"/@@transmit-comment?_authenticator="+r()('input[name="_authenticator"]').val()+"&workflow_action="+a,c="fieldset-moderate-comments"==r()(this).closest("fieldset").attr("id");r().ajax({type:"GET",url:i,success:function(e){if(c){var n=location.href;r()("#review-comments").load(n+" #review-comments > *",(function(){t.init_moderation_eventhandler(),r()(".pat-plone-modal").patPloneModal()}))}else location.reload()},error:function(t){alert("Error transmitting comment. (Error sending AJAX request:"+i+")")}})})),r()("button[name='form.button.BulkAction']").click((function(e){e.preventDefault();var n=r()(this).closest("form"),o=r()(n).attr("action"),a=r()(n).serialize(),i=r()("input:checkbox:checked"),c=r()(n).find("[name='form.select.BulkAction']");"-1"===c.val()?alert("You haven't selected a bulk action. Please select one."):0===i.length?alert("You haven't selected any comment for this bulk action.Please select at least one comment."):r().post(o,a,(function(e){c.find("option[value='-1']").attr("selected","selected"),r()("#review-comments").load(window.location+" #review-comments",(function(){t.init_moderation_eventhandler(),r()(".pat-plone-modal").patPloneModal()}))}))})),r()("input[name='check_all']").click((function(){"0"===r()(this).val()?(r()(this).parents("table").find("input:checkbox").prop("checked",!0),r()(this).val("1")):(r()(this).parents("table").find("input:checkbox").prop("checked",!1),r()(this).val("0"))})),r()("input[name='review_state']").click((function(){var e=r()(this).val(),n=location.href;n=location.search?location.href.replace(location.search,"?review_state="+e):location.href+"?review_state="+e,r()("#fieldset-moderate-comments").parent().load(n+" #content form > *",(function(){t.init_moderation_eventhandler(),r()(".pat-plone-modal").patPloneModal();var o={review_state:e};history.pushState(o,"moderate comments",n)}))})),r()(".show-full-comment-text").click((function(t){t.preventDefault();var e=r()(this).attr("href"),n=r()(this).parent();r().ajax({type:"GET",url:e,data:"",success:function(t){n.html(t)},error:function(t){alert("Error getting full comment text:"+e)}})})),r()(".last-history-entry").each((function(){var t=r()(this);r().ajax({url:t.attr("data-href"),success:function(e){t.html(r()(e).find(".historyByLine").first()),o.Z.scan(t)},error:function(t){console.error("Error getting history.")}})}))}},{key:"init",value:function(){this.init_moderation_eventhandler()}}])&&i(e.prototype,n),a&&i(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}()}}]);