(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[55534],{55534:function(){!function(){"use strict";var n,t,e,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=(n=null,function(t){return n===t}),u=function(){},c=function(n){return function(){return n}},a=function(n){return n},l=c(!1),s=c(!0),f=function(){return m},m={fold:function(n,t){return n()},isSome:l,isNone:s,getOr:e=a,getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:e,orThunk:t,map:f,each:u,bind:f,exists:l,forall:s,filter:function(){return f()},toArray:function(){return[]},toString:c("none()")},g=function(n){var t=c(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},isSome:s,isNone:l,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return g(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:m},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},d={some:g,none:f,from:function(n){return null==n?m:g(n)}},h=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},v=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},y=function(){return y=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},y.apply(this,arguments)},p=Object.keys,b=Object.hasOwnProperty,w=function(n,t){for(var e=p(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i)}},O=function(n,t){var e={};return w(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},C=function(n,t){return b.call(n,t)},k=(r=function(n,t){return t},function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(0===n.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<n.length;o++){var i=n[o];for(var u in i)C(i,u)&&(e[u]=r(e[u],i[u]))}return e}),_=function(){var n=function(n){var t=v(d.none()),e=function(){return t.get().each(n)};return{clear:function(){e(),t.set(d.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(n){e(),t.set(d.some(n))}}}(u);return y(y({},n),{on:function(t){return n.get().each(t)}})},j=function(n,t){return-1!==n.indexOf(t)},A=tinymce.util.Tools.resolve("tinymce.Resource"),T=tinymce.util.Tools.resolve("tinymce.util.Delay"),x=tinymce.util.Tools.resolve("tinymce.util.Promise"),P="All",D={symbols:"Symbols",people:"People",animals_and_nature:"Animals and Nature",food_and_drink:"Food and Drink",activity:"Activity",travel_and_places:"Travel and Places",objects:"Objects",flags:"Flags",user:"User Defined"},S=function(n,t){return C(n,t)?n[t]:t},L=function(n){var t,e=function(n){return n.getParam("emoticons_append",{},"object")}(n);return t=function(n){return y({keywords:[],category:"user"},n)},O(e,(function(n,e){return{k:e,v:t(n,e)}}))},E=function(n,t,e){var r=_(),o=_(),i=function(n){return n.getParam("emoticons_images_url","https://twemoji.maxcdn.com/v/13.0.1/72x72/","string")}(n),u=function(n){return function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}(n.char,"<img",0)?n.char.replace(/src="([^"]+)"/,(function(n,t){return'src="'+i+t+'"'})):n.char};n.on("init",(function(){A.load(e,t).then((function(t){var e=L(n);!function(n){var t={},e=[];w(n,(function(n,r){var o={title:r,keywords:n.keywords,char:u(n),category:S(D,n.category)},i=void 0!==t[o.category]?t[o.category]:[];t[o.category]=i.concat([o]),e.push(o)})),r.set(t),o.set(e)}(k(t,e))}),(function(n){console.log("Failed to load emoticons: "+n),r.set({}),o.set([])}))}));var c=function(){return o.get().getOr([])},a=function(){return r.isSet()&&o.isSet()};return{listCategories:function(){return[P].concat(p(r.get().getOr({})))},hasLoaded:a,waitForLoad:function(){return a()?x.resolve(!0):new x((function(n,e){var r=15,o=T.setInterval((function(){a()?(T.clearInterval(o),n(!0)):--r<0&&(console.log("Could not load emojis from url: "+t),T.clearInterval(o),e(!1))}),100)}))},listAll:c,listCategory:function(n){return n===P?c():r.get().bind((function(t){return d.from(t[n])})).getOr([])}}},F=function(n,t){return j(n.title.toLowerCase(),t)||function(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1}(n.keywords,(function(n){return j(n.toLowerCase(),t)}))},N=function(n,t,e){for(var r=[],o=t.toLowerCase(),i=e.fold((function(){return l}),(function(n){return function(t){return t>=n}})),u=0;u<n.length&&(0!==t.length&&!F(n[u],o)||(r.push({value:n[u].char,text:n[u].title,icon:n[u].char}),!i(r.length)));u++);return r},I="pattern",z=function(n,t){var e,r,o,u,c={pattern:"",results:N(t.listAll(),"",d.some(300))},a=v(P),l=(e=function(n){!function(n){var e=n.getData(),r=a.get(),o=t.listCategory(r),i=N(o,e[I],r===P?d.some(300):d.none());n.setData({results:i})}(n)},r=200,o=null,{cancel:u=function(){i(o)||(clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];u(),o=setTimeout((function(){o=null,e.apply(null,n)}),r)}}),s={label:"Search",type:"input",name:I},f={type:"collection",name:"results"},m=function(){return{title:"Emoticons",size:"normal",body:{type:"tabpanel",tabs:h(t.listCategories(),(function(n){return{title:n,name:n,items:[s,f]}}))},initialData:c,onTabChange:function(n,t){a.set(t.newTabName),l.throttle(n)},onChange:l.throttle,onAction:function(t,e){"results"===e.name&&(!function(n,t){n.insertContent(t)}(n,e.value),t.close())},buttons:[{type:"cancel",text:"Close",primary:!0}]}},g=n.windowManager.open(m());g.focus(I),t.hasLoaded()||(g.block("Loading emoticons..."),t.waitForLoad().then((function(){g.redial(m()),l.throttle(g),g.focus(I),g.unblock()})).catch((function(n){g.redial({title:"Emoticons",body:{type:"panel",items:[{type:"alertbanner",level:"error",icon:"warning",text:"<p>Could not load emoticons</p>"}]},buttons:[{type:"cancel",text:"Close",primary:!0}],initialData:{pattern:"",results:[]}}),g.focus(I),g.unblock()})))};o.add("emoticons",(function(n,t){var e=function(n,t){var e=function(n){return n.getParam("emoticons_database","emojis","string")}(n);return n.getParam("emoticons_database_url",t+"/js/"+e+n.suffix+".js","string")}(n,t),r=function(n){return n.getParam("emoticons_database_id","tinymce.plugins.emoticons","string")}(n),o=E(n,e,r);!function(n,t){n.addCommand("mceEmoticons",(function(){return z(n,t)}))}(n,o),function(n){var t=function(){return n.execCommand("mceEmoticons")};n.ui.registry.addButton("emoticons",{tooltip:"Emoticons",icon:"emoji",onAction:t}),n.ui.registry.addMenuItem("emoticons",{text:"Emoticons...",icon:"emoji",onAction:t})}(n),function(n,t){n.ui.registry.addAutocompleter("emoticons",{ch:":",columns:"auto",minChars:2,fetch:function(n,e){return t.waitForLoad().then((function(){var r=t.listAll();return N(r,n,d.some(e))}))},onAction:function(t,e,r){n.selection.setRng(e),n.insertContent(r),t.hide()}})}(n,o),function(n){n.on("PreInit",(function(){n.parser.addAttributeFilter("data-emoticon",(function(n){!function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)}(n,(function(n){n.attr("data-mce-resize","false"),n.attr("data-mce-placeholder","1")}))}))}))}(n)}))}()}}]);
//# sourceMappingURL=55534.90ee71a0d605f1bcab90.min.js.map