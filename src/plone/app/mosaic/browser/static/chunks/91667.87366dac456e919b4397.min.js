(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[91667],{91667:function(){!function(){"use strict";function t(t){return function(n){return r=typeof(e=n),(null===e?"null":"object"==r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===t;var e,r}}function n(t){return function(n){return typeof n===t}}function e(){}function r(t){return function(){return t}}function o(t){return t}function i(t,n){return t===n}function u(){return v}var a,l=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.VK"),f=t("string"),s=t("array"),m=function(t){return a===t},g=n("boolean"),d=n("function"),h=r(!1),p=r(!(a=null)),v={fold:function(t,n){return t()},isSome:h,isNone:p,getOr:o,getOrThunk:k,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:o,orThunk:k,map:u,each:e,bind:u,exists:h,forall:p,filter:function(){return v},toArray:function(){return[]},toString:r("none()")};function k(t){return t()}function y(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!s(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);rt.apply(n,t[e])}return n}function x(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return nt.none()}function b(t,n,e){return void 0===e&&(e=i),t.exists((function(t){return e(t,n)}))}function O(t,n){return t?nt.some(n):nt.none()}function w(t){var n=t.getParam("link_assume_external_targets",!1);return g(n)&&n?1:!f(n)||"http"!==n&&"https"!==n?0:n}function C(t){return t.getParam("default_link_target")}function N(t){return t.getParam("target_list",!0)}function A(t){return t.getParam("rel_list",[],"array")}function T(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")}function P(t){return f(t.value)?t.value:""}function S(t){return void 0===t&&(t=P),function(n){return nt.from(n).map((function(n){return it(n,t)}))}}function _(t,n){return ct.call(t,n)}function R(t){return t&&"a"===t.nodeName.toLowerCase()}function D(t){return R(t)&&!!mt(t)}function L(t,n){if(t.collapsed)return[];for(var e=t.cloneContents(),r=new ft(e.firstChild,e),o=[],i=e.firstChild;n(i)&&o.push(i),i=r.next(););return o}function E(t){return/^\w+:/i.test(t)}function M(t,n){function e(t){return t.filter((function(t){return-1===ot.inArray(o,t)}))}var r,o=["noopener"],i=t?t.split(/\s+/):[],u=n?0<(r=e(r=i)).length?r.concat(o):o:e(i);return 0<u.length?ot.trim(u.sort().join(" ")):""}function U(t,n){return n=n||t.selection.getNode(),gt(n)?t.dom.select("a[href]",n)[0]:t.dom.getParent(n,"a[href]")}function B(t,n){return(n?n.innerText||n.textContent:t.getContent({format:"text"})).replace(/\uFEFF/g,"")}function I(t){return 0<ot.grep(t,D).length}function K(t){var n=t.schema.getTextInlineElements();return 0===L(t.selection.getRng(),(function(t){return 1===t.nodeType&&!R(t)&&!_(n,t.nodeName.toLowerCase())})).length}function z(t,n,r){var o,i,u,a,l,c,f,s,g,d,h=(o=t,i=r.href,at(at({},r),{href:st.isDomSafe(i,"a",o.settings)?i:""}));t.hasPlugin("rtc",!0)?t.execCommand("createlink",!1,(l=h.class,c=h.href,f=h.rel,s=h.target,g=h.text,d=h.title,function(t,n,e,r){(function(t){for(var o=lt(t),i=0,u=o.length;i<u;i++){var a=o[i];!function(t,o){(n(t,o)?e:r)(t,o)}(t[a],a)}})(t)}({class:l.getOrNull(),href:c,rel:f.getOrNull(),target:s.getOrNull(),text:g.getOrNull(),title:d.getOrNull()},(function(t,n){return!1===m(t)}),(u=a={},function(t,n){u[n]=t}),e),a)):function(t,n,e){var r,o,i,u,a,l,c,f=t.selection.getNode(),s=U(t,f),m=(o=t,i=function(t,n,e){return function(t){for(var r,o=0,i=t.length;o<i;o++)r=t[o],e=n(e,r,o)}(t),e}(["title","rel","class","target"],(function(t,n){return r[n].each((function(e){t[n]=0<e.length?e:null})),t}),{href:(r=e).href}),c=at({},i),0<A(o).length||!1!==T(o)||(u=M(c.rel,"_blank"===c.target),c.rel=u||null),nt.from(c.target).isNone()&&!1===N(o)&&(c.target=C(o)),c.href=(a=c.href,"http"!==(l=w(o))&&"https"!==l||E(a)?a:l+"://"+a),c);t.undoManager.transact((function(){var r,o,i,u,a,l,c,g;e.href===n.href&&n.attach(),s?(t.focus(),a=t,l=s,c=e.text,g=m,c.each((function(t){_(l,"innerText")?l.innerText=t:l.textContent=t})),a.dom.setAttribs(l,g),a.selection.select(l)):(r=t,i=e.text,u=m,gt(o=f)?ht(r,o,u):i.fold((function(){r.execCommand("mceInsertLink",!1,u)}),(function(t){r.insertContent(r.dom.createHTML("a",u,r.dom.encode(t)))})))}))}(t,n,h)}function j(t){var n;t.hasPlugin("rtc",!0)?t.execCommand("unlink"):(n=t).undoManager.transact((function(){var t,e,r,o,i,u,a,l=n.selection.getNode();gt(l)?dt(n,l):(e=(t=n).dom,o=(r=t.selection).getBookmark(),i=r.getRng().cloneRange(),u=e.getParent(i.startContainer,"a[href]",t.getBody()),a=e.getParent(i.endContainer,"a[href]",t.getBody()),u&&i.setStartBefore(u),a&&i.setEndAfter(a),r.setRng(i),t.execCommand("unlink"),r.moveToBookmark(o)),n.focus()}))}function V(t){var n=t.href;return 0<n.indexOf("@")&&-1===n.indexOf("/")&&-1===n.indexOf("mailto:")?nt.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return at(at({},t),{href:"mailto:"+n})}}):nt.none()}function q(t,n,e){var r=t.getAttrib(n,e);return null!==r&&0<r.length?nt.some(r):nt.none()}function F(t,n){return t.dom.getParent(n,"a[href]")}function W(t){return F(t,t.selection.getStart())}function H(t,n){var e,r;n&&(e=mt(n),/^#/.test(e)?(r=t.$(e)).length&&t.selection.scrollIntoView(r[0],!0):function(t){var n=document.createElement("a");n.target="_blank",n.href=t,n.rel="noreferrer noopener";var e,r,o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e=n,r=o,document.body.appendChild(e),e.dispatchEvent(r),document.body.removeChild(e)}(n.href))}function G(t){return function(){!function(t){var n,r=U(n=t);wt(n,r).then((function(n){var r,o,i,u,a=i=t,l=(r=u=n).anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),c=r.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],f=nt.from(C(a)),s=r.anchor,m={url:{value:o=s.url.getOr(""),meta:{original:{value:o}}},text:s.text.getOr(""),title:s.title.getOr(""),anchor:o,link:o,rel:s.rel.getOr(""),target:s.target.or(f).getOr(""),linkClass:s.linkClass.getOr("")},g=r.catalogs,d=vt(m,g);return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:y([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],l,c,function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n}([g.anchor.map(ut.createUi("anchor","Anchors")),g.rels.map(ut.createUi("rel","Rel")),g.targets.map(ut.createUi("target","Open link in...")),g.link.map(ut.createUi("link","Link list")),g.classes.map(ut.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:m,onChange:function(t,n){var e=n.name;d.onChange(t.getData,{name:e}).each((function(n){t.setData(n)}))},onSubmit:function(t){var n=t.getData();if(!n.url.value)return j(i),void t.close();function r(t){return nt.from(n[t]).filter((function(n){return!b(u.anchor[t],n)}))}var o={href:n.url.value,text:r("text"),target:r("target"),rel:r("rel"),class:r("linkClass"),title:r("title")},a={href:n.url.value,attach:void 0!==n.url.meta&&n.url.meta.attach?n.url.meta.attach:e};xt(i,o).then((function(t){z(i,a,t)})),t.close()}}})).then((function(n){t.windowManager.open(n)}))}(t)}}function J(t){return function(){H(t,W(t))}}function X(t,n){return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}function $(t){return function(n){function e(){return n.setActive(!t.mode.isReadOnly()&&null!==U(t,t.selection.getNode()))}return e(),X(t,e)}}function Q(t){return function(n){function e(){return n.setDisabled(null===U(t,t.selection.getNode()))}return e(),X(t,e)}}function Y(t){return function(n){function e(n){return I(n)||0<L(t.selection.getRng(),D).length}var r=t.dom.getParents(t.selection.getStart());return n.setDisabled(!e(r)),X(t,(function(t){return n.setDisabled(!e(t.parents))}))}}function Z(t){var n=y(function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i)}return r}(t.dom.select("a:not([href])"),(function(t){var n=t.name||t.id;return n?[{text:n,value:"#"+n}]:[]})));return 0<n.length?nt.some([{text:"None",value:""}].concat(n)):nt.none()}var tt=function(t){function n(){return i}function e(n){return n(t)}var o=r(t),i={fold:function(n,e){return e(t)},isSome:p,isNone:h,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return tt(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?i:v},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return i},nt={some:tt,none:u,from:function(t){return null==t?v:tt(t)}},et=Array.prototype.indexOf,rt=Array.prototype.push,ot=tinymce.util.Tools.resolve("tinymce.util.Tools"),it=function(t,n){var e=[];return ot.each(t,(function(t){var r,o,i,u=f((r=t).text)?r.text:f(r.title)?r.title:"";void 0!==t.menu?(o=it(t.menu,n),e.push({text:u,items:o})):(i=n(t),e.push({text:u,value:i}))})),e},ut={sanitize:function(t){return S(P)(t)},sanitizeWith:S,createUi:function(t,n){return function(e){return{name:t,type:"listbox",label:n,items:e}}},getValue:P},at=function(){return(at=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},lt=Object.keys,ct=Object.hasOwnProperty,ft=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),st=tinymce.util.Tools.resolve("tinymce.util.URI"),mt=function(t){return t.getAttribute("data-mce-href")||t.getAttribute("href")},gt=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},dt=function(t,n){var e,r=t.dom.select("img",n)[0];!r||(e=t.dom.getParents(r,"a[href]",n)[0])&&(e.parentNode.insertBefore(r,e),t.dom.remove(e))},ht=function(t,n,e){var r,o=t.dom.select("img",n)[0];o&&(r=t.dom.create("a",e),o.parentNode.insertBefore(r,o),r.appendChild(o))},pt=function(t,n){return x(n,(function(n){return _(e=n,"items")&&void 0!==e.items&&null!==e.items?pt(t,n.items):O(n.value===t,n);var e}))},vt=function(t,n){var r={text:t.text,title:t.title};return{onChange:function(t,o){var i,u,a,l,c,f,s=o.name;return"url"===s?(a=(u=t()).url,c=O(r.text.length<=0,nt.from(a.meta.text).getOr(a.value)),l=u.url,f=O(r.title.length<=0,nt.from(l.meta.title).getOr("")),c.isSome()||f.isSome()?nt.some(at(at({},c.map((function(t){return{text:t}})).getOr({})),f.map((function(t){return{title:t}})).getOr({}))):nt.none()):(i=["anchor","link"],-1<et.call(i,s)?function(t,o){var i,u,a,l,c,f=("link"===(i=o.name)?n.link:"anchor"===i?n.anchor:nt.none()).getOr([]);return u=r.text,a=f,l=t[o.name],c=0<u.length,void 0!==l?pt(l,a).map((function(t){return{url:{value:t.value,meta:{text:c?u:t.text,attach:e}},text:c?u:t.text}})):nt.none()}(t(),o):("text"!==s&&"title"!==s||(r[s]=t()[s]),nt.none()))}}},kt=tinymce.util.Tools.resolve("tinymce.util.Delay"),yt=tinymce.util.Tools.resolve("tinymce.util.Promise"),xt=function(t,n){return x([V,(e=w(t),r=t.getParam("link_default_protocol","http","string"),function(t){var n=t.href;return 1===e&&!E(n)||0===e&&/^\s*www(\.|\d\.)/i.test(n)?nt.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(t){return at(at({},t),{href:r+"://"+n})}}):nt.none()})],(function(t){return t(n)})).fold((function(){return yt.resolve(n)}),(function(e){return new yt((function(r){var o=t,i=e.message,u=o.selection.getRng();kt.setEditorTimeout(o,(function(){o.windowManager.confirm(i,(function(t){o.selection.setRng(u),function(t){r(t?e.preprocess(n):n)}(t)}))}))}))}));var e,r},bt=tinymce.util.Tools.resolve("tinymce.util.XHR"),Ot=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],wt=function(t,n){return o=(r=t).getParam("link_list"),new yt((function(t){f(o)?bt.send({url:o,success:function(n){return t(function(t){try{return nt.some(JSON.parse(t))}catch(t){return nt.none()}}(n))},error:function(n){return t(nt.none())}}):d(o)?o((function(n){return t(nt.some(n))})):t(nt.from(o))})).then((function(t){return t.bind(ut.sanitizeWith(e)).map((function(t){return 0<t.length?[{text:"None",value:""}].concat(t):t}))})).then((function(e){var r,o,i,u,a,l,c,f,m,g,d=(o=n,i=(r=t).dom,u=K(r)?nt.some(B(r.selection,o)):nt.none(),a=o?nt.some(i.getAttrib(o,"href")):nt.none(),l=o?nt.from(i.getAttrib(o,"target")):nt.none(),c=q(i,o,"rel"),f=q(i,o,"class"),{url:a,text:u,title:q(i,o,"title"),target:l,rel:c,linkClass:f});return{anchor:d,catalogs:{targets:(g=N(t),s(g)?ut.sanitize(g).orThunk((function(){return nt.some(Ot)})):!1===g?nt.none():nt.some(Ot)),rels:function(t,n){var e=A(t);if(0<e.length){var r=b(n,"_blank");return(!1===T(t)?ut.sanitizeWith((function(t){return M(ut.getValue(t),r)})):ut.sanitize)(e)}return nt.none()}(t,d.target),classes:0<(m=t.getParam("link_class_list",[],"array")).length?ut.sanitize(m):nt.none(),anchor:Z(t),link:e},optNode:nt.from(n),flags:{titleEnabled:t.getParam("link_title",!0,"boolean")}}}));function e(t){return r.convertURL(t.value||t.url,"href")}var r,o};l.add("link",(function(t){var n,r,o,i,u,a,l;function f(t){var n=l.selection.getNode();return t.setDisabled(!U(l,n)),e}(n=t).ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:G(n),onSetup:$(n)}),n.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:J(n),onSetup:Q(n)}),n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return j(n)},onSetup:Y(n)}),(r=t).ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:J(r),onSetup:Q(r)}),r.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:G(r)}),r.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return j(r)},onSetup:Y(r)}),(o=t).ui.registry.addContextMenu("link",{update:function(t){return I(o.dom.getParents(t,"a"))?"link unlink openlink":"link"}}),(l=t).ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:$(l)},label:"Link",predicate:function(t){return!!U(l,t)&&l.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var t=U(l);return t?mt(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var n=l.selection.getNode();return t.setActive(!!U(l,n)),$(l)(t)},onAction:function(t){var n=t.getValue(),r=function(t){var n=U(l),e=K(l);if(n||!e)return nt.none();var r=B(l.selection,n);return nt.some(0<r.length?r:t)}(n);z(l,{href:n,attach:e},{href:n,text:r,title:nt.none(),rel:nt.none(),target:nt.none(),class:nt.none()}),l.selection.collapse(!1),t.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:f,onAction:function(t){j(l),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:f,onAction:function(t){J(l)(),t.hide()}}]}),(a=t).on("click",(function(t){var n=F(a,t.target);n&&c.metaKeyPressed(t)&&(t.preventDefault(),H(a,n))})),a.on("keydown",(function(t){var n=W(a);n&&13===t.keyCode&&!0===t.altKey&&!1===t.shiftKey&&!1===t.ctrlKey&&!1===t.metaKey&&(t.preventDefault(),H(a,n))})),(i=t).addCommand("mceLink",(function(){i.getParam("link_quicklink",!1,"boolean")?i.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):G(i)()})),(u=t).addShortcut("Meta+K","",(function(){u.execCommand("mceLink")}))}))}()}}]);
//# sourceMappingURL=91667.87366dac456e919b4397.min.js.map