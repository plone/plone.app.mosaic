{"version":3,"file":"chunks/73253.7372bb94257eb46440bc.min.js","mappings":"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","sources":["webpack://plone-mosaic/./node_modules/tinymce/plugins/imagetools/plugin.js"],"sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.7 (2022-12-06)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var isArray = isType('array');\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = identity;\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: function () {\n          return none();\n        },\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (global, factory) {\n        typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.EphoxContactWrapper = factory());\n      }(this, function () {\n        var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n        var promise = { exports: {} };\n        (function (module) {\n          (function (root) {\n            var setTimeoutFunc = setTimeout;\n            function noop() {\n            }\n            function bind(fn, thisArg) {\n              return function () {\n                fn.apply(thisArg, arguments);\n              };\n            }\n            function Promise(fn) {\n              if (typeof this !== 'object')\n                throw new TypeError('Promises must be constructed via new');\n              if (typeof fn !== 'function')\n                throw new TypeError('not a function');\n              this._state = 0;\n              this._handled = false;\n              this._value = undefined;\n              this._deferreds = [];\n              doResolve(fn, this);\n            }\n            function handle(self, deferred) {\n              while (self._state === 3) {\n                self = self._value;\n              }\n              if (self._state === 0) {\n                self._deferreds.push(deferred);\n                return;\n              }\n              self._handled = true;\n              Promise._immediateFn(function () {\n                var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                if (cb === null) {\n                  (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                  return;\n                }\n                var ret;\n                try {\n                  ret = cb(self._value);\n                } catch (e) {\n                  reject(deferred.promise, e);\n                  return;\n                }\n                resolve(deferred.promise, ret);\n              });\n            }\n            function resolve(self, newValue) {\n              try {\n                if (newValue === self)\n                  throw new TypeError('A promise cannot be resolved with itself.');\n                if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                  var then = newValue.then;\n                  if (newValue instanceof Promise) {\n                    self._state = 3;\n                    self._value = newValue;\n                    finale(self);\n                    return;\n                  } else if (typeof then === 'function') {\n                    doResolve(bind(then, newValue), self);\n                    return;\n                  }\n                }\n                self._state = 1;\n                self._value = newValue;\n                finale(self);\n              } catch (e) {\n                reject(self, e);\n              }\n            }\n            function reject(self, newValue) {\n              self._state = 2;\n              self._value = newValue;\n              finale(self);\n            }\n            function finale(self) {\n              if (self._state === 2 && self._deferreds.length === 0) {\n                Promise._immediateFn(function () {\n                  if (!self._handled) {\n                    Promise._unhandledRejectionFn(self._value);\n                  }\n                });\n              }\n              for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                handle(self, self._deferreds[i]);\n              }\n              self._deferreds = null;\n            }\n            function Handler(onFulfilled, onRejected, promise) {\n              this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n              this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n              this.promise = promise;\n            }\n            function doResolve(fn, self) {\n              var done = false;\n              try {\n                fn(function (value) {\n                  if (done)\n                    return;\n                  done = true;\n                  resolve(self, value);\n                }, function (reason) {\n                  if (done)\n                    return;\n                  done = true;\n                  reject(self, reason);\n                });\n              } catch (ex) {\n                if (done)\n                  return;\n                done = true;\n                reject(self, ex);\n              }\n            }\n            Promise.prototype['catch'] = function (onRejected) {\n              return this.then(null, onRejected);\n            };\n            Promise.prototype.then = function (onFulfilled, onRejected) {\n              var prom = new this.constructor(noop);\n              handle(this, new Handler(onFulfilled, onRejected, prom));\n              return prom;\n            };\n            Promise.all = function (arr) {\n              var args = Array.prototype.slice.call(arr);\n              return new Promise(function (resolve, reject) {\n                if (args.length === 0)\n                  return resolve([]);\n                var remaining = args.length;\n                function res(i, val) {\n                  try {\n                    if (val && (typeof val === 'object' || typeof val === 'function')) {\n                      var then = val.then;\n                      if (typeof then === 'function') {\n                        then.call(val, function (val) {\n                          res(i, val);\n                        }, reject);\n                        return;\n                      }\n                    }\n                    args[i] = val;\n                    if (--remaining === 0) {\n                      resolve(args);\n                    }\n                  } catch (ex) {\n                    reject(ex);\n                  }\n                }\n                for (var i = 0; i < args.length; i++) {\n                  res(i, args[i]);\n                }\n              });\n            };\n            Promise.resolve = function (value) {\n              if (value && typeof value === 'object' && value.constructor === Promise) {\n                return value;\n              }\n              return new Promise(function (resolve) {\n                resolve(value);\n              });\n            };\n            Promise.reject = function (value) {\n              return new Promise(function (resolve, reject) {\n                reject(value);\n              });\n            };\n            Promise.race = function (values) {\n              return new Promise(function (resolve, reject) {\n                for (var i = 0, len = values.length; i < len; i++) {\n                  values[i].then(resolve, reject);\n                }\n              });\n            };\n            Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n              setImmediate(fn);\n            } : function (fn) {\n              setTimeoutFunc(fn, 0);\n            };\n            Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n              if (typeof console !== 'undefined' && console) {\n                console.warn('Possible Unhandled Promise Rejection:', err);\n              }\n            };\n            Promise._setImmediateFn = function _setImmediateFn(fn) {\n              Promise._immediateFn = fn;\n            };\n            Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n              Promise._unhandledRejectionFn = fn;\n            };\n            if (module.exports) {\n              module.exports = Promise;\n            } else if (!root.Promise) {\n              root.Promise = Promise;\n            }\n          }(commonjsGlobal));\n        }(promise));\n        var promisePolyfill = promise.exports;\n        var Global = function () {\n          if (typeof window !== 'undefined') {\n            return window;\n          } else {\n            return Function('return this;')();\n          }\n        }();\n        var promisePolyfill_1 = { boltExport: Global.Promise || promisePolyfill };\n        return promisePolyfill_1;\n      }));\n    }(undefined, exports$1, module));\n    var Promise$1 = module.exports.boltExport;\n\n    var create$1 = function (width, height) {\n      return resize(document.createElement('canvas'), width, height);\n    };\n    var clone = function (canvas) {\n      var tCanvas = create$1(canvas.width, canvas.height);\n      var ctx = get2dContext(tCanvas);\n      ctx.drawImage(canvas, 0, 0);\n      return tCanvas;\n    };\n    var get2dContext = function (canvas) {\n      return canvas.getContext('2d');\n    };\n    var resize = function (canvas, width, height) {\n      canvas.width = width;\n      canvas.height = height;\n      return canvas;\n    };\n\n    var getWidth = function (image) {\n      return image.naturalWidth || image.width;\n    };\n    var getHeight = function (image) {\n      return image.naturalHeight || image.height;\n    };\n\n    var imageToBlob$2 = function (image) {\n      var src = image.src;\n      if (src.indexOf('data:') === 0) {\n        return dataUriToBlob(src);\n      }\n      return anyUriToBlob(src);\n    };\n    var blobToImage$1 = function (blob) {\n      return new Promise$1(function (resolve, reject) {\n        var blobUrl = URL.createObjectURL(blob);\n        var image = new Image();\n        var removeListeners = function () {\n          image.removeEventListener('load', loaded);\n          image.removeEventListener('error', error);\n        };\n        var loaded = function () {\n          removeListeners();\n          resolve(image);\n        };\n        var error = function () {\n          removeListeners();\n          reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n        };\n        image.addEventListener('load', loaded);\n        image.addEventListener('error', error);\n        image.src = blobUrl;\n        if (image.complete) {\n          setTimeout(loaded, 0);\n        }\n      });\n    };\n    var anyUriToBlob = function (url) {\n      return new Promise$1(function (resolve, reject) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', url, true);\n        xhr.responseType = 'blob';\n        xhr.onload = function () {\n          if (this.status === 200) {\n            resolve(this.response);\n          }\n        };\n        xhr.onerror = function () {\n          var _this = this;\n          var corsError = function () {\n            var obj = new Error('No access to download image');\n            obj.code = 18;\n            obj.name = 'SecurityError';\n            return obj;\n          };\n          var genericError = function () {\n            return new Error('Error ' + _this.status + ' downloading image');\n          };\n          reject(this.status === 0 ? corsError() : genericError());\n        };\n        xhr.send();\n      });\n    };\n    var dataUriToBlobSync = function (uri) {\n      var data = uri.split(',');\n      var matches = /data:([^;]+)/.exec(data[0]);\n      if (!matches) {\n        return Optional.none();\n      }\n      var mimetype = matches[1];\n      var base64 = data[1];\n      var sliceSize = 1024;\n      var byteCharacters = atob(base64);\n      var bytesLength = byteCharacters.length;\n      var slicesCount = Math.ceil(bytesLength / sliceSize);\n      var byteArrays = new Array(slicesCount);\n      for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n        var begin = sliceIndex * sliceSize;\n        var end = Math.min(begin + sliceSize, bytesLength);\n        var bytes = new Array(end - begin);\n        for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n          bytes[i] = byteCharacters[offset].charCodeAt(0);\n        }\n        byteArrays[sliceIndex] = new Uint8Array(bytes);\n      }\n      return Optional.some(new Blob(byteArrays, { type: mimetype }));\n    };\n    var dataUriToBlob = function (uri) {\n      return new Promise$1(function (resolve, reject) {\n        dataUriToBlobSync(uri).fold(function () {\n          reject('uri is not base64: ' + uri);\n        }, resolve);\n      });\n    };\n    var canvasToBlob = function (canvas, type, quality) {\n      type = type || 'image/png';\n      if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n        return new Promise$1(function (resolve, reject) {\n          canvas.toBlob(function (blob) {\n            if (blob) {\n              resolve(blob);\n            } else {\n              reject();\n            }\n          }, type, quality);\n        });\n      } else {\n        return dataUriToBlob(canvas.toDataURL(type, quality));\n      }\n    };\n    var canvasToDataURL = function (canvas, type, quality) {\n      type = type || 'image/png';\n      return canvas.toDataURL(type, quality);\n    };\n    var blobToCanvas = function (blob) {\n      return blobToImage$1(blob).then(function (image) {\n        revokeImageUrl(image);\n        var canvas = create$1(getWidth(image), getHeight(image));\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0);\n        return canvas;\n      });\n    };\n    var blobToDataUri = function (blob) {\n      return new Promise$1(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var revokeImageUrl = function (image) {\n      URL.revokeObjectURL(image.src);\n    };\n\n    var blobToImage = function (blob) {\n      return blobToImage$1(blob);\n    };\n    var imageToBlob$1 = function (image) {\n      return imageToBlob$2(image);\n    };\n\n    var nativeIndexOf = Array.prototype.indexOf;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var each$1 = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldl = function (xs, f, acc) {\n      each$1(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    var keys = Object.keys;\n    var each = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each$1(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n\n    var create = function (getCanvas, blob, uri) {\n      var initialType = blob.type;\n      var getType = constant(initialType);\n      var toBlob = function () {\n        return Promise$1.resolve(blob);\n      };\n      var toDataURL = constant(uri);\n      var toBase64 = function () {\n        return uri.split(',')[1];\n      };\n      var toAdjustedBlob = function (type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToBlob(canvas, type, quality);\n        });\n      };\n      var toAdjustedDataURL = function (type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToDataURL(canvas, type, quality);\n        });\n      };\n      var toAdjustedBase64 = function (type, quality) {\n        return toAdjustedDataURL(type, quality).then(function (dataurl) {\n          return dataurl.split(',')[1];\n        });\n      };\n      var toCanvas = function () {\n        return getCanvas.then(clone);\n      };\n      return {\n        getType: getType,\n        toBlob: toBlob,\n        toDataURL: toDataURL,\n        toBase64: toBase64,\n        toAdjustedBlob: toAdjustedBlob,\n        toAdjustedDataURL: toAdjustedDataURL,\n        toAdjustedBase64: toAdjustedBase64,\n        toCanvas: toCanvas\n      };\n    };\n    var fromBlob = function (blob) {\n      return blobToDataUri(blob).then(function (uri) {\n        return create(blobToCanvas(blob), blob, uri);\n      });\n    };\n    var fromCanvas = function (canvas, type) {\n      return canvasToBlob(canvas, type).then(function (blob) {\n        return create(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n      });\n    };\n\n    var ceilWithPrecision = function (num, precision) {\n      if (precision === void 0) {\n        precision = 2;\n      }\n      var mul = Math.pow(10, precision);\n      var upper = Math.round(num * mul);\n      return Math.ceil(upper / mul);\n    };\n    var rotate$2 = function (ir, angle) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyRotate(canvas, ir.getType(), angle);\n      });\n    };\n    var applyRotate = function (image, type, angle) {\n      var degrees = angle < 0 ? 360 + angle : angle;\n      var rad = degrees * Math.PI / 180;\n      var width = image.width;\n      var height = image.height;\n      var sin = Math.sin(rad);\n      var cos = Math.cos(rad);\n      var newWidth = ceilWithPrecision(Math.abs(width * cos) + Math.abs(height * sin));\n      var newHeight = ceilWithPrecision(Math.abs(width * sin) + Math.abs(height * cos));\n      var canvas = create$1(newWidth, newHeight);\n      var context = get2dContext(canvas);\n      context.translate(newWidth / 2, newHeight / 2);\n      context.rotate(rad);\n      context.drawImage(image, -width / 2, -height / 2);\n      return fromCanvas(canvas, type);\n    };\n    var flip$2 = function (ir, axis) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyFlip(canvas, ir.getType(), axis);\n      });\n    };\n    var applyFlip = function (image, type, axis) {\n      var canvas = create$1(image.width, image.height);\n      var context = get2dContext(canvas);\n      if (axis === 'v') {\n        context.scale(1, -1);\n        context.drawImage(image, 0, -canvas.height);\n      } else {\n        context.scale(-1, 1);\n        context.drawImage(image, -canvas.width, 0);\n      }\n      return fromCanvas(canvas, type);\n    };\n\n    var flip$1 = function (ir, axis) {\n      return flip$2(ir, axis);\n    };\n    var rotate$1 = function (ir, angle) {\n      return rotate$2(ir, angle);\n    };\n\n    var sendRequest = function (url, headers, withCredentials) {\n      if (withCredentials === void 0) {\n        withCredentials = false;\n      }\n      return new Promise$1(function (resolve) {\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function () {\n          if (xhr.readyState === 4) {\n            resolve({\n              status: xhr.status,\n              blob: xhr.response\n            });\n          }\n        };\n        xhr.open('GET', url, true);\n        xhr.withCredentials = withCredentials;\n        each(headers, function (value, key) {\n          xhr.setRequestHeader(key, value);\n        });\n        xhr.responseType = 'blob';\n        xhr.send();\n      });\n    };\n    var readBlobText = function (blob) {\n      return new Promise$1(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n        reader.onerror = function (e) {\n          reject(e);\n        };\n        reader.readAsText(blob);\n      });\n    };\n    var parseJson = function (text) {\n      try {\n        return Optional.some(JSON.parse(text));\n      } catch (ex) {\n        return Optional.none();\n      }\n    };\n\n    var friendlyHttpErrors = [\n      {\n        code: 404,\n        message: 'Could not find Image Proxy'\n      },\n      {\n        code: 403,\n        message: 'Rejected request'\n      },\n      {\n        code: 0,\n        message: 'Incorrect Image Proxy URL'\n      }\n    ];\n    var friendlyServiceErrors = [\n      {\n        type: 'not_found',\n        message: 'Failed to load image.'\n      },\n      {\n        type: 'key_missing',\n        message: 'The request did not include an api key.'\n      },\n      {\n        type: 'key_not_found',\n        message: 'The provided api key could not be found.'\n      },\n      {\n        type: 'domain_not_trusted',\n        message: 'The api key is not valid for the request origins.'\n      }\n    ];\n    var traverseJson = function (json, path) {\n      var value = foldl(path, function (result, key) {\n        return isNonNullable(result) ? result[key] : undefined;\n      }, json);\n      return Optional.from(value);\n    };\n    var isServiceErrorCode = function (code, blob) {\n      return (blob === null || blob === void 0 ? void 0 : blob.type) === 'application/json' && (code === 400 || code === 403 || code === 404 || code === 500);\n    };\n    var getHttpErrorMsg = function (status) {\n      var message = find(friendlyHttpErrors, function (error) {\n        return status === error.code;\n      }).fold(constant('Unknown ImageProxy error'), function (error) {\n        return error.message;\n      });\n      return 'ImageProxy HTTP error: ' + message;\n    };\n    var handleHttpError = function (status) {\n      var message = getHttpErrorMsg(status);\n      return Promise$1.reject(message);\n    };\n    var getServiceErrorMsg = function (type) {\n      return find(friendlyServiceErrors, function (error) {\n        return error.type === type;\n      }).fold(constant('Unknown service error'), function (error) {\n        return error.message;\n      });\n    };\n    var getServiceError = function (text) {\n      var serviceError = parseJson(text);\n      var errorMsg = serviceError.bind(function (err) {\n        return traverseJson(err, [\n          'error',\n          'type'\n        ]).map(getServiceErrorMsg);\n      }).getOr('Invalid JSON in service error message');\n      return 'ImageProxy Service error: ' + errorMsg;\n    };\n    var handleServiceError = function (blob) {\n      return readBlobText(blob).then(function (text) {\n        var serviceError = getServiceError(text);\n        return Promise$1.reject(serviceError);\n      });\n    };\n    var handleServiceErrorResponse = function (status, blob) {\n      return isServiceErrorCode(status, blob) ? handleServiceError(blob) : handleHttpError(status);\n    };\n\n    var appendApiKey = function (url, apiKey) {\n      var separator = url.indexOf('?') === -1 ? '?' : '&';\n      if (/[?&]apiKey=/.test(url)) {\n        return url;\n      } else {\n        return url + separator + 'apiKey=' + encodeURIComponent(apiKey);\n      }\n    };\n    var isError = function (status) {\n      return status < 200 || status >= 300;\n    };\n    var requestServiceBlob = function (url, apiKey) {\n      var headers = {\n        'Content-Type': 'application/json;charset=UTF-8',\n        'tiny-api-key': apiKey\n      };\n      return sendRequest(appendApiKey(url, apiKey), headers).then(function (result) {\n        return isError(result.status) ? handleServiceErrorResponse(result.status, result.blob) : Promise$1.resolve(result.blob);\n      });\n    };\n    var requestBlob = function (url, withCredentials) {\n      return sendRequest(url, {}, withCredentials).then(function (result) {\n        return isError(result.status) ? handleHttpError(result.status) : Promise$1.resolve(result.blob);\n      });\n    };\n    var getUrl = function (url, apiKey, withCredentials) {\n      if (withCredentials === void 0) {\n        withCredentials = false;\n      }\n      return apiKey ? requestServiceBlob(url, apiKey) : requestBlob(url, withCredentials);\n    };\n\n    var blobToImageResult = function (blob) {\n      return fromBlob(blob);\n    };\n\n    var ELEMENT = 1;\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var is = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n\n    typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n\n    var child = function (scope, selector) {\n      return child$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n    var getToolbarItems = function (editor) {\n      return editor.getParam('imagetools_toolbar', 'rotateleft rotateright flipv fliph editimage imageoptions');\n    };\n    var getProxyUrl = function (editor) {\n      return editor.getParam('imagetools_proxy');\n    };\n    var getCorsHosts = function (editor) {\n      return editor.getParam('imagetools_cors_hosts', [], 'string[]');\n    };\n    var getCredentialsHosts = function (editor) {\n      return editor.getParam('imagetools_credentials_hosts', [], 'string[]');\n    };\n    var getFetchImage = function (editor) {\n      return Optional.from(editor.getParam('imagetools_fetch_image', null, 'function'));\n    };\n    var getApiKey = function (editor) {\n      return editor.getParam('api_key', editor.getParam('imagetools_api_key', '', 'string'), 'string');\n    };\n    var getUploadTimeout = function (editor) {\n      return editor.getParam('images_upload_timeout', 30000, 'number');\n    };\n    var shouldReuseFilename = function (editor) {\n      return editor.getParam('images_reuse_filename', false, 'boolean');\n    };\n\n    var getImageSize = function (img) {\n      var width, height;\n      var isPxValue = function (value) {\n        return /^[0-9\\.]+px$/.test(value);\n      };\n      width = img.style.width;\n      height = img.style.height;\n      if (width || height) {\n        if (isPxValue(width) && isPxValue(height)) {\n          return {\n            w: parseInt(width, 10),\n            h: parseInt(height, 10)\n          };\n        }\n        return null;\n      }\n      width = img.width;\n      height = img.height;\n      if (width && height) {\n        return {\n          w: parseInt(width, 10),\n          h: parseInt(height, 10)\n        };\n      }\n      return null;\n    };\n    var setImageSize = function (img, size) {\n      var width, height;\n      if (size) {\n        width = img.style.width;\n        height = img.style.height;\n        if (width || height) {\n          img.style.width = size.w + 'px';\n          img.style.height = size.h + 'px';\n          img.removeAttribute('data-mce-style');\n        }\n        width = img.width;\n        height = img.height;\n        if (width || height) {\n          img.setAttribute('width', String(size.w));\n          img.setAttribute('height', String(size.h));\n        }\n      }\n    };\n    var getNaturalImageSize = function (img) {\n      return {\n        w: img.naturalWidth,\n        h: img.naturalHeight\n      };\n    };\n\n    var count = 0;\n    var getFigureImg = function (elem) {\n      return child(SugarElement.fromDom(elem), 'img');\n    };\n    var isFigure = function (editor, elem) {\n      return editor.dom.is(elem, 'figure');\n    };\n    var isImage = function (editor, imgNode) {\n      return editor.dom.is(imgNode, 'img:not([data-mce-object],[data-mce-placeholder])');\n    };\n    var getEditableImage = function (editor, node) {\n      var isEditable = function (imgNode) {\n        return isImage(editor, imgNode) && (isLocalImage(editor, imgNode) || isCorsImage(editor, imgNode) || isNonNullable(getProxyUrl(editor)));\n      };\n      if (isFigure(editor, node)) {\n        return getFigureImg(node).bind(function (img) {\n          return isEditable(img.dom) ? Optional.some(img.dom) : Optional.none();\n        });\n      } else {\n        return isEditable(node) ? Optional.some(node) : Optional.none();\n      }\n    };\n    var displayError = function (editor, error) {\n      editor.notificationManager.open({\n        text: error,\n        type: 'error'\n      });\n    };\n    var getSelectedImage = function (editor) {\n      var elem = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(elem, 'figure.image');\n      if (figureElm !== null && isFigure(editor, figureElm)) {\n        return getFigureImg(figureElm);\n      } else if (isImage(editor, elem)) {\n        return Optional.some(SugarElement.fromDom(elem));\n      } else {\n        return Optional.none();\n      }\n    };\n    var extractFilename = function (editor, url, group) {\n      var m = url.match(/(?:\\/|^)(([^\\/\\?]+)\\.(?:[a-z0-9.]+))(?:\\?|$)/i);\n      return isNonNullable(m) ? editor.dom.encode(m[group]) : null;\n    };\n    var createId = function () {\n      return 'imagetools' + count++;\n    };\n    var isLocalImage = function (editor, img) {\n      var url = img.src;\n      return url.indexOf('data:') === 0 || url.indexOf('blob:') === 0 || new global$1(url).host === editor.documentBaseURI.host;\n    };\n    var isCorsImage = function (editor, img) {\n      return global$4.inArray(getCorsHosts(editor), new global$1(img.src).host) !== -1;\n    };\n    var isCorsWithCredentialsImage = function (editor, img) {\n      return global$4.inArray(getCredentialsHosts(editor), new global$1(img.src).host) !== -1;\n    };\n    var defaultFetchImage = function (editor, img) {\n      if (isCorsImage(editor, img)) {\n        return getUrl(img.src, null, isCorsWithCredentialsImage(editor, img));\n      }\n      if (!isLocalImage(editor, img)) {\n        var proxyUrl = getProxyUrl(editor);\n        var src = proxyUrl + (proxyUrl.indexOf('?') === -1 ? '?' : '&') + 'url=' + encodeURIComponent(img.src);\n        var apiKey = getApiKey(editor);\n        return getUrl(src, apiKey, false);\n      }\n      return imageToBlob$1(img);\n    };\n    var imageToBlob = function (editor, img) {\n      return getFetchImage(editor).fold(function () {\n        return defaultFetchImage(editor, img);\n      }, function (customFetchImage) {\n        return customFetchImage(img);\n      });\n    };\n    var findBlob = function (editor, img) {\n      var blobInfo = editor.editorUpload.blobCache.getByUri(img.src);\n      if (blobInfo) {\n        return global$2.resolve(blobInfo.blob());\n      }\n      return imageToBlob(editor, img);\n    };\n    var startTimedUpload = function (editor, imageUploadTimerState) {\n      var imageUploadTimer = global$3.setEditorTimeout(editor, function () {\n        editor.editorUpload.uploadImagesAuto();\n      }, getUploadTimeout(editor));\n      imageUploadTimerState.set(imageUploadTimer);\n    };\n    var cancelTimedUpload = function (imageUploadTimerState) {\n      global$3.clearTimeout(imageUploadTimerState.get());\n    };\n    var updateSelectedImage = function (editor, origBlob, ir, uploadImmediately, imageUploadTimerState, selectedImage, size) {\n      return ir.toBlob().then(function (blob) {\n        var uri, name, filename, blobInfo;\n        var blobCache = editor.editorUpload.blobCache;\n        uri = selectedImage.src;\n        var useFilename = origBlob.type === blob.type;\n        if (shouldReuseFilename(editor)) {\n          blobInfo = blobCache.getByUri(uri);\n          if (isNonNullable(blobInfo)) {\n            uri = blobInfo.uri();\n            name = blobInfo.name();\n            filename = blobInfo.filename();\n          } else {\n            name = extractFilename(editor, uri, 2);\n            filename = extractFilename(editor, uri, 1);\n          }\n        }\n        blobInfo = blobCache.create({\n          id: createId(),\n          blob: blob,\n          base64: ir.toBase64(),\n          uri: uri,\n          name: name,\n          filename: useFilename ? filename : undefined\n        });\n        blobCache.add(blobInfo);\n        editor.undoManager.transact(function () {\n          var imageLoadedHandler = function () {\n            editor.$(selectedImage).off('load', imageLoadedHandler);\n            editor.nodeChanged();\n            if (uploadImmediately) {\n              editor.editorUpload.uploadImagesAuto();\n            } else {\n              cancelTimedUpload(imageUploadTimerState);\n              startTimedUpload(editor, imageUploadTimerState);\n            }\n          };\n          editor.$(selectedImage).on('load', imageLoadedHandler);\n          if (size) {\n            editor.$(selectedImage).attr({\n              width: size.w,\n              height: size.h\n            });\n          }\n          editor.$(selectedImage).attr({ src: blobInfo.blobUri() }).removeAttr('data-mce-src');\n        });\n        return blobInfo;\n      });\n    };\n    var selectedImageOperation = function (editor, imageUploadTimerState, fn, size) {\n      return function () {\n        var imgOpt = getSelectedImage(editor);\n        return imgOpt.fold(function () {\n          displayError(editor, 'Could not find selected image');\n        }, function (img) {\n          return editor._scanForImages().then(function () {\n            return findBlob(editor, img.dom);\n          }).then(function (blob) {\n            return blobToImageResult(blob).then(fn).then(function (imageResult) {\n              return updateSelectedImage(editor, blob, imageResult, false, imageUploadTimerState, img.dom, size);\n            });\n          }).catch(function (error) {\n            displayError(editor, error);\n          });\n        });\n      };\n    };\n    var rotate = function (editor, imageUploadTimerState, angle) {\n      return function () {\n        var imgOpt = getSelectedImage(editor);\n        var flippedSize = imgOpt.map(function (img) {\n          var size = getImageSize(img.dom);\n          return size ? {\n            w: size.h,\n            h: size.w\n          } : null;\n        }).getOrNull();\n        return selectedImageOperation(editor, imageUploadTimerState, function (imageResult) {\n          return rotate$1(imageResult, angle);\n        }, flippedSize)();\n      };\n    };\n    var flip = function (editor, imageUploadTimerState, axis) {\n      return function () {\n        return selectedImageOperation(editor, imageUploadTimerState, function (imageResult) {\n          return flip$1(imageResult, axis);\n        })();\n      };\n    };\n    var handleDialogBlob = function (editor, imageUploadTimerState, img, originalSize, blob) {\n      return blobToImage(blob).then(function (newImage) {\n        var newSize = getNaturalImageSize(newImage);\n        if (originalSize.w !== newSize.w || originalSize.h !== newSize.h) {\n          if (getImageSize(img)) {\n            setImageSize(img, newSize);\n          }\n        }\n        URL.revokeObjectURL(newImage.src);\n        return blob;\n      }).then(blobToImageResult).then(function (imageResult) {\n        return updateSelectedImage(editor, blob, imageResult, true, imageUploadTimerState, img);\n      });\n    };\n\n    var saveState = 'save-state';\n    var disable = 'disable';\n    var enable = 'enable';\n\n    var createState = function (blob) {\n      return {\n        blob: blob,\n        url: URL.createObjectURL(blob)\n      };\n    };\n    var makeOpen = function (editor, imageUploadTimerState) {\n      return function () {\n        var getLoadedSpec = function (currentState) {\n          return {\n            title: 'Edit Image',\n            size: 'large',\n            body: {\n              type: 'panel',\n              items: [{\n                  type: 'imagetools',\n                  name: 'imagetools',\n                  label: 'Edit Image',\n                  currentState: currentState\n                }]\n            },\n            buttons: [\n              {\n                type: 'cancel',\n                name: 'cancel',\n                text: 'Cancel'\n              },\n              {\n                type: 'submit',\n                name: 'save',\n                text: 'Save',\n                primary: true,\n                disabled: true\n              }\n            ],\n            onSubmit: function (api) {\n              var blob = api.getData().imagetools.blob;\n              originalImgOpt.each(function (originalImg) {\n                originalSizeOpt.each(function (originalSize) {\n                  handleDialogBlob(editor, imageUploadTimerState, originalImg.dom, originalSize, blob);\n                });\n              });\n              api.close();\n            },\n            onCancel: noop,\n            onAction: function (api, details) {\n              switch (details.name) {\n              case saveState:\n                if (details.value) {\n                  api.enable('save');\n                } else {\n                  api.disable('save');\n                }\n                break;\n              case disable:\n                api.disable('save');\n                api.disable('cancel');\n                break;\n              case enable:\n                api.enable('cancel');\n                break;\n              }\n            }\n          };\n        };\n        var originalImgOpt = getSelectedImage(editor);\n        var originalSizeOpt = originalImgOpt.map(function (origImg) {\n          return getNaturalImageSize(origImg.dom);\n        });\n        originalImgOpt.each(function (img) {\n          getEditableImage(editor, img.dom).each(function (_) {\n            findBlob(editor, img.dom).then(function (blob) {\n              var state = createState(blob);\n              editor.windowManager.open(getLoadedSpec(state));\n            });\n          });\n        });\n      };\n    };\n\n    var register$2 = function (editor, imageUploadTimerState) {\n      global$4.each({\n        mceImageRotateLeft: rotate(editor, imageUploadTimerState, -90),\n        mceImageRotateRight: rotate(editor, imageUploadTimerState, 90),\n        mceImageFlipVertical: flip(editor, imageUploadTimerState, 'v'),\n        mceImageFlipHorizontal: flip(editor, imageUploadTimerState, 'h'),\n        mceEditImage: makeOpen(editor, imageUploadTimerState)\n      }, function (fn, cmd) {\n        editor.addCommand(cmd, fn);\n      });\n    };\n\n    var setup = function (editor, imageUploadTimerState, lastSelectedImageState) {\n      editor.on('NodeChange', function (e) {\n        var lastSelectedImage = lastSelectedImageState.get();\n        var selectedImage = getEditableImage(editor, e.element);\n        if (lastSelectedImage && !selectedImage.exists(function (img) {\n            return lastSelectedImage.src === img.src;\n          })) {\n          cancelTimedUpload(imageUploadTimerState);\n          editor.editorUpload.uploadImagesAuto();\n          lastSelectedImageState.set(null);\n        }\n        selectedImage.each(lastSelectedImageState.set);\n      });\n    };\n\n    var register$1 = function (editor) {\n      var changeHandlers = [];\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      var isEditableImage = function () {\n        return getSelectedImage(editor).exists(function (element) {\n          return getEditableImage(editor, element.dom).isSome();\n        });\n      };\n      var onSetup = function (api) {\n        var handler = function (isEditableImage) {\n          return api.setDisabled(!isEditableImage);\n        };\n        handler(isEditableImage());\n        changeHandlers = changeHandlers.concat([handler]);\n        return function () {\n          changeHandlers = filter(changeHandlers, function (h) {\n            return h !== handler;\n          });\n        };\n      };\n      editor.on('NodeChange', function () {\n        var isEditable = isEditableImage();\n        each$1(changeHandlers, function (handler) {\n          return handler(isEditable);\n        });\n      });\n      editor.ui.registry.addButton('rotateleft', {\n        tooltip: 'Rotate counterclockwise',\n        icon: 'rotate-left',\n        onAction: cmd('mceImageRotateLeft'),\n        onSetup: onSetup\n      });\n      editor.ui.registry.addButton('rotateright', {\n        tooltip: 'Rotate clockwise',\n        icon: 'rotate-right',\n        onAction: cmd('mceImageRotateRight'),\n        onSetup: onSetup\n      });\n      editor.ui.registry.addButton('flipv', {\n        tooltip: 'Flip vertically',\n        icon: 'flip-vertically',\n        onAction: cmd('mceImageFlipVertical'),\n        onSetup: onSetup\n      });\n      editor.ui.registry.addButton('fliph', {\n        tooltip: 'Flip horizontally',\n        icon: 'flip-horizontally',\n        onAction: cmd('mceImageFlipHorizontal'),\n        onSetup: onSetup\n      });\n      editor.ui.registry.addButton('editimage', {\n        tooltip: 'Edit image',\n        icon: 'edit-image',\n        onAction: cmd('mceEditImage'),\n        onSetup: onSetup\n      });\n      editor.ui.registry.addButton('imageoptions', {\n        tooltip: 'Image options',\n        icon: 'image',\n        onAction: cmd('mceImage')\n      });\n      editor.ui.registry.addContextMenu('imagetools', {\n        update: function (element) {\n          return getEditableImage(editor, element).map(function (_) {\n            return {\n              text: 'Edit image',\n              icon: 'edit-image',\n              onAction: cmd('mceEditImage')\n            };\n          }).toArray();\n        }\n      });\n    };\n\n    var register = function (editor) {\n      editor.ui.registry.addContextToolbar('imagetools', {\n        items: getToolbarItems(editor),\n        predicate: function (elem) {\n          return getEditableImage(editor, elem).isSome();\n        },\n        position: 'node',\n        scope: 'node'\n      });\n    };\n\n    function Plugin () {\n      global$5.add('imagetools', function (editor) {\n        var imageUploadTimerState = Cell(0);\n        var lastSelectedImageState = Cell(null);\n        register$2(editor, imageUploadTimerState);\n        register$1(editor);\n        register(editor);\n        setup(editor, imageUploadTimerState, lastSelectedImageState);\n      });\n    }\n\n    Plugin();\n\n}());\n"],"names":["type","call","id","Cell","initial","value","get","set","v","global$5","tinymce","util","Tools","resolve","global$4","isArray","t","x","Array","prototype","isPrototypeOf","constructor","name","String","isNonNullable","a","isNullable","isFunction","isSimpleType","noop","constant","identity","never","always","none","NONE","fold","n","_s","isSome","isNone","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","toArray","toString","some","constant_a","self","me","f","s","Optional","from","exports$1","module","exports","define","require","global","factory","this","commonjsGlobal","globalThis","window","g","promise","root","setTimeoutFunc","setTimeout","Promise","fn","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","e","reject","push","newValue","then","finale","thisArg","apply","arguments","length","_unhandledRejectionFn","i","len","Handler","done","reason","ex","prom","all","arr","args","slice","remaining","res","val","race","values","setImmediate","err","console","warn","_setImmediateFn","_setUnhandledRejectionFn","promisePolyfill","boltExport","Function","amd","EphoxContactWrapper","Promise$1","create$1","width","height","resize","document","createElement","clone","canvas","tCanvas","get2dContext","drawImage","getContext","blobToImage$1","blob","blobUrl","URL","createObjectURL","image","Image","removeListeners","removeEventListener","loaded","error","addEventListener","src","complete","anyUriToBlob","url","xhr","XMLHttpRequest","open","responseType","onload","status","response","onerror","obj","_this","code","send","dataUriToBlob","uri","data","split","matches","exec","mimetype","base64","sliceSize","byteCharacters","atob","bytesLength","slicesCount","Math","ceil","byteArrays","sliceIndex","begin","end","min","bytes","offset","charCodeAt","Uint8Array","Blob","dataUriToBlobSync","canvasToBlob","quality","HTMLCanvasElement","toBlob","toDataURL","revokeImageUrl","revokeObjectURL","imageToBlob$1","indexOf","imageToBlob$2","nativeIndexOf","contains","xs","ts","each$1","find","pred","until","findUntil","keys","Object","Adt","cases","constructors","adt","acase","count","keys$1","key","_i","argLength","foldArgs","match","branches","branchKeys","join","reqKey","log","label","params","bothErrors","firstError","secondError","bothValues","create","getCanvas","initialType","getType","toAdjustedDataURL","canvasToDataURL","toBase64","toAdjustedBlob","toAdjustedBase64","dataurl","toCanvas","fromBlob","reader","FileReader","onloadend","result","readAsDataURL","blobToDataUri","naturalWidth","getWidth","naturalHeight","getHeight","blobToCanvas","fromCanvas","ceilWithPrecision","num","precision","mul","pow","upper","round","applyRotate","angle","rad","PI","sin","cos","newWidth","abs","newHeight","context","translate","rotate","applyFlip","axis","scale","flip$1","ir","flip$2","rotate$1","rotate$2","sendRequest","headers","withCredentials","onreadystatechange","readyState","props","k","setRequestHeader","friendlyHttpErrors","message","friendlyServiceErrors","traverseJson","json","path","acc","handleHttpError","getHttpErrorMsg","getServiceErrorMsg","getServiceError","text","serviceError","JSON","parse","parseJson","handleServiceError","readAsText","readBlobText","isError","requestServiceBlob","apiKey","separator","test","encodeURIComponent","appendApiKey","isServiceErrorCode","getUrl","requestBlob","blobToImageResult","fromDom","node","dom","SugarElement","fromHtml","html","scope","div","innerHTML","hasChildNodes","childNodes","fromTag","tag","fromText","createTextNode","fromPoint","docElm","y","elementFromPoint","child","selector","predicate","child$1","element","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","is","global$3","global$2","global$1","getToolbarItems","editor","getParam","getProxyUrl","getImageSize","img","isPxValue","style","w","parseInt","h","getNaturalImageSize","getFigureImg","isFigure","isImage","imgNode","getEditableImage","isEditable","isLocalImage","isCorsImage","displayError","notificationManager","getSelectedImage","selection","getNode","figureElm","getParent","extractFilename","group","m","encode","host","documentBaseURI","inArray","getCorsHosts","defaultFetchImage","getCredentialsHosts","isCorsWithCredentialsImage","proxyUrl","getApiKey","imageToBlob","getFetchImage","customFetchImage","findBlob","blobInfo","editorUpload","blobCache","getByUri","cancelTimedUpload","imageUploadTimerState","clearTimeout","updateSelectedImage","origBlob","uploadImmediately","selectedImage","size","filename","useFilename","shouldReuseFilename","add","undoManager","transact","imageLoadedHandler","$","off","nodeChanged","uploadImagesAuto","imageUploadTimer","setEditorTimeout","getUploadTimeout","startTimedUpload","on","attr","blobUri","removeAttr","selectedImageOperation","_scanForImages","imageResult","catch","flippedSize","flip","handleDialogBlob","originalSize","blobToImage","newImage","newSize","removeAttribute","setAttribute","setImageSize","makeOpen","originalImgOpt","originalSizeOpt","origImg","_","state","createState","windowManager","title","body","items","currentState","buttons","primary","disabled","onSubmit","api","getData","imagetools","originalImg","close","onCancel","onAction","details","enable","disable","lastSelectedImageState","mceImageRotateLeft","mceImageRotateRight","mceImageFlipVertical","mceImageFlipHorizontal","mceEditImage","cmd","addCommand","register$2","changeHandlers","command","execCommand","isEditableImage","onSetup","handler","setDisabled","concat","r","ui","registry","addButton","tooltip","icon","addContextMenu","update","register$1","addContextToolbar","position","register","lastSelectedImage","setup"],"sourceRoot":""}