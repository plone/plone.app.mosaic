define("mockup-registry",["jquery"],function(e,t){var n={patterns:{},warn:function(e){window.DEBUG&&n.error(e)},error:function(e){window.console&&console.warn(e)},getOptions:function(t,r,i){i=i||{},t.length!==0&&!e.nodeName(t[0],"body")&&(i=n.getOptions(t.parent(),r,i));var s={};if(t.length!==0){s=t.data("pat-"+r);if(s&&typeof s=="string"){var o={};e.each(s.split(";"),function(e,t){t=t.split(":"),t.reverse();var n=t.pop();n=n.replace(/^\s+|\s+$/g,""),t.reverse();var r=t.join(":");r=r.replace(/^\s+|\s+$/g,""),o[n]=r}),s=o}}return e.extend(!0,{},i,s)},init:function(e,r,i){var s=e.data("pattern-"+r);if(s===t&&n.patterns[r]){if(window.DEBUG)s=new n.patterns[r](e,n.getOptions(e,r,i));else try{s=new n.patterns[r](e,n.getOptions(e,r,i))}catch(o){n.error('Failed while initializing "'+r+'" pattern.');if(window.DEBUG)throw o}e.data("pattern-"+r,s)}return s},scan:function(t){var r=e(t),i=[];i=e.merge(i,r.filter('[class*="pat-"]')),i=e.merge(i,e('[class*="pat-"]',r)),e.each(i,function(t,r){r=e(r),e.each(r.attr("class").split(" "),function(e,t){t.indexOf("pat-")===0&&n.init(r,t.substr(4))})})},register:function(r){if(!r.prototype.name)return n.warn("Pattern didn't specified a name."),!1;r.prototype.jqueryPlugin===t&&(r.prototype.jqueryPlugin="pattern"+r.prototype.name.charAt(0).toUpperCase()+r.prototype.name.slice(1)),e.fn[r.prototype.jqueryPlugin]=function(i,s){return e(this).each(function(){typeof i=="object"&&(s=i,i=t);var o=e(this),u=n.init(o,r.prototype.name,s);if(i){if(u[i]===t)return n.error('Method "'+i+'" does not exists.'),!1;if(i.charAt(0)==="_")return n.warn('Method "'+i+'" is private.'),!1;u[i].apply(u,[s])}}),this},n.patterns[r.prototype.name]=r}};return n}),define("mockup-patterns-base",["jquery","mockup-registry"],function(e,t){var n=function(t,n){this.$el=t,this.options=e.extend(!0,{},this.defaults||{},n||{}),this.init(),this.trigger("init")};return n.prototype={constructor:n,on:function(e,t){this.$el.on(e+"."+this.name+".patterns",t)},trigger:function(e,t){t===undefined&&(t=[]),this.$el.trigger(e+"."+this.name+".patterns",t)}},n.extend=function(n){var r=this,i;n&&n.hasOwnProperty("constructor")?i=n.constructor:i=function(){r.apply(this,arguments)};var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,i.extend=r.extend,e.extend(!0,i.prototype,n),i.__super__=r.prototype,t.register(i),i},n}),define("mosaic.core",[],function(){(function(e){e.mosaic={loaded:!1,nrOfTiles:0,tileInitCount:0},e.mosaic.initialized=function(){if(e.mosaic.loaded)return;e.mosaic.loaded=!0,e.mosaic.undo.snapshot()},e.mosaic.init=function(t){t=e.extend({url:window.document.location.href,type:"",ignore_context:!1},t),e.mosaic.document=window.document;var n;e.mosaic.initActions(),n=t.url.match(/^([\w#!:.?+=&%@!\-\/]+)\/edit$/),n&&(t.url=n[1]),n=t.url.match(/^([\w#:.?=%@!\-\/]+)\/\+\+add\+\+([\w#!:.?+=&%@!\-\/]+)$/),n&&(t.url=n[1],t.type=n[2],t.ignore_context=!0);var r;e.mosaic.options=t.data,e.mosaic.options.url=t.url,e.mosaic.options.ignore_context=t.ignore_context,e.mosaic.options.tileheadelements=[],r=e('[name="form.widgets.ILayoutAware.content"]').val();if(r==="")return;r=e.mosaic.getDomTreeFromHtml(r),e.mosaic.options.layout=r.attr("data-layout"),e("[data-panel] [data-panel]",e.mosaic.document).removeAttr("data-panel"),r.find("[data-panel]").each(function(){var t=e(this).attr("data-panel"),n,i=e("[data-panel="+t+"]",e.mosaic.document);t==="content"&&i.length===0&&e("#"+t,e.mosaic.document).each(function(){i=e(this),i.attr("data-panel",t)}),t==="content"?(n=i.attr("id"),i.removeAttr("data-panel").removeAttr("id").addClass("mosaic-original-content").hide(),i.before(e(document.createElement("div")).attr("id",n).addClass("mosaic-panel").attr("data-panel","content").html(r.find("[data-panel="+t+"]").html()))):(i.addClass("mosaic-panel"),i.html(r.find("[data-panel="+t+"]").html()))}),e("[data-panel]",e.mosaic.document).each(function(){e(this).hasClass("mosaic-panel")||(console.log(e(this)),e(this).addClass("mosaic-panel"),e(this).children().wrap(e('<div class="mosaic-grid-row"><div class="mosaic-grid-cell mosaic-width-full mosaic-position-leftmost"><div class="movable removable mosaic-tile mosaic-text-tile"><div class="mosaic-tile-content"></div></div></div></div>')))}),e.mosaic.options.panels=e(".mosaic-panel",e.mosaic.document),e.mosaic.nrOfTiles=e.mosaic.options.panels.find("[data-tile]").size(),e.mosaic.options.panels.find("[data-tile]").each(function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;n=e(e.mosaic.document).find("head > base").attr("href"),r=e(this).attr("data-tile"),i=e(this).parent(),s="",o=i.parents(".mosaic-tile").attr("class").split(" "),e(o).each(function(){var e;e=this.match(/^mosaic-([\w.\-]+)-tile$/),e!==null&&e[1]!=="selected"&&e[1]!=="new"&&e[1]!=="read-only"&&e[1]!=="helper"&&e[1]!=="original"&&(s=e[1])});for(f=0;f<e.mosaic.options.tiles.length;f+=1){l=e.mosaic.options.tiles[f];for(c=0;c<l.tiles.length;c+=1){if(l.tiles[c].tile_type==="field"){var v=l.tiles[c].widget.split(".");v=v[v.length-1];switch(v){case"TextWidget":case"TextFieldWidget":case"TextAreaWidget":case"TextAreaFieldWidget":case"WysiwygWidget":case"WysiwygFieldWidget":l.tiles[c].settings=!1;break;default:l.tiles[c].settings=!0}}l.tiles[c].name===s&&(a=l.tiles[c])}}if(a.tile_type==="field"){h="";switch(a.widget){case"z3c.form.browser.text.TextWidget":case"z3c.form.browser.text.TextFieldWidget":h="<div>"+e("#"+a.id).find("input").attr("value")+"</div>";break;case"z3c.form.browser.textarea.TextAreaWidget":case"z3c.form.browser.textarea.TextAreaFieldWidget":p=e("#"+a.id).find("textarea").attr("value").split("\n");for(d=0;d<p.length;d+=1)h+="<div>"+p[d]+"</div>";break;case"plone.app.z3cform.wysiwyg.widget.WysiwygWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget":h=e("#"+a.id).find("textarea").attr("value");break;default:h='<div class="discreet">Placeholder for field:<br/><b>'+a.label+"</b></div>"}i.html(h)}else{u=n?[n,r].join("/").replace(/\/+\.\//g,"/"):r;if(a.name==="plone.app.standardtiles.title"||a.name==="plone.app.standardtiles.description")u+="?ignore_context="+e.mosaic.options.ignore_context;e.ajax({type:"GET",url:u,success:function(t){t=e.mosaic.getDomTreeFromHtml(t),e.mosaic.addHeadTags(r,t),i.html('<p class="hiddenStructure tileUrl">'+r+"</p>"+t.find(".temp_body_tag").html()),e.mosaic.tileInitCount+=1,e.mosaic.tileInitCount>=e.mosaic.nrOfTiles&&e.mosaic.initialized()}})}}),e("body").prepend(e(document.createElement("div")).addClass("mosaic-toolbar")),e.mosaic.options.toolbar=e(".mosaic-toolbar"),e.mosaic.options.url=t.url,e.mosaic.options.toolbar.mosaicToolbar(),e.mosaic.options.panels.mosaicLayout(),e("*",e.mosaic.document).each(function(){var t;t=e(this),t.css("display")==="block"&&!t.hasClass("mosaic-panel")&&!t.hasClass("mosaic-toolbar")&&!t.hasClass("mosaic-notifications")&&t.attr("id")!=="plone-cmsui-menu"&&t.parents(".mosaic-panel, .mosaic-toolbar").length===0&&t.find(".mosaic-panel, .mosaic-toolbar").length===0&&t.parent().find(".mosaic-panel, .mosaic-toolbar").length!==0&&t.addClass("mosaic-blur")}),e.mosaic.undo.init()},e.mosaic.getDomTreeFromHtml=function(t){return t=t.replace(/<!DOCTYPE[\w\s\- .\/\":]+>/,""),t=t.replace(/<html/,'<div class="temp_html_tag"'),t=t.replace(/<\/html/,"</div"),t=t.replace(/<head/,'<div class="temp_head_tag"'),t=t.replace(/<\/head/,"</div"),t=t.replace(/<body/,'<div class="temp_body_tag"'),t=t.replace(/<\/body/,"</div"),e(e(t)[0])},e.mosaic.removeHeadTags=function(t){var n,r,i,s;t=t.split("?")[0],t=t.split("@@"),n=t[1].split("/"),t=t[0]+"@@delete-tile?type="+n[0]+"&id="+n[1]+"&confirm=true",r=n[0].replace(/\./g,"-")+"-"+n[1],i=e.mosaic.options.tileheadelements[r];for(s=0;s<i.length;s+=1)e(i[s],e.mosaic.document).remove();e.mosaic.options.tileheadelements[r]=[]},e.mosaic.addHeadTags=function(t,n){var r,i;t=t.split("?")[0],t=t.split("@@"),r=t[1].split("/"),i=r[0].replace(/\./g,"-")+"-"+r[1],e.mosaic.options.tileheadelements[i]=[],n.find(".temp_head_tag").children().each(function(){e.mosaic.options.tileheadelements[i].push(this),e("head",e.mosaic.document).append(this)})}})(jQuery)}),define("mosaic.layout",["mosaic.core"],function(){(function(e){function t(e){switch(e){case 25:return"mosaic-width-quarter";case 33:return"mosaic-width-third";case 50:return"mosaic-width-half";case 66:case 67:return"mosaic-width-two-thirds";case 75:return"mosaic-width-three-quarters";case 100:return"mosaic-width-full"}return"mosaic-width-full"}function n(e){switch(e){case 0:return"mosaic-position-leftmost";case 25:return"mosaic-position-quarter";case 33:return"mosaic-position-third";case 50:return"mosaic-position-half";case 66:case 67:return"mosaic-position-two-thirds";case 75:return"mosaic-position-three-quarters"}return"mosaic-position-leftmost"}typeof e.mosaic=="undefined"&&(e.mosaic={}),e.mosaic.layout={widthClasses:["mosaic-width-quarter","mosaic-width-third","mosaic-width-half","mosaic-width-two-thirds","mosaic-width-three-quarters","mosaic-width-full"],positionClasses:["mosaic-position-leftmost","mosaic-position-quarter","mosaic-position-third","mosaic-position-half","mosaic-position-two-thirds","mosaic-position-three-quarters"]},e.fn.mosaicLayout=function(){var r=function(t){if(t.keyCode===27){var n=e(".mosaic-original-tile",e.mosaic.document);n.length>0?n.each(function(){e(this).addClass("mosaic-drag-cancel"),e(this).hasClass("mosaic-helper-tile-new")?e(document).trigger("mousedown"):e(document).trigger("mouseup")}):(e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").blur(),e.mosaic.options.toolbar.trigger("selectedtilechange"),e.mosaic.options.panels.mosaicSetResizeHandleLocation()),e(".mosaic-resize-handle-helper",e.mosaic.document).each(function(){e(this).parents("[data-panel]").removeClass("mosaic-panel-resizing"),e(this).parent().removeClass("mosaic-row-resizing"),e(this).parent().children(".mosaic-resize-placeholder").remove(),e(this).remove()}),e.mosaic.overlay.hide()}};e(e.mosaic.document).bind("keydown",r);var i=function(t){var n;t.target?n=t.target:t.srcElement&&(n=t.srcElement),e(n).parents(".mosaic-tile").length===0&&e(n).parents(".mosaic-toolbar").length===0&&(e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").blur(),e.mosaic.options.toolbar.trigger("selectedtilechange"),e.mosaic.options.panels.mosaicSetResizeHandleLocation());var r=e(".mosaic-helper-tile-new",e.mosaic.document);r.length>0&&r.each(function(){e(this).mosaicHandleDragEnd()})};e(e.mosaic.document).bind("mousedown",i);var s=function(r){e(".mosaic-helper-tile-new",e.mosaic.document).each(function(){var t=e(this).parent().offset();e(this).css("top",r.pageY+3-t.top),e(this).css("left",r.pageX+3-t.left)}),e(".mosaic-resize-handle-helper",e.mosaic.document).each(function(){var i,s,o=e(this),u=o.parent(),a=parseFloat(r.pageX-u.offset().left-4),f=a/o.data("row_width")*100,l=25,c=1e3;e([25,33,50,67,75]).each(function(){s=Math.abs(this-f),s<c&&(l=this,c=s)});if(o.data("nr_of_columns")===2)o.data("column_sizes").split(" ")[0]!==l&&(u.children(".mosaic-resize-placeholder").each(function(r){r===0?e(this).removeClass(e.mosaic.layout.widthClasses.join(" ")).addClass(t(parseInt(l,10))):(e(this).removeClass(e.mosaic.layout.positionClasses.join(" ").replace(/position/g,"resize")).removeClass(e.mosaic.layout.widthClasses.join(" ")).addClass(t(parseInt(100-l,10))).addClass(n(parseInt(l,10)).replace("position","resize")),o.removeClass(e.mosaic.layout.positionClasses.join(" ").replace(/position/g,"resize")).addClass(n(parseInt(l,10)).replace("position","resize")))}),e(this).data("column_sizes",l+" "+(100-l)));else{var h=e(this).data("resize_handle_index");if(h===1){if(o.data("column_sizes").split(" ")[e(this).data("resize_handle_index")-1]!==l&&parseInt(l,10)<=50){i=u.children(".mosaic-resize-placeholder"),i.removeClass(e.mosaic.layout.positionClasses.join(" ").replace(/position/g,"resize")).removeClass(e.mosaic.layout.widthClasses.join(" ")),o.removeClass(e.mosaic.layout.positionClasses.join(" ").replace(/position/g,"resize")).addClass(n(parseInt(l,10)).replace("position","resize"));switch(parseInt(l,10)){case 25:e(i.get(0)).addClass(n(0).replace("position","resize")+" "+t(25)),e(i.get(1)).addClass(n(25).replace("position","resize")+" "+t(50)),e(i.get(2)).addClass(n(75).replace("position","resize")+" "+t(25)),o.data("column_sizes","25 50 25");break;case 33:e(i.get(0)).addClass(n(0).replace("position","resize")+" "+t(33)),e(i.get(1)).addClass(n(33).replace("position","resize")+" "+t(33)),e(i.get(2)).addClass(n(66).replace("position","resize")+" "+t(33)),o.data("column_sizes","33 33 33");break;case 50:e(i.get(0)).addClass(n(0).replace("position","resize")+" "+t(50)),e(i.get(1)).addClass(n(50).replace("position","resize")+" "+t(25)),e(i.get(2)).addClass(n(75).replace("position","resize")+" "+t(25)),o.data("column_sizes","50 25 25")}}}else if(o.data("column_sizes").split(" ")[e(this).data("resize_handle_index")]!==100-l&&parseInt(l,10)>=50){i=u.children(".mosaic-resize-placeholder"),i.removeClass(e.mosaic.layout.positionClasses.join(" ").replace(/position/g,"resize")).removeClass(e.mosaic.layout.widthClasses.join(" ")),o.removeClass(e.mosaic.layout.positionClasses.join(" ").replace(/position/g,"resize")).addClass(n(parseInt(l,10)).replace("position","resize"));switch(parseInt(l,10)){case 50:e(i.get(0)).addClass(n(0).replace("position","resize")+" "+t(25)),e(i.get(1)).addClass(n(25).replace("position","resize")+" "+t(25)),e(i.get(2)).addClass(n(50).replace("position","resize")+" "+t(50)),o.data("column_sizes","25 25 50");break;case 66:case 67:e(i.get(0)).addClass(n(0).replace("position","resize")+" "+t(33)),e(i.get(1)).addClass(n(33).replace("position","resize")+" "+t(33)),e(i.get(2)).addClass(n(66).replace("position","resize")+" "+t(33)),o.data("column_sizes","33 33 33");break;case 75:e(i.get(0)).addClass(n(0).replace("position","resize")+" "+t(25)),e(i.get(1)).addClass(n(25).replace("position","resize")+" "+t(50)),e(i.get(2)).addClass(n(75).replace("position","resize")+" "+t(25)),o.data("column_sizes","25 50 25")}}}})};e(e.mosaic.document).bind("mousemove",s),e(e.mosaic.document).bind("dragover",s);var o=function(r){e(".mosaic-resize-handle-helper",e.mosaic.document).each(function(){var r=e(this).parents("[data-panel]"),i=e(this).data("column_sizes").split(" ");e(this).parent().children(".mosaic-grid-cell").each(function(r){var s=0;for(var o=0;o<r;o+=1)s+=parseInt(i[o],10);e(this).removeClass(e.mosaic.layout.positionClasses.join(" ")).removeClass(e.mosaic.layout.widthClasses.join(" ")).addClass(n(s)+" "+t(parseInt(i[r],10)))}),r.removeClass("mosaic-panel-resizing"),e(this).parent().removeClass("mosaic-row-resizing"),e(this).parent().children(".mosaic-resize-placeholder").remove(),e(this).parent().mosaicSetResizeHandles(),r.mosaicSetResizeHandleLocation(),r.find(".mosaic-selected-tile").mosaicFocusTileContent(),e(this).remove()})};e(e.mosaic.document).bind("mouseup",o);var u=function(t){if(e(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")){e(".mosaic-selected-divider",e.mosaic.document).removeClass("mosaic-selected-divider");if(e(this).hasClass("mosaic-original-tile")===!1&&e(this).hasClass("mosaic-tile-align-left")===!1&&e(this).hasClass("mosaic-tile-align-right")===!1){var n=e(this).mosaicGetDirection(t),r=e(this).children(".mosaic-divider-"+n);if(n==="left"||n==="right"){var i=r.parent().parent().parent();i.children(".mosaic-grid-cell").length>1?(r.height(i.height()+5),r.css("top",i.offset().top-r.parent().offset().top-5)):(r.height(r.parent().height()+5),r.css("top",-5))}r.addClass("mosaic-selected-divider")}}};e(".mosaic-tile",e.mosaic.document).on("mousemove",u),e(".mosaic-tile",e.mosaic.document).on("dragover",u),e(".mosaic-tile",e.mosaic.document).on("click",function(){e(this).mosaicSelectTile()}),e(".mosaic-close-icon",e.mosaic.document).on("click",function(){var t=e(this).parents(".mosaic-tile").mosaicGetTileConfig();if(t.tile_type==="app"){var n=e(this).parents(".mosaic-tile").find(".tileUrl").html();e.mosaic.removeHeadTags(n);var r=n.split("?")[0];r=r.split("@@");var i=r[1].split("/");r=r[0]+"@@delete-tile?type="+i[0]+"&id="+i[1]+"&confirm=true",e.ajax({type:"GET",url:r,success:function(e){}})}e.mosaic.options.panels.find(".mosaic-empty-row").remove();var s=e(this).parents(".mosaic-tile").parent().parent();e.mosaic.saveTileValueToForm(t.name,t),e(this).parent().remove(),e.mosaic.undo.snapshot(),s.mosaicCleanupRow(),e.mosaic.options.panels.mosaicAddEmptyRows(),e.mosaic.options.toolbar.trigger("selectedtilechange"),e.mosaic.options.toolbar.mosaicSetResizeHandleLocation()}),e(".mosaic-info-icon",e.mosaic.document).on("click",function(){var t=e(this).parents(".mosaic-tile").mosaicGetTileConfig();if(t.tile_type==="app"){var n=e(this).parents(".mosaic-tile").find(".tileUrl").html();if(n.indexOf("?")!=-1){var r=n.split("?"),i=r[0],s=r[1];s=s.split("&");for(var o=0;o<s.length;o+=1)s[o]='"'+s[o].replace("=",'":"')+'"';n=i+"?_tiledata={"+s.join(",")+"}"}n=n.replace(/@@/,"@@edit-tile/"),e.mosaic.overlay.openIframe(n)}else e.mosaic.overlay.open("field",t)});var a=this.length;return this.each(function(t){var n=e(this);n.find(".mosaic-tile").mosaicInitTile(),n.find(".mosaic-tile").mosaicAddDrag(),n.mosaicAddEmptyRows(),n.children(".mosaic-grid-row").mosaicSetResizeHandles();if(t===a-1){var r=0,i=0;e.mosaic.options.panels.each(function(t){e(this).width()>r&&(r=e(this).width(),i=t)}),e.mosaic.options.panels.eq(i).find(".mosaic-tile:first").mosaicSelectTile()}})},e.fn.mosaicInitTile=function(){return this.each(function(){var t=e(this),n=t.parents("[data-panel]"),r=e(this).mosaicGetTileConfig();r&&r.read_only&&e(this).addClass("mosaic-read-only-tile"),r&&(r.tile_type==="text"&&r.rich_text||r.tile_type==="app"&&r.rich_text||r.tile_type==="field"&&r.read_only===!1&&(r.widget==="z3c.form.browser.text.TextWidget"||r.widget==="z3c.form.browser.text.TextFieldWidget"||r.widget==="z3c.form.browser.textarea.TextAreaWidget"||r.widget==="z3c.form.browser.textarea.TextAreaFieldWidget"||r.widget==="plone.app.z3cform.wysiwyg.widget.WysiwygWidget"||r.widget==="plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget"||r.widget==="plone.app.widgets.dx.RichTextWidget"))&&e(this).children(".mosaic-tile-content").mosaicEditor(),e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-outer-border").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-inner-border"))),r&&r.tile_type==="field"&&e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-control mosaic-field-label").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-field-label-content").html(r.label)).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-field-label-left"))),e(this).hasClass("movable")&&e.mosaic.options.can_change_layout&&e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-control mosaic-drag-handle")),e(this).hasClass("removable")&&e.mosaic.options.can_change_layout&&e(this).prepend('<div class="mosaic-tile-control mosaic-close-icon"></div>'),r&&r.settings&&e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-control mosaic-info-icon")),e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider mosaic-divider-top").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider-dot"))),e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider mosaic-divider-bottom").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider-dot"))),e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider mosaic-divider-right").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider-dot"))),e(this).prepend(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider mosaic-divider-left").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider-dot")))})},e.fn.mosaicSelectTile=function(){return this.each(function(){e(this).hasClass("mosaic-selected-tile")===!1&&(e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").blur(),e(this).addClass("mosaic-selected-tile"),e.mosaic.options.toolbar.trigger("selectedtilechange"),e.mosaic.options.panels.mosaicSetResizeHandleLocation(),e(this).mosaicFocusTileContent())})},e.fn.mosaicFocusTileContent=function(){return this.each(function(){var t=e(this).children(".mosaic-tile-content");t.focus(),t.hasClass("mosaic-rich-text")&&(tinyMCE.activeEditor.selection.select(tinyMCE.activeEditor.getBody(),!0),tinyMCE.activeEditor.selection.collapse(!1))})},e.fn.mosaicAddMouseMoveEmptyRow=function(){return this.each(function(){e(this).mousemove(function(t){var n=e(this).parents("[data-panel]");n.hasClass("mosaic-panel-dragging")&&(e(".mosaic-selected-divider",e.mosaic.document).removeClass("mosaic-selected-divider"),e(this).children("div").addClass("mosaic-selected-divider"))})})},e.fn.mosaicAddEmptyRows=function(){return this.each(function(){e(this).find(".mosaic-grid-row").each(function(t){e(this).children(".mosaic-grid-cell").length>1&&(t===0&&e(this).before(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-full mosaic-position-leftmost").append(e(e.mosaic.document.createElement("div")).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-outer-border").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow()),(e(this).nextAll(".mosaic-grid-row").length===0||e(this).next().children(".mosaic-grid-cell").length>1)&&e(this).after(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-full mosaic-position-leftmost").append(e(e.mosaic.document.createElement("div")).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-outer-border").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow()))})})},e.fn.mosaicGetWidthClass=function(){var t;for(t in e.mosaic.layout.widthClasses)if(e.mosaic.layout.widthClasses.hasOwnProperty(t)&&e(this).hasClass(e.mosaic.layout.widthClasses[t]))return e.mosaic.layout.widthClasses[t];for(t in e.mosaic.layout.widthClasses)if(e.mosaic.layout.widthClasses.hasOwnProperty(t)&&e(this).hasClass(e.mosaic.layout.widthClasses[t].replace("position","resize")))return e.mosaic.layout.widthClasses[t];return e.mosaic.layout.widthClasses[0]},e.fn.mosaicGetPositionClass=function(){var t;for(t in e.mosaic.layout.positionClasses)if(e(this).hasClass(e.mosaic.layout.positionClasses[t]))return e.mosaic.layout.positionClasses[t];for(t in e.mosaic.layout.positionClasses)if(e(this).hasClass(e.mosaic.layout.positionClasses[t].replace("position","resize")))return e.mosaic.layout.positionClasses[t];return e.mosaic.layout.positionClasses[0]},e.fn.mosaicAddDrag=function(){return this.each(function(){var t=e(this),n=function(t){var n=e(".mosaic-helper-tile",e.mosaic.document),r=n.parents("[data-panel]").offset();n.css("top",t.pageY+3-r.top),n.css("left",t.pageX+3-r.left)},r=function(){var t=e(".mosaic-helper-tile",e.mosaic.document);e(e.mosaic.document).unbind("mousemove",n).unbind("mouseup",r),t.mosaicHandleDragEnd(),t.remove()};return t.each(function(){t.find("div.mosaic-drag-handle").unbind("mousedown").bind("mousedown",function(t){var i=t.pageX,s=t.pageY,o=function(t){if(Math.max(Math.abs(i-t.pageX),Math.abs(s-t.pageY))>=1){e.mosaic.options.panels.addClass("mosaic-panel-dragging"),e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").blur();var u=e(t.target).parents(".mosaic-tile"),a=u.clone(!0);u.addClass("mosaic-original-tile"),u.parents("[data-panel]").append(a),a.css({width:u.width(),position:"absolute",opacity:.5}).addClass("mosaic-helper-tile"),e(e.mosaic.document).mousemove(n),e(e.mosaic.document).mouseup(r),e(e.mosaic.document).unbind("mousemove",o)}};e(e.mosaic.document).bind("mousemove",o),e(e.mosaic.document).bind("mouseup",function(){e(e.mosaic.document).unbind("mousemove",o)})})})})},e.fn.mosaicHandleDragEnd=function(){var t=e(this).parents("[data-panel]");e.mosaic.options.panels.removeClass("mosaic-panel-dragging mosaic-panel-dragging-new");var n=e(".mosaic-selected-divider",e.mosaic.document),r=n.parent(),i="";n.hasClass("mosaic-divider-top")&&(i="top"),n.hasClass("mosaic-divider-bottom")&&(i="bottom"),n.hasClass("mosaic-divider-left")&&(i="left"),n.hasClass("mosaic-divider-right")&&(i="right"),n.removeClass("mosaic-selected-divider");var s=e(".mosaic-helper-tile-new",e.mosaic.document).length>0,o=e(".mosaic-original-tile",e.mosaic.document);if(o.hasClass("mosaic-drag-cancel"))o.removeClass("mosaic-drag-cancel"),e.mosaic.options.panels.find(".mosaic-empty-row").remove(),s||o.removeClass("mosaic-original-tile").addClass("mosaic-new-tile");else if(r.hasClass("mosaic-empty-row"))r.removeClass("mosaic-empty-row").unbind("mousemove"),r.children(".mosaic-grid-cell").children("div").remove(),r.children(".mosaic-grid-cell").append(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile")),e(".mosaic-empty-row",e.mosaic.document).remove();else if(r.hasClass("mosaic-tile")===!1)e(".mosaic-empty-row",e.mosaic.document).remove(),s||o.removeClass("mosaic-original-tile").addClass("mosaic-new-tile");else if(r.parent().parent().children(".mosaic-grid-cell").length!==4||i!=="left"&&i!=="right"){e(".mosaic-empty-row",e.mosaic.document).remove();if(i==="top")r.before(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"));else if(i==="bottom")r.after(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"));else if(i==="left"||i==="right")if(r.parent().parent().children(".mosaic-grid-cell").length===1){var u=r.prevAll();u.length>0&&(r.parent().parent().before(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-row").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-full mosaic-position-leftmost").append(e(u.get().reverse()).clone(!0).mosaicAddDrag()))),u.remove());var a=r.nextAll();a.length>0&&(r.parent().parent().after(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-row").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-full mosaic-position-leftmost").append(a.clone(!0).mosaicAddDrag()))),a.remove()),r.parent().removeClass(e.mosaic.layout.widthClasses.join(" ")).removeClass(e.mosaic.layout.positionClasses.join(" ")).addClass("mosaic-width-half"),i==="left"?r.parent().addClass("mosaic-position-half").before(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-half mosaic-position-leftmost").append(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))):r.parent().addClass("mosaic-position-leftmost").after(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-half mosaic-position-half").append(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))),r.parent().parent().mosaicSetResizeHandles()}else i==="left"?r.parent().before(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell").append(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))):r.parent().after(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell").append(o.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))),r.parent().parent().mosaicSetColumnSizes(),r.parent().parent().mosaicSetResizeHandles()}else e(".mosaic-empty-row",e.mosaic.document).remove(),s||o.removeClass("mosaic-original-tile").addClass("mosaic-new-tile"),e.plone.notify({title:"Info",message:"You can't have more then 4 columns",sticky:!1});var f=o.parent().parent();e(".mosaic-original-tile",e.mosaic.document).remove(),f.mosaicCleanupRow(),e.mosaic.options.panels.mosaicAddEmptyRows(),s?e(".mosaic-new-tile",e.mosaic.document).removeClass("mosaic-new-tile").mosaicSelectTile():e(".mosaic-new-tile",e.mosaic.document).removeClass("mosaic-new-tile")},e.fn.mosaicSetColumnSizes=function(){return this.each(function(){var t=e(this).children(".mosaic-grid-cell").length;e(this).children(".mosaic-grid-cell").each(function(n){e(this).removeClass(e.mosaic.layout.widthClasses.join(" ")).removeClass(e.mosaic.layout.positionClasses.join(" "));switch(t){case 1:e(this).addClass("mosaic-width-full mosaic-position-leftmost");break;case 2:switch(n){case 0:e(this).addClass("mosaic-width-half mosaic-position-leftmost");break;case 1:e(this).addClass("mosaic-width-half mosaic-position-half")}break;case 3:switch(n){case 0:e(this).addClass("mosaic-width-third mosaic-position-leftmost");break;case 1:e(this).addClass("mosaic-width-third mosaic-position-third");break;case 2:e(this).addClass("mosaic-width-third mosaic-position-two-thirds")}break;case 4:switch(n){case 0:e(this).addClass("mosaic-width-quarter mosaic-position-leftmost");break;case 1:e(this).addClass("mosaic-width-quarter mosaic-position-quarter");break;case 2:e(this).addClass("mosaic-width-quarter mosaic-position-half");break;case 3:e(this).addClass("mosaic-width-quarter mosaic-position-three-quarters")}}})})},e.fn.mosaicSetResizeHandles=function(){return this.each(function(){e(this).children(".mosaic-resize-handle").remove();var t=e(this).children(".mosaic-grid-cell").length;switch(t){case 2:e(this).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-center mosaic-resize-handle-one "+e(e(this).children(".mosaic-grid-cell").get(1)).mosaicGetPositionClass().replace("position","resize")));break;case 3:e(this).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-center mosaic-resize-handle-one "+e(e(this).children(".mosaic-grid-cell").get(1)).mosaicGetPositionClass().replace("position","resize"))),e(this).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-center mosaic-resize-handle-two "+e(e(this).children(".mosaic-grid-cell").get(2)).mosaicGetPositionClass().replace("position","resize")))}e(this).children(".mosaic-resize-handle").mousedown(function(t){var n=[];e(this).parent().children(".mosaic-grid-cell").each(function(){switch(e(this).mosaicGetWidthClass()){case"mosaic-width-half":n.push("50");break;case"mosaic-width-quarter":n.push("25");break;case"mosaic-width-third":n.push("33");break;case"mosaic-width-two-thirds":n.push("66");break;case"mosaic-width-three-quarters":n.push("75")}e(this).parent().append(e(e.mosaic.document.createElement("div")).addClass("mosaic-resize-placeholder "+e(this).mosaicGetWidthClass()+" "+e(this).mosaicGetPositionClass().replace("position","resize")).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-resize-placeholder-inner-border")))});var r=1;return e(this).hasClass("mosaic-resize-handle-two")&&(r=2),e(this).parent().append(e(e.mosaic.document.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-helper").addClass(e(this).mosaicGetPositionClass().replace("position","resize")).data("row_width",e(this).parent().width()).data("nr_of_columns",e(this).parent().children(".mosaic-grid-cell").length).data("column_sizes",n.join(" ")).data("resize_handle_index",r)),e(this).parents("[data-panel]").addClass("mosaic-panel-resizing"),e(this).parent().addClass("mosaic-row-resizing"),e(".mosaic-selected-tile",e.mosaic.document).children(".mosaic-tile-content").blur(),!1})})},e.fn.mosaicCleanupRow=function(){return this.each(function(){var t=e(this);t.children(".mosaic-grid-cell").each(function(){e(this).children().length===0&&(e(this).remove(),t.mosaicSetColumnSizes())});if(t.find(".mosaic-tile").length===0){var n=t;if(t.nextAll(".mosaic-grid-row").length>0)t=t.next(".mosaic-grid-row");else{if(!(t.prevAll(".mosaic-grid-row").length>0)){t.remove();return}t=t.prev(".mosaic-grid-row")}n.remove()}t.prevAll(".mosaic-grid-row").length>0&&t.children(".mosaic-grid-cell").length===1&&t.prev().children(".mosaic-grid-cell").length===1&&(t.children(".mosaic-grid-cell").prepend(t.prev().children(".mosaic-grid-cell").children(".mosaic-tile").clone(!0).mosaicAddDrag()),t.prev().remove()),t.nextAll(".mosaic-grid-row").length>0&&t.children(".mosaic-grid-cell").length===1&&t.next().children(".mosaic-grid-cell").length===1&&(t.children(".mosaic-grid-cell").append(t.next().children(".mosaic-grid-cell").children(".mosaic-tile").clone(!0).mosaicAddDrag()),t.next().remove()),t.mosaicSetResizeHandles()})},e.fn.mosaicSetResizeHandleLocation=function(){var t=e(this);t.children(".mosaic-grid-row").each(function(){var t=e(this),n=t.children(".mosaic-grid-cell");if(n.length===2||n.length===3)t.children(".mosaic-resize-handle").removeClass("mosaic-resize-handle-left mosaic-resize-handle-center mosaic-resize-handle-right"),e(n.get(0)).children(".mosaic-tile").hasClass("mosaic-selected-tile")?(t.children(".mosaic-resize-handle-one").addClass("mosaic-resize-handle-left"),t.children(".mosaic-resize-handle-two").addClass("mosaic-resize-handle-center")):e(n.get(1)).children(".mosaic-tile").hasClass("mosaic-selected-tile")?(t.children(".mosaic-resize-handle-one").addClass("mosaic-resize-handle-right"),t.children(".mosaic-resize-handle-two").addClass("mosaic-resize-handle-left")):n.length===3&&e(n.get(2)).children(".mosaic-tile").hasClass("mosaic-selected-tile")?(t.children(".mosaic-resize-handle-one").addClass("mosaic-resize-handle-center"),t.children(".mosaic-resize-handle-two").addClass("mosaic-resize-handle-right")):(t.children(".mosaic-resize-handle-one").addClass("mosaic-resize-handle-center"),t.children(".mosaic-resize-handle-two").addClass("mosaic-resize-handle-center"))})},e.fn.mosaicGetTileConfig=function(){var t="",n=e(this).attr("class").split(" ");e(n).each(function(){var e=this.match(/^mosaic-(.*)-tile$/);e!==null&&e[1]!=="selected"&&e[1]!=="new"&&e[1]!=="read-only"&&e[1]!=="helper"&&e[1]!=="original"&&(t=e[1])});var r;for(var i=0;i<e.mosaic.options.tiles.length;i+=1){var s=e.mosaic.options.tiles[i];for(var o=0;o<s.tiles.length;o+=1)s.tiles[o].name===t&&(r=s.tiles[o])}return r},e.fn.mosaicGetDirection=function(t){var n=parseFloat(e(this).width()),r=parseFloat(e(this).height()),i=parseFloat(t.pageX-e(this).offset().left-n/2),s=parseFloat(t.pageY-e(this).offset().top-r/2),o=n/2,u=r/2;return i<0?s<0?i/s<-1*o/(-1*u)?"top":"left":i/s<-1*o/u?"left":"bottom":s<0?i/s<1*o/(-1*u)?"right":"top":i/s<o/u?"bottom":"right"},e.mosaic.disableEditHtmlSource=function(){e(".mosaic-rich-text-textarea",e.mosaic.document).each(function(){var t,n;n=e(this).val(),t=e(this).parent(),t.html(n).mosaicEditor()})},e.mosaic.addAppTile=function(t,n,r){e.mosaic.overlay.hide(),e.ajax({type:"GET",url:n,success:function(r){r=e.mosaic.getDomTreeFromHtml(r),e.mosaic.addHeadTags(n,r),e.mosaic.addTile(t,'<p class="hiddenStructure tileUrl">'+n+"</p>"+r.find(".temp_body_tag").html())}})},e.mosaic.addAppTileHTML=function(t,n,r){var i;e.mosaic.overlay.hide(),e.mosaic.overlay=null,i=e.mosaic.getDomTreeFromHtml(n),e.mosaic.addHeadTags(r,i),e.mosaic.addTile(t,'<p class="hiddenStructure tileUrl">'+r+"</p>"+i.find(".temp_body_tag").html())},e.mosaic.editAppTile=function(t){e.mosaic.overlay.close(),window.parent.focus(),e.ajax({type:"GET",url:t,success:function(n){n=e.mosaic.getDomTreeFromHtml(n),e.mosaic.removeHeadTags(t),e.mosaic.addHeadTags(t,n),e(".mosaic-selected-tile .mosaic-tile-content",e.mosaic.document).html('<p class="hiddenStructure tileUrl">'+t+"</p>"+n.find(".temp_body_tag").html())}})},e.mosaic.addTile=function(t,n){e.mosaic.options.panels.addClass("mosaic-panel-dragging mosaic-panel-dragging-new"),e(e.mosaic.options.panels.get(0)).append(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-row").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-grid-cell mosaic-width-half mosaic-position-leftmost").append(e(e.mosaic.document.createElement("div")).addClass("movable removable mosaic-tile mosaic-"+t+"-tile").append(e(e.mosaic.document.createElement("div")).addClass("mosaic-tile-content").html(n)).addClass("mosaic-helper-tile mosaic-helper-tile-new mosaic-original-tile"))));var r=e.mosaic.options.panels.find(".mosaic-helper-tile-new"),i=0;e.mosaic.options.panels.each(function(){e(this).width()>i&&(i=e(this).width())}),r.width()<i/4?r.width(i/4):r.width(r.width()),r.mosaicInitTile()},e.mosaic.getDefaultValue=function(t){switch(t.tile_type){case"field":switch(t.widget){case"z3c.form.browser.text.TextWidget":case"z3c.form.browser.text.TextFieldWidget":return"<div>"+e("#"+t.id,e.mosaic.document).find("input").attr("value")+"</div>";case"z3c.form.browser.textarea.TextAreaWidget":case"z3c.form.browser.textarea.TextAreaFieldWidget":var n=e("#"+t.id,e.mosaic.document).find("textarea").attr("value").split("\n"),r="";for(var i=0;i<n.length;i+=1)r+="<div>"+n[i]+"</div>";return r;case"plone.app.z3cform.wysiwyg.widget.WysiwygWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget":case"plone.app.widgets.dx.RichTextWidget":return e("#"+t.id,e.mosaic.document).find("textarea").attr("value");default:return'<div class="discreet">Placeholder for field:<br/><b>'+t.label+"</b></div>"}break;default:return t.default_value}},e.mosaic.saveTileValueToForm=function(t,n){if(n&&n.tile_type==="field"&&n.read_only===!1&&(n.widget==="z3c.form.browser.text.TextWidget"||n.widget==="z3c.form.browser.text.TextFieldWidget"||n.widget==="z3c.form.browser.textarea.TextAreaWidget"||n.widget==="z3c.form.browser.textarea.TextAreaFieldWidget"||n.widget==="plone.app.z3cform.wysiwyg.widget.WysiwygWidget"||n.widget==="plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget"||n.widget==="plone.app.widgets.dx.RichTextWidget"))switch(n.widget){case"z3c.form.browser.text.TextWidget":case"z3c.form.browser.text.TextFieldWidget":e("#"+n.id).find("input").attr("value",e(".mosaic-"+t+"-tile",e.mosaic.document).find(".mosaic-tile-content > *").html());break;case"z3c.form.browser.textarea.TextAreaWidget":case"z3c.form.browser.textarea.TextAreaFieldWidget":var r="";e(".mosaic-"+t+"-tile",e.mosaic.document).find(".mosaic-tile-content > *").each(function(){r+=e(this).html()+"\n"}),r=r.replace(/<br[^>]*>/ig,"\n"),e("#"+n.id).find("textarea").attr("value",r);break;case"plone.app.z3cform.wysiwyg.widget.WysiwygWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget":case"plone.app.widgets.dx.RichTextWidget":e(document.getElementById(n.id)).find("textarea").attr("value",e(".mosaic-"+t+"-tile",e.mosaic.document).find(".mosaic-tile-content").html())}},e.mosaic.getPageContent=function(){var t,n="",r=0,i="";return e.mosaic.disableEditHtmlSource(),n+="  <body>\n",e("[data-panel]",e.mosaic.document).each(function(){i=e(this).attr("data-panel"),n+='    <div data-panel="'+i+'">\n',e(this).children(".mosaic-grid-row").each(function(){e(this).hasClass("mosaic-empty-row")===!1&&(n+='      <div class="mosaic-grid-row">\n',e(this).children(".mosaic-grid-cell").each(function(){n+='        <div class="'+e(this).attr("class")+'">\n',e(this).children(".mosaic-tile").each(function(){var t="",r=e(this).attr("class").split(" ");e(r).each(function(){var e=this.match(/^mosaic-(.*)-tile$/);e!==null&&e[1]!=="selected"&&e[1]!=="new"&&e[1]!=="read-only"&&e[1]!=="helper"&&e[1]!=="original"&&(t=e[1])});var i;for(var s=0;s<e.mosaic.options.tiles.length;s+=1){var o=e.mosaic.options.tiles[s];for(var u=0;u<o.tiles.length;u+=1)o.tiles[u].name===t&&(i=o.tiles[u])}var a;switch(i.tile_type){case"text":n+='          <div class="'+e(this).attr("class")+'">\n',n+='          <div class="mosaic-tile-content">\n',n+=e(this).children(".mosaic-tile-content").html(),n+="          </div>\n",n+="          </div>\n";break;case"app":n+='          <div class="'+e(this).attr("class")+'">\n',n+='          <div class="mosaic-tile-content">\n',a=e(this).find(".tileUrl").html();if(a===null)break;n+='          <div data-tile="'+a+'"></div>\n',n+="          </div>\n",n+="          </div>\n",i.name==="plone.app.standardtiles.title"&&(e(".mosaic-plone\\.app\\.standardtiles\\.title-tile .mosaic-tile-content .hiddenStructure",e.mosaic.document).remove(),e("#formfield-form-widgets-IDublinCore-title").find("input").attr("value",e.trim(e(".mosaic-plone\\.app\\.standardtiles\\.title-tile .mosaic-tile-content",e.mosaic.document).text()))),i.name==="plone.app.standardtiles.description"&&(e(".mosaic-plone\\.app\\.standardtiles\\.description-tile .mosaic-tile-content .hiddenStructure",e.mosaic.document).remove(),e("#formfield-form-widgets-IDublinCore-description").find("textarea").attr("value",e.trim(e(".mosaic-plone\\.app\\.standardtiles\\.description-tile .mosaic-tile-content",e.mosaic.document).text())));break;case"field":n+='          <div class="'+e(this).attr("class")+'">\n',n+='          <div class="mosaic-tile-content">\n',a="./@@plone.app.standardtiles.field?field="+t,n+='          <div data-tile="'+a+'"></div>\n',n+="          </div>\n",n+="          </div>\n",e.mosaic.saveTileValueToForm(t,i)}}),n+="        </div>\n"}),n+="      </div>\n")}),n+="    </div>\n"}),n+="  </body>\n",t='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-layout="'+e.mosaic.options.layout+'">\n',t+=n,t+="</html>\n",t}})(jQuery)}),define("mosaic.toolbar",["mosaic.core"],function(){(function(e){function t(t,n){typeof n.menu!==undefined&&n.menu?n.icon?t.append(e(document.createElement("label")).addClass("mosaic-icon-menu mosaic-icon-menu-"+n.name.replace(/_/g,"-")+" mosaic-icon").html(n.label).attr("title",n.label).append(e(document.createElement("select")).addClass("mosaic-menu-"+n.name.replace(/_/g,"-")).data("action",n.action).change(function(){e(this).mosaicExecAction()}).each(function(){var t,r,i;for(t in n.items)if(n.items[t].items!==undefined){e(this).append(e(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+n.items[t].value.replace(/_/g,"-").replace(/\//g,"-")).attr("label",n.items[t].label)),r=e(this).find(".mosaic-option-group-"+n.items[t].value.replace(/_/g,"-").replace(/\//g,"-"));for(i in n.items[t].items)r.append(e(document.createElement("option")).attr("value",n.items[t].items[i].value).addClass("mosaic-option mosaic-option-"+n.items[t].items[i].value.replace(/\//g,"-")).html(n.items[t].items[i].label))}else e(this).append(e(document.createElement("option")).attr("value",n.items[t].value).addClass("mosaic-option mosaic-option-"+n.items[t].value.replace(/\//g,"-")).html(n.items[t].label))}))):t.append(e(document.createElement("select")).addClass("mosaic-menu mosaic-menu-"+n.name.replace(/_/g,"-")).data("action",n.action).change(function(){e(this).mosaicExecAction()}).each(function(){var t,r,i;for(t=0;t<n.items.length;t+=1)if(n.items[t].items!==undefined){e(this).append(e(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+n.items[t].value.replace(/_/g,"-").replace(/\//g,"-")).attr("label",n.items[t].label)),r=e(this).find(".mosaic-option-group-"+n.items[t].value.replace(/_/g,"-").replace(/\//g,"-"));for(i in n.items[t].items)r.append(e(document.createElement("option")).attr("value",n.items[t].items[i].value).addClass("mosaic-option mosaic-option-"+n.items[t].items[i].value.replace(/\//g,"-")).html(n.items[t].items[i].label))}else e(this).append(e(document.createElement("option")).attr("value",n.items[t].value).addClass("mosaic-option mosaic-option-"+n.items[t].value.replace(/\//g,"-")).html(n.items[t].label))})):t.append(e(document.createElement("button")).addClass("mosaic-button mosaic-button-"+n.name.replace(/_/g,"-")+(n.icon?" mosaic-icon":"")).html(n.label).attr("title",n.label).attr("type","button").data("action",n.action).mousedown(function(){e(this).mosaicExecAction()}))}typeof e.mosaic=="undefined"&&(e.mosaic={}),e.fn.mosaicToolbar=function(){return this.each(function(){var n,r,i,s,o,u,a,f,l,c,h,p,d,v;n=e(this),n.html(""),n.append(e(document.createElement("div")).addClass("mosaic-inline-toolbar")),n=n.children(".mosaic-inline-toolbar"),n.append(e(document.createElement("div")).addClass("mosaic-toolbar-content")),r=n.children(".mosaic-toolbar-content"),i={},r.append(e(document.createElement("div")).addClass("mosaic-toolbar-primary-functions")),i.primary_actions=r.children(".mosaic-toolbar-primary-functions"),r.append(e(document.createElement("div")).addClass("mosaic-toolbar-secondary-functions")),i.secondary_actions=r.children(".mosaic-toolbar-secondary-functions");for(s in i)for(o=0;o<e.mosaic.options[s].length;o+=1)if(e.mosaic.options[s][o].actions===undefined)t(i[s],e.mosaic.options[s][o]);else{u=e.mosaic.options[s][o],i[s].append(e(document.createElement("fieldset")).addClass("mosaic-button-group mosaic-button-group-"+e.mosaic.options[s][o].name.replace(/_/g,"-"))),a=i[s].children(".mosaic-button-group-"+e.mosaic.options[s][o].name.replace(/_/g,"-"));for(f=0;f<u.actions.length;f+=1)t(a,u.actions[f])}if(e.mosaic.options.formats!==undefined)for(o=0;o<e.mosaic.options.formats.length;o+=1){u=e.mosaic.options.formats[o],i.primary_actions.append(e(document.createElement("fieldset")).addClass("mosaic-button-group mosaic-button-group-"+u.name.replace(/_/g,"-"))),a=i.primary_actions.children(".mosaic-button-group-"+u.name.replace(/_/g,"-"));for(f=0;f<u.actions.length;f+=1)u.actions[f].favorite&&t(a,u.actions[f]);a.children().length===0&&a.remove()}if(e.mosaic.options.tiles!==undefined){l=i.secondary_actions.find(".mosaic-menu-insert");for(o=0;o<e.mosaic.options.tiles.length;o+=1){u=e.mosaic.options.tiles[o],l.append(e(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+u.name.replace(/_/g,"-")).attr("label",u.label)),a=i.secondary_actions.find(".mosaic-option-group-"+u.name.replace(/_/g,"-"));for(f=0;f<u.tiles.length;f+=1)c=u.tiles[f],a.append(e(document.createElement("option")).addClass("mosaic-option mosaic-option-"+c.name.replace(/_/g,"-")).attr("value",c.name).html(c.label));a.children().length===0&&a.remove()}}if(e.mosaic.options.formats!==undefined){h=i.secondary_actions.find(".mosaic-menu-format");for(o=0;o<e.mosaic.options.formats.length;o+=1){u=e.mosaic.options.formats[o],h.append(e(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+u.name.replace(/_/g,"-")).attr("label",u.label)),a=i.secondary_actions.find(".mosaic-option-group-"+u.name.replace(/_/g,"-"));for(f=0;f<u.actions.length;f+=1)p=u.actions[f],p.favorite===!1&&a.append(e(document.createElement("option")).addClass("mosaic-option mosaic-option-"+p.name.replace(/_/g,"-")).attr("value",p.name).html(p.label).data("action",p.action));a.children().length===0&&a.remove()}}d=function(){var t;parseInt(e(window).scrollTop(),10)>parseInt(n.parent().offset().top,10)?n.hasClass("mosaic-inline-toolbar")&&(t=n.offset().left,n.width(n.width()).css({left:t,"margin-left":"0px"}).removeClass("mosaic-inline-toolbar").addClass("mosaic-external-toolbar").parent().height(n.height())):n.hasClass("mosaic-external-toolbar")&&n.css({width:"",left:"","margin-left":""}).removeClass("mosaic-external-toolbar").addClass("mosaic-inline-toolbar").parent().css("height","")},e(window).bind("scroll",d),v=function(){var t,n,r,i,s,o,u,a;e.mosaic.disableEditHtmlSource(),t=e(this),n="",r=e(".mosaic-selected-tile",e.mosaic.document),r.length>0&&(i=r.attr("class").split(" "),e(i).each(function(){var e=this.match(/^mosaic-(.*)-tile$/);e!==null&&e[1]!=="selected"&&e[1]!=="new"&&e[1]!=="read-only"&&e[1]!=="helper"&&e[1]!=="original"&&(n=e[1])})),s=e.mosaic.options.default_available_actions;for(o=0;o<e.mosaic.options.tiles.length;o+=1){u=e.mosaic.options.tiles[o];for(a=0;a<u.tiles.length;a+=1)u.tiles[a].name===n&&(s=s.concat(u.tiles[a].available_actions))}t.find(".mosaic-option-group").show(),t.find(".mosaic-button").hide(),t.find(".mosaic-menu").hide(),t.find(".mosaic-icon-menu").hide(),t.find(".mosaic-menu-format").find(".mosaic-option").hide().attr("disabled","disabled"),e(t.find(".mosaic-menu-format").find(".mosaic-option").get(0)).show().removeAttr("disabled"),e(s).each(function(e,n){t.find(".mosaic-button-"+n).show(),t.find(".mosaic-icon-menu-"+n).show(),t.find(".mosaic-menu-"+n).show(),t.find(".mosaic-option-"+n).show().removeAttr("disabled")}),t.find(".mosaic-menu-insert").children(".mosaic-option-group-fields").children().each(function(){e.mosaic.options.panels.find(".mosaic-"+e(this).attr("value")+"-tile").length===0?e(this).show().removeAttr("disabled"):e(this).hide().attr("disabled","disabled")}),t.find(".mosaic-option-group").each(function(){e(this).children(":enabled").length===0&&e(this).hide()}),e(".mosaic-menu, .mosaic-icon-menu",e.mosaic.document).each(function(){e(this).find(".mosaic-option:enabled").length===1&&e(this).hide()})},e(this).bind("selectedtilechange",v),e(this).trigger("selectedtilechange")})}})(jQuery)}),function(e){define("mosaic.actions",[],function(){return function(){(function(e){typeof e.mosaic=="undefined"&&(e.mosaic={}),e.mosaic.actionManager={actions:[],shortcuts:[]},e.mosaic.registerAction=function(t,n){n=e.extend({exec:function(){},shortcut:{ctrl:!1,alt:!1,shift:!1,key:""},visible:function(e){return!0},undoable:!1},n),e.mosaic.actionManager.actions[t]=n,n.shortcut.key!==""&&(n.shortcut.charCode=n.shortcut.key.toUpperCase().charCodeAt(0),n.shortcut.action=t,e.mosaic.actionManager.shortcuts.push(n.shortcut))},e.fn.mosaicExecAction=function(){return this.each(function(){if(e(this).data("action")!==""){var t=e.mosaic.actionManager;t.actions[e(this).data("action")].exec(this),t.actions[e(this).data("action")].undoable&&e.mosaic.undo.snapshot()}})},e.mosaic.fixWebkitSpan=function(){var t=e(".Apple-style-span",e.mosaic.document);t.after(t.html()),t.remove()},e.mosaic.initActions=function(){e.mosaic.registerAction("strong",{exec:function(){e.mosaic.editor.applyFormat("strong")},shortcut:{ctrl:!0,alt:!1,shift:!1,key:"b"}}),e.mosaic.registerAction("em",{exec:function(){e.mosaic.editor.applyFormat("em")}}),e.mosaic.registerAction("ul",{exec:function(){e.mosaic.execCommand("InsertUnorderedList")}}),e.mosaic.registerAction("ol",{exec:function(){e.mosaic.execCommand("InsertOrderedList")}}),e.mosaic.registerAction("undo",{exec:function(){e.mosaic.execCommand("Undo")}}),e.mosaic.registerAction("redo",{exec:function(){e.mosaic.execCommand("Redo")}}),e.mosaic.registerAction("paragraph",{exec:function(){e.mosaic.editor.applyFormat("p")}}),e.mosaic.registerAction("heading",{exec:function(){e.mosaic.editor.applyFormat("h2")}}),e.mosaic.registerAction("subheading",{exec:function(){e.mosaic.editor.applyFormat("h3")}}),e.mosaic.registerAction("discreet",{exec:function(){e.mosaic.editor.applyFormat("discreet")}}),e.mosaic.registerAction("literal",{exec:function(){e.mosaic.editor.applyFormat("pre")}}),e.mosaic.registerAction("quote",{exec:function(){e.mosaic.editor.applyFormat("pullquote")}}),e.mosaic.registerAction("callout",{exec:function(){e.mosaic.editor.applyFormat("callout")}}),e.mosaic.registerAction("highlight",{exec:function(){e.mosaic.editor.applyFormat("highlight")}}),e.mosaic.registerAction("sub",{exec:function(){e.mosaic.editor.applyFormat("sub")}}),e.mosaic.registerAction("sup",{exec:function(){e.mosaic.editor.applyFormat("sup")}}),e.mosaic.registerAction("remove-format",{exec:function(){e.mosaic.editor.applyFormat("removeformat")}}),e.mosaic.registerAction("pagebreak",{exec:function(){e.mosaic.editor.applyFormat("pagebreak")}}),e.mosaic.registerAction("justify-left",{exec:function(){e.mosaic.editor.applyFormat("justify-left")}}),e.mosaic.registerAction("justify-center",{exec:function(){e.mosaic.editor.applyFormat("justify-center")}}),e.mosaic.registerAction("justify-right",{exec:function(){e.mosaic.editor.applyFormat("justify-right")}}),e.mosaic.registerAction("justify-justify",{exec:function(){e.mosaic.editor.applyFormat("justify-justify")}}),e.mosaic.registerAction("tile-align-block",{exec:function(){e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-tile-align-right").removeClass("mosaic-tile-align-left")},shortcut:{ctrl:!0,alt:!1,shift:!0,key:"b"}}),e.mosaic.registerAction("tile-align-left",{exec:function(){e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-tile-align-right").addClass("mosaic-tile-align-left")},shortcut:{ctrl:!0,alt:!1,shift:!0,key:"l"}}),e.mosaic.registerAction("tile-align-right",{exec:function(){e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-tile-align-left").addClass("mosaic-tile-align-right")},shortcut:{ctrl:!0,alt:!1,shift:!0,key:"r"}}),e.mosaic.registerAction("save",{exec:function(){e("#form-widgets-ILayoutAware-content, [name='form.widgets.ILayoutAware.content']").attr("value",e.mosaic.getPageContent()),e("#form-buttons-save").click()},shortcut:{ctrl:!0,alt:!1,shift:!1,key:"s"}}),e.mosaic.registerAction("cancel",{exec:function(){e("#form-buttons-cancel").click()}}),e.mosaic.registerAction("html",{exec:function(){var t,n,r;t=e(".mosaic-selected-tile",e.mosaic.document).children(".mosaic-tile-content"),t.find(".mosaic-rich-text-textarea").length===0&&(n=t.html(),r=t.height(),t.empty(),t.prepend(e(e.mosaic.document.createElement("textarea")).addClass("mosaic-rich-text-textarea").html(e.trim(n)).height(r)))}}),e.mosaic.registerAction("undo",{exec:function(){e.mosaic.undo.undo()}}),e.mosaic.registerAction("redo",{exec:function(){e.mosaic.undo.redo()}}),e.mosaic.registerAction("page-properties",{exec:function(){e.mosaic.overlay.open("all")}}),e.mosaic.registerAction("page-layout",{exec:function(){var t=require("mockup-patterns-modal"),n=new t(e(".mosaic-original-content"),{title:"Layout options",content:"#fieldset-layout"});n.on("show",function(){n.$modal.removeClass("mosaic-blur").find("#formfield-form-widgets-ILayoutAware-content").remove(),n.$el.find("select").each(function(){var t=e(this).val(),r=e(this).attr("id");n.$modal.find("#"+r).val(t)})}),n.on("hide",function(){n.$modal.find("select").each(function(){var t=e(this).val(),r=e(this).attr("id");n.$el.find("#"+r).val(t)})}),n.show()}}),e.mosaic.registerAction("add-tile",{exec:function(){var t=require("mockup-patterns-modal");e.mosaic.overlay=new t(e(".mosaic-toolbar"),{ajaxUrl:e.mosaic.options.context_url+"/@@add-tile?form.button.Create=Create"}),e.mosaic.overlay.show()}}),e.mosaic.registerAction("format",{exec:function(t){e(t).find("[value="+e(t).val()+"]").mosaicExecAction(),e(t).val("none")}}),e.mosaic.registerAction("insert",{exec:function(t){var n,r,i,s;if(e(t).val()==="none")return!1;e(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").blur(),e.mosaic.options.panels.trigger("selectedtilechange");for(i=0;i<e.mosaic.options.tiles.length;i+=1){r=e.mosaic.options.tiles[i];for(s=0;s<r.tiles.length;s+=1)r.tiles[s].name===e(t).val()&&(n=r.tiles[s])}if(n.tile_type==="app"){var o=require("mockup-patterns-modal");e.mosaic.overlay=new o(e(".mosaic-toolbar"),{ajaxUrl:e.mosaic.options.context_url+"/@@add-tile?tiletype="+e(t).val()+"&form.button.Create=Create",loadLinksWithinModal:!0}),e.mosaic.overlay._tile_type=e(t).val(),e.mosaic.overlay.show(),e.mosaic.overlay.on("formActionSuccess",function(t,n,r,i,s){var o=i.getResponseHeader("X-Tile-Url");o&&e.mosaic.addAppTileHTML(e.mosaic.overlay._tile_type,n,o)})}else e.mosaic.addTile(e(t).val(),e.mosaic.getDefaultValue(n));return e(t).val("none"),!0}}),e(document).keypress(function(t){var n="";return e(e.mosaic.actionManager.shortcuts).each(function(){(t.ctrlKey===this.ctrl||navigator.userAgent.toLowerCase().indexOf("macintosh")!==-1&&t.metaKey===this.ctrl)&&(t.altKey===this.alt||t.altKey===undefined)&&t.shiftKey===this.shift&&t.charCode&&String.fromCharCode(t.charCode).toUpperCase().charCodeAt(0)===this.charCode&&(n=this.action)}),n!==""?(e.mosaic.actionManager.actions[n].exec(),e.mosaic.actionManager.actions[n].undoable&&e.mosaic.undo.snapshot(),!1):!0})}})(jQuery)}.apply(e,arguments)})}(this),define("mosaic.upload",["mosaic.core"],function(){(function($){typeof $.mosaic=="undefined"&&($.mosaic={}),$.mosaic.initUpload=function(){$(".mosaic-panel",$.mosaic.document).bind("dragover",function(e){$(".mosaic-panel-dragging",$.mosaic.document).length===0&&($(".mosaic-selected-tile",$.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").blur(),$.mosaic.options.toolbar.trigger("selectedtilechange"),$.mosaic.options.panels.mosaicSetResizeHandleLocation(),$.mosaic.addTile("image",'<img src="++resource++plone.app.mosaic.images/files.png" border="0" />'))}),document.addEventListener("drop",function(event){var dt,first,i,files,newtile,file,img,tile,xhr,boundary,data;dt=event.dataTransfer,files=dt.files,event.stopPropagation(),event.preventDefault(),$($.mosaic.document).trigger("mousedown"),first=!0;for(i=0;i<files.length;i+=1)file=files.item(i),file.mediaType.indexOf("image")===0?(first?(img=$(".mosaic-selected-tile",$.mosaic.document).children(".mosaic-tile-content").children("img"),tile=$(".mosaic-selected-tile",$.mosaic.document),first=!1):(newtile=$($.mosaic.document.createElement("div")).addClass("movable removable mosaic-tile mosaic-image-tile").append($($.mosaic.document.createElement("div")).addClass("mosaic-tile-content").append($($.mosaic.document.createElement("img")).attr("border",0))),$(".mosaic-selected-tile",$.mosaic.document).after(newtile),newtile.mosaicInitTile(),newtile.mosaicAddDrag(),img=newtile.children(".mosaic-tile-content").children("img"),tile=newtile),tile.append($($.mosaic.document.createElement("div")).addClass("mosaic-tile-uploadprogress")),img.get(0).src=file.getAsDataURL(),xhr=new XMLHttpRequest,xhr.upload.log=img,xhr.addEventListener("load",function(event){var response=eval("("+event.target.responseText+")");response.status===1?$.plone.notify({type:"error",title:"Error",message:response.message,sticky:!0}):$(event.target.upload.log).attr({src:response.url,alt:response.title}).parents(".mosaic-tile").children(".mosaic-tile-uploadprogress").fadeOut("slow",function(){$(this).remove()})},!1),xhr.upload.addEventListener("error",function(e){$.plone.notify({type:"error",title:"Error",message:"Error uploading file: "+e,sticky:!0})},!1),boundary="AJAX---------------------------AJAX",xhr.open("POST",$.mosaic.options.url+"/@@mosaic-upload",!0),xhr.setRequestHeader("Content-Type","multipart/form-data; boundary="+boundary),data="--"+boundary+"\r\n",data+="Content-Disposition: form-data; ",data+='name="uploadfile"; ',data+='filename="'+file.fileName+'"'+"\r\n",data+="Content-Type: "+file.mediaType,data+="\r\n\r\n",data+=file.getAsBinary()+"\r\n",data+="--"+boundary+"--"+"\r\n",xhr.sendAsBinary(data)):$.plone.notify({type:"warning",title:"Warning",message:"The filetype of file "+file.fileName+" is unsupported",sticky:!0});first&&$(".mosaic-selected-tile",$.mosaic.document).find(".mosaic-close-icon").trigger("click")},!1)}})(jQuery)}),define("mosaic.editor",["mosaic.core"],function(){(function(e){typeof e.mosaic=="undefined"&&(e.mosaic={}),e.mosaic.editor={},e.fn.mosaicEditor=function(){var t;t=e(this);var n=1+Math.floor(1e5*Math.random());while(e("#mosaic-rich-text-init-"+n,e.mosaic.document).length>0)n=1+Math.floor(1e5*Math.random());e(this).attr("id","mosaic-rich-text-init-"+n),tinymce.init({selector:"#mosaic-rich-text-init-"+n,theme:"modern",inline:!0,schema:"html5",add_unload_trigger:!1,toolbar:!1,statusbar:!1,menubar:!1,formats:{strong:{inline:"strong"},em:{inline:"em"},h2:{block:"h2",remove:"all"},h3:{block:"h3",remove:"all"},p:{block:"p",remove:"all"},sub:{inline:"sub",remove:"all"},sup:{inline:"sup",remove:"all"},discreet:{block:"p",attributes:{"class":"discreet"},remove:"all"},pre:{block:"pre",remove:"all"},pullquote:{block:"q",attributes:{"class":"pullquote"},remove:"all"},callout:{block:"p",attributes:{"class":"callout"},remove:"all"},highlight:{inline:"span",attributes:{"class":"visualHighlight"},remove:"all"},pagebreak:{block:"p",attributes:{"class":"pagebreak"},remove:"all"},"justify-left":{selector:"p,h2,h3,pre,q",attributes:{"class":"justify-left"},remove:"all"},"justify-center":{selector:"p,h2,h3,pre,q",attributes:{"class":"justify-center"},remove:"all"},"justify-right":{selector:"p,h2,h3,pre,q",attributes:{"class":"justify-right"},remove:"all"},"justify-justify":{selector:"p,h2,h3,pre,q",attributes:{"class":"justify-justify"},remove:"all"}}}),t.addClass("mosaic-rich-text")},e.mosaic.execCommand=function(e,t,n){tinymce.activeEditor.execCommand(e,t,n)},e.mosaic.editor.applyFormat=function(e){tinyMCE.activeEditor.formatter.apply(e)},e.mosaic.editor.registerFormat=function(e,t){tinymce.activeEditor.formatter.register(e,t)}})(jQuery)}),define("mosaic.undo",["mosaic.core"],function(){(function(e){typeof e.mosaic=="undefined"&&(e.mosaic={}),e.mosaic.undo=function(){},e.mosaic.undo.init=function(){function t(t){for(var n=0;n<t.length;n+=1)e("#"+t[n].target,e.mosaic.document).html(t[n].source)}e.mosaic.undo.undoManager=new e.mosaic.undo.UndoManager(10,t)},e.mosaic.undo.snapshot=function(){var t=[];e(".mosaic-panel",e.mosaic.document).each(function(){t.push({target:e(this).attr("id"),source:e(this).html()})}),typeof e.mosaic.undo.undoManager=="undefined"&&e.mosaic.undo.init(),e.mosaic.undo.undoManager.add(t)},e.mosaic.undo.hasInitial=function(){return e.mosaic.undo.undoManager.stack.size()>0?!0:!1},e.mosaic.undo.undo=function(){e.mosaic.undo.undoManager.undo()},e.mosaic.undo.redo=function(){e.mosaic.undo.undoManager.redo()},e.mosaic.undo.Stack=function(e){typeof e=="undefined"?this.maxsize=10:this.maxsize=e,this.stack=[]},e.mosaic.undo.Stack.prototype.size=function(){return this.stack.length},e.mosaic.undo.Stack.prototype.add=function(e){this.stack.length>=this.maxsize&&this.stack.pop(),this.stack.unshift(e)},e.mosaic.undo.Stack.prototype.get=function(e){return this.stack[e]},e.mosaic.undo.UndoManager=function(t,n,r){this.stack=new e.mosaic.undo.Stack(t),this.pointer=0,this.handler=n,typeof r!="undefined"&&this.stack.add(r)},e.mosaic.undo.UndoManager.prototype.add=function(e){this.stack.add(e)},e.mosaic.undo.UndoManager.prototype.undo=function(){var e=this.stack.get(this.pointer+1);e&&(this.handler(e),this.pointer+=1)},e.mosaic.undo.UndoManager.prototype.redo=function(){var e=this.stack.get(this.pointer-1);e&&(this.handler(e),this.pointer-=1)}})(jQuery)}),require(["mockup-registry","mockup-patterns-base","mosaic.core","mosaic.layout","mosaic.toolbar","mosaic.actions","mosaic.upload","mosaic.editor","mosaic.undo"],function(e,t){var n=t.extend({name:"layout",defaults:{attribute:"class"},init:function(){var e=this;e.options.data.$el=e.$el,$.mosaic.init({data:e.options.data})}});return window.parent===window&&$(document).ready(function(){$("body").addClass("mosaic-enabled"),e.scan($("body"))}),n}),define("/Users/atsoukka/Code/buildout.coredev.Plone5/src/plone.app.mosaic/src/plone/app/mosaic/browser/static/js/mosaic.pattern.js",function(){});